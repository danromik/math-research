(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    359804,       8938]
NotebookOptionsPosition[    349192,       8600]
NotebookOutlinePosition[    350912,       8651]
CellTagsIndexPosition[    350832,       8646]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Read This First", "Section",
 CellChangeTimes->{{3.616158489662698*^9, 3.6161584933989983`*^9}, 
   3.6161586004516573`*^9, {3.616300127358727*^9, 3.616300128683364*^9}, {
   3.616302323247871*^9, 3.616302324033493*^9}}],

Cell[TextData[{
 StyleBox["The combinatorics of fully packed loops and Razumov-Stroganov \
conjectures",
  FontWeight->"Bold"],
 "\n",
 StyleBox["A ",
  FontWeight->"Bold"],
 StyleBox["Mathematica-",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["based presentation",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{
  3.615751896773769*^9, {3.616302382385578*^9, 3.6163023880979*^9}, {
   3.616302624533786*^9, 3.616302625240706*^9}}],

Cell[TextData[{
 "Copyright (c) 2014 Dan Romik. You may distribute this document freely for \
all noncommercial purposes as long as it is kept in its original unmodified \
form. You may freely modify, use and distribute the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " source code contained in the initialization code blocks below, but not \
other parts of the document. If you distribute any derivative works based on \
the code, an acknowledgement to the author is appreciated."
}], "Text",
 CellChangeTimes->{{3.616158783769068*^9, 3.616159326468602*^9}, {
  3.616300069347432*^9, 3.6163001149710417`*^9}, {3.616301925950079*^9, 
  3.61630193751307*^9}}],

Cell[CellGroupData[{

Cell["Initialization code (for geeks)", "Subsection",
 CellChangeTimes->{{3.616158499512182*^9, 3.6161585036119547`*^9}, {
  3.616301753247232*^9, 3.6163017713713303`*^9}, {3.6163027465603027`*^9, 
  3.6163027468933277`*^9}}],

Cell[CellGroupData[{

Cell["Function Library, part 1", "Subsubsection",
 CellChangeTimes->{{3.616158617877253*^9, 3.616158628027092*^9}, {
  3.6161587639555387`*^9, 3.616158766055851*^9}, {3.6163001606105223`*^9, 
  3.6163001662718678`*^9}}],

Cell[TextData[{
 "The ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " package linkpatterns.m I wrote in 2012-2014. It implements many functions \
and algorithms related to noncrossing matchings, the Temperley-Lieb random \
walk, wheel polynomials and other concepts described in my paper \
\[OpenCurlyDoubleQuote]Connectivity patterns in loop percolation I: the \
rationality phenomenon and constant term identities\[CloseCurlyDoubleQuote]"
}], "Text",
 CellChangeTimes->{{3.61630039315254*^9, 3.616300553968513*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\n", 
   RowBox[{"linkpatterns", ",", " ", 
    RowBox[{
     RowBox[{
     "a", " ", "Mathematica", " ", "8", " ", "software", " ", "package", " ", 
      "by", " ", "Dan", " ", "Romik", "\n", "Version", " ", "1.1", "\n", 
      "Copyright", " ", 
      RowBox[{"(", "c", ")"}], " ", "Dan", " ", "Romik", " ", "2014", "\n", 
      "\n", "Package", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"documentation", "\n", "--"}], "--"}], "--"}], "--"}], 
            "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], "-", "\n", "\n", 
     RowBox[{"1.", " ", "General", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"information", "\n", "--"}], "--"}], "--"}], "--"}], 
             "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "\n", 
      "\n", 
      RowBox[{"LinkPatternsInfoMessage", "[", "]"}], "\n", "\t", "Prints", 
      " ", "an", " ", "info", " ", "message", " ", 
      RowBox[{"(", 
       RowBox[{
       "called", " ", "automatically", " ", "when", " ", "package", " ", "is",
         " ", "loaded"}], ")"}], "\n", "\t", "\n", 
      RowBox[{"LinkPatternsHelp", "[", "]"}], "\n", "\t", "Displays", " ", 
      "detailed", " ", "help", " ", "information", "\n", "\n", "2.", " ", 
      "Manipulation", " ", "of", " ", "link", " ", "patterns", " ", "and", 
      " ", "related", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"objects", "\n", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
              "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
      "\n", "\n", 
      RowBox[{"NumLinkPatterns", "[", "n", "]"}], "\n", "\t", "Returns", " ", 
      "the", " ", "number", " ", "of", " ", "link", " ", "patterns", " ", 
      "of", " ", "order", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"the", " ", "nth", " ", "Catalan", " ", 
         RowBox[{"number", ":", " ", "1"}]}], ",", "2", ",", "5", ",", "14", 
        ",", "42", ",", "132", ",", "429", ",", "..."}], ")"}], "\n", "\n", 
      RowBox[{"LinkPatterns", "[", "n", "]"}], "\n", "\t", "Returns", " ", 
      "a", " ", "list", " ", "of", " ", "all", " ", "link", " ", "patterns", 
      " ", "of", " ", "order", " ", 
      RowBox[{"n", ".", " ", "Each"}], " ", "link", " ", "pattern", " ", "is",
       " ", "represented", " ", "as", " ", "a", " ", "sequence", " ", "of"}], 
     " ", "+", 
     RowBox[{"1", " ", "and"}], " ", "-", 
     RowBox[{
      RowBox[{"1", "'"}], "s", "\n", "\t", "encoding", " ", "a", " ", "Dyck", 
      " ", "path"}]}], ",", " ", 
    RowBox[{"with", " ", "+", 
     RowBox[{
      RowBox[{"1", "'"}], "s", " ", "encoding", " ", "an", " ", "up", " ", 
      "step", " ", "and"}], " ", "-", 
     RowBox[{
      RowBox[{"1", "'"}], "s", " ", "encoding", " ", "down", " ", "steps", 
      "\n", "\t", "\n", 
      RowBox[{"MinimalLinkPattern", "[", "n", "]"}], "\n", "\t", "Returns", 
      " ", "the", " ", "minimal", " ", "link", " ", "pattern", " ", "of", " ",
       "order", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{"n", " ", "nested", " ", "arches"}], ")"}], "\n", "\t", "\n", 
      RowBox[{"MaximalLinkPattern", "[", "n", "]"}], "\n", "\t", "Returns", 
      " ", "the", " ", "maximal", " ", "link", " ", "pattern", " ", "of", " ",
       "order", " ", "n", "\t", 
      RowBox[{"(", 
       RowBox[{
       "n", " ", "little", " ", "arches", " ", "side", " ", "by", " ", 
        "side"}], ")"}], "\n", "\n", 
      RowBox[{"NoncrossingMatchings", "[", "n", "]"}], "\n", "\t", "Returns", 
      " ", "a", " ", "list", " ", "of", " ", "noncrossing", " ", "matchings", 
      " ", "of", " ", "order", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
       "each", " ", "matching", " ", "represented", " ", "as", " ", "a", " ", 
        "permutation"}], ")"}], "\n", "\t", "\n", 
      RowBox[{"LinkPatternToNoncrossingMatching", "[", "linkpattern", "]"}], 
      "\n", "\t", "Returns", " ", "the", " ", "noncrossing", " ", "matching", 
      " ", "associated", " ", "with", " ", "a", " ", "given", " ", "link", 
      " ", "pattern", "\n", "\t\t", "\n", 
      RowBox[{
      "NoncrossingMatchingToLinkPattern", "[", "noncrossingmatching", "]"}], 
      "\n", "\t", "Returns", " ", "the", " ", "link", " ", "pattern", " ", 
      "associated", " ", "with", " ", "a", " ", "given", " ", "noncrossing", 
      " ", "matching", "\n", "\t", "\n", 
      RowBox[{"LinkPatternToYoungDiagram", "[", "linkpattern", "]"}], "\n", 
      "\t", "Returns", " ", "the", " ", "Young", " ", "diagram", " ", 
      RowBox[{"(", 
       RowBox[{
       "a", " ", "subset", " ", "of", " ", "the", " ", "staircase", " ", 
        "diagram"}], ")"}], " ", "associated", " ", "with", " ", "a", " ", 
      "given", " ", "link", " ", "pattern", "\n", "\t", "\n", 
      RowBox[{"LinkPatternToDyckPath", "[", "linkpattern", "]"}], "\n", "\t", 
      "Returns", " ", "the", " ", "Dyck", " ", "path", " ", "associated", " ",
       "with", " ", "a", " ", "given", " ", "link", " ", "pattern", "\n", 
      "\n", 
      RowBox[{"Arches", "[", "linkpattern", "]"}], "\n", "\t", "Returns", " ",
       "a", " ", "list", " ", "of", " ", "pairs", " ", "of", " ", "elements", 
      " ", "representing", " ", "the", " ", "arches", " ", "in", " ", "a", 
      " ", "link", " ", "Pattern", "\n", "\t", "\n", 
      RowBox[{"LittleArches", "[", 
       RowBox[{"linkpattern", ",", " ", "wraparound"}], "]"}], "\n", "\t", 
      "Returns", " ", "a", " ", "list", " ", "of", " ", "the", " ", 
      "\"\<little arches\>\"", " ", 
      RowBox[{"(", 
       RowBox[{"matched", " ", "adjacent", " ", "elements"}], ")"}], " ", 
      "in", " ", "a", " ", "link", " ", "Pattern"}]}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"including", " ", "the", " ", "maximal", " ", "arch", " ", 
      RowBox[{"(", 
       RowBox[{"1", ",", 
        RowBox[{"2", "n"}]}], ")"}], " ", "if", " ", "the", " ", "boolean", 
      " ", "value", " ", "\"\<wraparound\>\"", " ", "is", " ", "true", " ", 
      "\n", "\t", "\n", 
      RowBox[{"LittleArches", "[", "linkpattern", "]"}], "\n", "\t", "Same", 
      " ", "as", " ", "calling", " ", 
      RowBox[{"LittleArches", "[", 
       RowBox[{"linkpattern", ",", " ", "True"}], "]"}], "\n", "\t", "\n", 
      RowBox[{"NumberOfLittleArches", "[", 
       RowBox[{"linkpattern", ",", " ", "wraparound"}], "]"}], "\n", "\t", 
      "Returns", " ", "the", " ", "length", " ", "of", " ", 
      RowBox[{"LinkPattern", "[", 
       RowBox[{"linkpattern", ",", " ", "wraparound"}], "]"}], "\n", "\t", 
      "\n", 
      RowBox[{"NumberOfLittleArches", "[", "linkpattern", "]"}], "\n", "\t", 
      "Returns", " ", "the", " ", "length", " ", "of", " ", 
      RowBox[{"LinkPattern", "[", "linkpattern", "]"}], "\n", "\t", "\n", 
      RowBox[{"LittleArch", "[", "linkpattern", "]"}], "\n", "\t", "Returns", 
      " ", "an", " ", "arbitrary", " ", "little", " ", "arch", " ", "of", " ",
       "the", " ", "link", " ", "Pattern", "\n", "\t", "\n", 
      RowBox[{"OpeningPositions", "[", "linkpattern", "]"}], "\n", "\t", 
      "Returns", " ", "the", " ", "positions", " ", "of", " ", "the"}], " ", 
     "+", 
     RowBox[{
      RowBox[{"1", "'"}], "s", " ", "in", " ", "a", " ", "link", " ", 
      "pattern", "\n", "\t", "\n", 
      RowBox[{"RotateLinkPatternForward", "[", "linkpattern", "]"}], "\n", 
      "\t", "Returns", " ", "the", " ", "link", " ", "pattern", " ", 
      "rotated", " ", "counterclockwise", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "element"}], " ", "1", " ", "is", 
         " ", "relabeled", " ", "2"}], ",", " ", 
        RowBox[{"2", " ", "is", " ", "relabeled", " ", "3", " ", 
         RowBox[{"etc", "."}]}]}], ")"}], "\n", "\t", "\n", 
      RowBox[{"RotateLinkPatternBack", "[", "linkpattern", "]"}], "\n", "\t", 
      "Returns", " ", "the", " ", "link", " ", "pattern", " ", "rotated", " ",
       "clockwise", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "element"}], " ", "2", " ", "is", 
         " ", "relabeled", " ", "1"}], ",", " ", 
        RowBox[{"3", " ", "is", " ", "relabeled", " ", "2", " ", 
         RowBox[{"etc", "."}]}]}], ")"}], "\n", "\t", "\n", "\t", "\n", "\t", 
      "\n", "3.", " ", "Graphical", " ", "representations", " ", "of", " ", 
      "link", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"patterns", "\n", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                 "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
          "--"}], "--"}], "--"}], "--"}]}], "-", "\n", "\n", 
     RowBox[{
      RowBox[{"LinkPatternGraphicsCircular", "[", 
       RowBox[{"linkpattern", ",", " ", "numbered"}], "]"}], "\n", "\t", 
      "Returns", " ", "a", " ", "graphical", " ", "representation", " ", "of",
       " ", "a", " ", "link", " ", "pattern", " ", "arranged", " ", "in", " ",
       "a", " ", 
      RowBox[{"circle", ".", " ", "If"}], " ", "the", " ", "boolean", " ", 
      "value", " ", "\"\<numbered\>\"", " ", "is", " ", "true", "\n", "\t", 
      "then", " ", "textual", " ", "numbering", " ", "is", " ", 
      RowBox[{"added", ".", "\n", "\n", 
       RowBox[{"LinkPatternGraphicsLinear", "[", 
        RowBox[{"linkpattern", ",", " ", "numbered"}], "]"}]}], "\n", "\t", 
      "Returns", " ", "a", " ", "graphical", " ", "representation", " ", "of",
       " ", "a", " ", "link", " ", "pattern", " ", "arranged", " ", "on", " ",
       "a", " ", 
      RowBox[{"line", ".", " ", "If"}], " ", "the", " ", "boolean", " ", 
      "value", " ", "\"\<numbered\>\"", " ", "is", " ", "true", " ", "\n", 
      "\t", "then", " ", "textual", " ", "numbering", " ", "is", " ", 
      RowBox[{"added", ".", "\n", "\t", "\n", 
       RowBox[{"LinkPatternGraphicsDyckPath", "[", 
        RowBox[{
        "linkpattern", ",", " ", "numbered", ",", " ", "showlinks", ",", " ", 
         "showyoungdiagram"}], "]"}]}], "\n", "\t", "Returns", " ", "a", " ", 
      "graphical", " ", "representation", " ", "of", " ", "a", " ", "link", 
      " ", "pattern", " ", "as", " ", "a", " ", "Dyck", " ", 
      RowBox[{"path", ".", "\n", "\t", "If"}], " ", "the", " ", "boolean", 
      " ", "value", " ", "\"\<numbered\>\"", " ", "is", " ", "true", " ", 
      "then", " ", "textual", " ", "numbering", " ", "is", " ", 
      RowBox[{"added", ".", "\n", "\t", "If"}], " ", "the", " ", "boolean", 
      " ", "value", " ", "\"\<showlinks\>\"", " ", "is", " ", "true", " ", 
      "then", " ", "lines", " ", "indicating", " ", "the", " ", "matching", 
      " ", "links", " ", "are", " ", 
      RowBox[{"added", ".", "\n", "\t", "If"}], " ", "the", " ", "boolean", 
      " ", "value", " ", "\"\<showyoungdiagram\>\"", " ", "is", " ", "true", 
      " ", "then", " ", "the", " ", "associated", " ", "Young", " ", 
      "diagram", " ", "is", " ", 
      RowBox[{"shown", ".", "\n", "\t", "\n", 
       RowBox[{"LinkPatternGraphicsYoungDiagram", "[", "linkpattern", "]"}]}],
       "\n", "\t", "Returns", " ", "a", " ", "graphical", " ", 
      "representation", " ", "of", " ", "the", " ", "Young", " ", "diagram", 
      " ", "associated", " ", "with", " ", "the", " ", "link", " ", 
      RowBox[{"pattern", ".", "\n", "\t", "\n", 
       RowBox[{"NoncrossingMatchingGraphicsCircular", "[", 
        RowBox[{"matching", ",", " ", "numbered"}], "]"}]}], "\n", "\t", 
      "Similar", " ", "to", " ", 
      RowBox[{"LinkPatternGraphicsCircular", "[", 
       RowBox[{"linkpattern", ",", " ", "numbered"}], "]"}], " ", "but", " ", 
      "the", " ", "input", " ", "is", " ", "encoded", " ", "as", " ", "a", 
      " ", "noncrossing", " ", "matching", "\n", "\n", 
      RowBox[{"NoncrossingMatchingGraphicsLinear", "[", 
       RowBox[{"matching", ",", " ", "numbered"}], "]"}], "\n", "\t", 
      "Similar", " ", "to", " ", 
      RowBox[{"LinkPatternGraphicsLinear", "[", 
       RowBox[{"linkpattern", ",", " ", "numbered"}], "]"}], " ", "but", " ", 
      "the", " ", "input", " ", "is", " ", "encoded", " ", "as", " ", "a", 
      " ", "noncrossing", " ", "matching", "\n", "\n", "\n", "4.", " ", "The",
       " ", "Razumov"}], "-", 
     RowBox[{"Stroganov", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"distribution", "\n", "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
              "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
       "--"}]}], "-", "\n", "\t", "\n", 
     RowBox[{
      RowBox[{"RazumovStroganovEigenvector", "[", "n", "]"}], "\n", "\t", 
      "Returns", " ", "the", " ", "ground", " ", "state", " ", "eigenvector", 
      " ", "of", " ", "the", " ", "Hamiltonian", " ", "associated", " ", 
      "with", " ", "the", " ", "Razumov"}], "-", 
     RowBox[{
     "Stroganov", "\n", "\t", "random", " ", "walk", " ", "on", " ", "link", 
      " ", "patterns"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "normalized", " ", "to", " ", "have", " ", "minimal", " ", "coordinate",
        " ", "1", "\n", "\n", 
       RowBox[{"RandomLinkPattern", "[", "n", "]"}], "\n", "\t", "Samples", 
       " ", "a", " ", 
       RowBox[{"(", "pseudo", ")"}], "random", " ", "link", " ", "pattern", 
       " ", "from", " ", "the", " ", "Razumov"}], "-", 
      RowBox[{
      "Stroganov", " ", "distribution", " ", "of", " ", "order", " ", "n", 
       "\n", "\t", "\n", "\n", "5.", " ", "Wheel", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"polynomials", "\n", "--"}], "--"}], "--"}], "--"}], 
             "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "\n", "\n", 
       RowBox[{"LPPolynomialsOfSecondKind", "[", 
        RowBox[{"seq", ",", " ", "var"}], "]"}], "\n", "\t", "Computes", " ", 
       "the", " ", "link", " ", "pattern", " ", "polynomial", " ", "of", " ", 
       "the", " ", "second", " ", "kind", " ", 
       RowBox[{"(", "\"\<\\Phi_a(z)\>\"", ")"}], " ", "associated", " ", 
       "with", " ", "the", " ", "sequence", " ", "seq", "\n", "\t", "and", 
       " ", "the", " ", "variable", " ", "symbol", " ", "var", "\n", "\t", 
       "\n", 
       RowBox[{"LPPolynomialsOfSecondKindEvaluateAtOne", "[", "seq", "]"}], 
       "\n", "\t", "Computes", " ", "the", " ", "value", " ", "at", " ", 
       "z"}]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", ",", "1", ",", "...", ",", "1"}], ")"}], " ", "of", " ", 
      "the", " ", "link", " ", "pattern", " ", "polynomial", " ", "of", " ", 
      "the", " ", "second", " ", "kind", " ", "associated", "\n", "\t", 
      "with", " ", "the", " ", "sequence", " ", "seq", "\n", "\n", 
      RowBox[{"LPPolynomialsConversionCoefficient", "[", 
       RowBox[{"seq", ",", " ", "linkpattern"}], "]"}], "\n", "\t", 
      "Computes", " ", "the", " ", "coefficient", " ", "of", " ", 
      "Psi_linkpattern", " ", "in", " ", "the", " ", "linear", " ", 
      "expansion", " ", "of", " ", "Phi_seq", " ", "in", " ", "the", " ", 
      "link", " ", "pattern", " ", "basis", "\n", "\t", "\n", 
      RowBox[{"LPPolynomialsConversionCoefficientVariant", "[", 
       RowBox[{"linkpattern1", ",", " ", "linkpattern2"}], "]"}], "\n", "\t", 
      "Same", " ", "as", " ", 
      RowBox[{"LPPolynomialsConversionCoefficient", "[", 
       RowBox[{"seq", ",", " ", "linkpattern2"}], "]"}], " ", "where", " ", 
      "seq", " ", "is", " ", "the", " ", "opening", " ", "positions", " ", 
      "sequence", "\n", "\t", "of", " ", "linkpattern1", "\n", "\t", "\n", 
      RowBox[{"LPPolynomialChangeOfBasisMatrix", "[", "order", "]"}], "\n", 
      "\t", "Computes", " ", "the", " ", "change", " ", "of", " ", "basis", 
      " ", "matrix", " ", "between", " ", "the", " ", "link", " ", "pattern", 
      " ", "polynomial", " ", "bases", " ", "of", " ", "the", " ", "first", 
      " ", "and", " ", "second", " ", "kinds", "\n", "\t", "of", " ", "given",
       " ", "order", "\n", "\t", "\n", 
      RowBox[{"LPPolynomialInverseChangeOfBasisMatrix", "[", "order", "]"}], 
      "\n", "\t", "Computes", " ", "the", " ", "change", " ", "of", " ", 
      "basis", " ", "matrix", " ", "between", " ", "the", " ", "link", " ", 
      "pattern", " ", "polynomial", " ", "bases", " ", "of", " ", "the", " ", 
      "second", " ", "and", " ", "first", " ", "kinds", "\n", "\t", "of", " ",
       "given", " ", "order", " ", 
      RowBox[{"(", 
       RowBox[{"the", " ", "inverse", " ", "matrix", " ", "of", " ", 
        RowBox[{"LPPolynomialChangeOfBasisMatrix", "[", "order", "]"}]}], 
       ")"}]}]}]}], "\n", "\n", "\n", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatternsInfoMessage", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<linkpatterns version 1.1\\nCopyright (c) 2014 Dan Romik\\nType \
LinkPatternsHelp[] for more information\>\"", "]"}], ";"}]}], "\n", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"LinkPatternsHelp", "[", "]"}], ":=", 
    RowBox[{
    "Print", "[", 
     "\"\<Package Documentation is included as a comment block in the source \
file\>\"", "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"TODO", " ", "add", " ", "this"}], " ", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"LinkPatternsInfoMessage", "[", "]"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NumLinkPatterns", "[", "n_", "]"}], ":=", 
     RowBox[{"CatalanNumber", "[", "n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ListProduct", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"b", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "a", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "b", "]"}]}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatterns", "[", "n_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "}"}], "}"}], ",", "\n", "\t", 
       RowBox[{"Apply", "[", 
        RowBox[{"Join", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ListProduct", "[", 
            RowBox[{
             RowBox[{"ListProduct", "[", 
              RowBox[{
               RowBox[{"ListProduct", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", "1", "}"}], "}"}], ",", 
                 RowBox[{"LinkPatterns", "[", 
                  RowBox[{"k", "-", "1"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"-", "1"}], "}"}], "}"}]}], "]"}], ",", 
             RowBox[{"LinkPatterns", "[", 
              RowBox[{"n", "-", "k"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], 
      "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MinimalLinkPattern", "[", "order_", "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MaximalLinkPattern", "[", "order_", "]"}], ":=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MatchingPartner", "[", 
      RowBox[{"linkpattern_", ",", "element_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "s"}], "}"}], ",", "\n", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"linkpattern", "[", 
           RowBox[{"[", "element", "]"}], "]"}], "==", "1"}], ",", "\n", 
         "\t\t", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "=", "1"}], ";", 
           RowBox[{"i", "=", "element"}], ";", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"s", ">", "0"}], ",", 
             RowBox[{
              RowBox[{"i", "=", 
               RowBox[{"i", "+", "1"}]}], ";", 
              RowBox[{"s", "=", 
               RowBox[{"s", "+", 
                RowBox[{"linkpattern", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "]"}], ";", "i"}], 
          ")"}], ",", "\n", "\t\t", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "=", "1"}], ";", 
           RowBox[{"i", "=", "element"}], ";", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"s", ">", "0"}], ",", 
             RowBox[{
              RowBox[{"i", "=", 
               RowBox[{"i", "-", "1"}]}], ";", 
              RowBox[{"s", "=", 
               RowBox[{"s", "-", 
                RowBox[{"linkpattern", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "]"}], ";", "i"}], 
          ")"}]}], "\n", "\t", "]"}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatternToNoncrossingMatching", "[", "linkpattern_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"MatchingPartner", "[", 
        RowBox[{"linkpattern", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "linkpattern", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatternToDyckPath", "[", "linkpattern_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", ",", " ", "len"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"len", "=", 
         RowBox[{
          RowBox[{"Length", "[", "linkpattern", "]"}], "/", "2"}]}], ";", 
        "\n", "\t", 
        RowBox[{"d", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{
              RowBox[{"2", "len"}], "+", "1"}]}], "}"}]}], "]"}]}], ";", "\n",
         "\t", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"d", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"d", "[", 
             RowBox[{"[", 
              RowBox[{"j", "-", "1"}], "]"}], "]"}], "+", 
            RowBox[{"linkpattern", "[", 
             RowBox[{"[", 
              RowBox[{"j", "-", "1"}], "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", 
            RowBox[{"2", "len"}]}], "}"}]}], "]"}], ";", "\n", "\t", "d"}]}], 
      "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatternToYoungDiagram", "[", "linkpattern_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"len", ",", "positions"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"len", "=", 
         RowBox[{
          RowBox[{"Length", "[", "linkpattern", "]"}], "/", "2"}]}], ";", 
        "\n", "\t", 
        RowBox[{"positions", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"First", ",", 
           RowBox[{"Position", "[", 
            RowBox[{"linkpattern", ",", "1"}], "]"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"positions", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "-", "j"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", "len"}], "}"}]}], "]"}], "]"}]}]}], 
      "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
     "NoncrossingMatchingToLinkPattern", "[", "noncrossingmatching_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"noncrossingmatching", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ">", "j"}], ",", "1", ",", 
         RowBox[{"-", "1"}]}], "]"}], ",", "\n", 
       "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "noncrossingmatching", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NoncrossingMatchings", "[", "n_", "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{"LinkPatternToNoncrossingMatching", ",", 
       RowBox[{"LinkPatterns", "[", "n", "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   
   RowBox[{
    RowBox[{
     RowBox[{"ApplyTLOperatorToLinkPattern", "[", 
      RowBox[{"linkpattern_", ",", "index_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "newlinkpattern", ",", "partner", ",", "index2", ",", "partner2"}], 
        "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"newlinkpattern", "=", "linkpattern"}], ";", "\n", "\t", 
        RowBox[{"index2", "=", 
         RowBox[{"index", "+", "1"}]}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"index2", ">", 
           RowBox[{"Length", "[", "linkpattern", "]"}]}], ",", 
          RowBox[{"index2", "=", "1"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"partner", "=", 
         RowBox[{"MatchingPartner", "[", 
          RowBox[{"linkpattern", ",", "index"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"partner2", "=", 
         RowBox[{"MatchingPartner", "[", 
          RowBox[{"linkpattern", ",", "index2"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"partner", "!=", "index2"}], ",", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"newlinkpattern", "[", 
             RowBox[{"[", "partner", "]"}], "]"}], "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"partner", "<", "partner2"}], ",", "1", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{
            RowBox[{"newlinkpattern", "[", 
             RowBox[{"[", "partner2", "]"}], "]"}], "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"partner", "<", "partner2"}], ",", 
              RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"index2", "==", "1"}], ",", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"newlinkpattern", "[", 
                RowBox[{"[", "index", "]"}], "]"}], "=", 
               RowBox[{"-", "1"}]}], ";", 
              RowBox[{
               RowBox[{"newlinkpattern", "[", 
                RowBox[{"[", "index2", "]"}], "]"}], "=", "1"}]}], ",", "\n", 
             "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"newlinkpattern", "[", 
                RowBox[{"[", "index", "]"}], "]"}], "=", "1"}], ";", 
              RowBox[{
               RowBox[{"newlinkpattern", "[", 
                RowBox[{"[", "index2", "]"}], "]"}], "=", 
               RowBox[{"-", "1"}]}], ";"}]}], "]"}]}]}], "]"}], ";", "\n", 
        "\t", "newlinkpattern"}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TLOperatorMatrix", "[", 
      RowBox[{"order_", ",", "index_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "linkpatterns", ",", "size", ",", "matrix", ",", "linkpattern2", ",", 
         "j"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"linkpatterns", "=", 
         RowBox[{"LinkPatterns", "[", "order", "]"}]}], ";", "\n", "\t", 
        RowBox[{"size", "=", 
         RowBox[{"Length", "[", "linkpatterns", "]"}]}], ";", "\n", "\t", 
        RowBox[{"matrix", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", "\n",
         "\t", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"linkpattern2", "=", 
            RowBox[{"ApplyTLOperatorToLinkPattern", "[", 
             RowBox[{
              RowBox[{"linkpatterns", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "index"}], "]"}]}], ";", 
           "\n", "\t", 
           RowBox[{"j", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"linkpatterns", ",", "linkpattern2"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"matrix", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "1"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", "\n", 
        "\t", "matrix"}]}], "\n", "]"}]}], ";"}], "\n", "\t", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RazumovStroganovMatrix", "[", "order_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"TLOperatorMatrix", "[", 
        RowBox[{"order", ",", "index"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"index", ",", "1", ",", 
         RowBox[{"2", " ", "order"}]}], "}"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RazumovStroganovEigenvector", "[", "order_", "]"}], ":=", 
     RowBox[{"First", "[", "\n", "\t", 
      RowBox[{"NullSpace", "[", 
       RowBox[{
        RowBox[{"RazumovStroganovMatrix", "[", "order", "]"}], "-", 
        RowBox[{"2", " ", "order", " ", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"CatalanNumber", "[", "order", "]"}], "]"}]}]}], "]"}], 
      "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RazumovStroganovAperiodicMatrix", "[", "order_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"TLOperatorMatrix", "[", 
        RowBox[{"order", ",", "index"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"index", ",", "1", ",", 
         RowBox[{
          RowBox[{"2", " ", "order"}], "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RazumovStroganovAperiodicEigenvector", "[", "order_", "]"}], ":=", 
     RowBox[{"First", "[", "\n", "\t", 
      RowBox[{"NullSpace", "[", 
       RowBox[{
        RowBox[{"RazumovStroganovAperiodicMatrix", "[", "order", "]"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "order"}], "-", "1"}], ")"}], " ", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"CatalanNumber", "[", "order", "]"}], "]"}]}]}], "]"}], 
      "\n", "]"}]}], ";"}], "\n", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatternRightNestingLevels", "[", "linkpattern_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"len", ",", "dyck", ",", "noncrossingmatching"}], "}"}], ",", 
       "\n", "\t", 
       RowBox[{
        RowBox[{"len", "=", 
         RowBox[{
          RowBox[{"Length", "[", "linkpattern", "]"}], "/", "2"}]}], ";", 
        "\n", "\t", 
        RowBox[{"dyck", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{
              RowBox[{"2", "len"}], "+", "1"}]}], "}"}]}], "]"}]}], ";", "\n",
         "\t", 
        RowBox[{"noncrossingmatching", "=", 
         RowBox[{
         "LinkPatternToNoncrossingMatching", "[", "linkpattern", "]"}]}], ";",
         "\n", "\t", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dyck", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"dyck", "[", 
             RowBox[{"[", 
              RowBox[{"j", "-", "1"}], "]"}], "]"}], "+", 
            RowBox[{"linkpattern", "[", 
             RowBox[{"[", 
              RowBox[{"j", "-", "1"}], "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", 
            RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"dyck", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"dyck", "[", 
               RowBox[{"[", 
                RowBox[{"Min", "[", 
                 RowBox[{"j", ",", 
                  RowBox[{"noncrossingmatching", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
             ",", "\n", "\t\t\t", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Min", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"noncrossingmatching", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"noncrossingmatching", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}]}]}], "\n", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatternLeftNestingLevels", "[", "linkpattern_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"len", ",", "dyck", ",", "noncrossingmatching"}], "}"}], ",", 
       "\n", "\t", 
       RowBox[{
        RowBox[{"len", "=", 
         RowBox[{
          RowBox[{"Length", "[", "linkpattern", "]"}], "/", "2"}]}], ";", 
        "\n", "\t", 
        RowBox[{"dyck", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{
              RowBox[{"2", "len"}], "+", "1"}]}], "}"}]}], "]"}]}], ";", "\n",
         "\t", 
        RowBox[{"noncrossingmatching", "=", 
         RowBox[{
         "LinkPatternToNoncrossingMatching", "[", "linkpattern", "]"}]}], ";",
         "\n", "\t", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dyck", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"dyck", "[", 
             RowBox[{"[", 
              RowBox[{"j", "-", "1"}], "]"}], "]"}], "+", 
            RowBox[{"linkpattern", "[", 
             RowBox[{"[", 
              RowBox[{"j", "-", "1"}], "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", 
            RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"dyck", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"dyck", "[", 
                 RowBox[{"[", 
                  RowBox[{"Min", "[", 
                   RowBox[{"j", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
               ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"j", ",", 
                   RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"2", " ", "len"}], "+", "1"}]}], "}"}]}], "]"}], 
             "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Max", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"dyck", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"dyck", "[", 
                 RowBox[{"[", 
                  RowBox[{"Min", "[", 
                   RowBox[{"j", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
               ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{"j", ",", 
                   RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}],
              "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}]}]}], "\n", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Arches", "[", "linkpattern_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "noncrossingmatching", "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"noncrossingmatching", "=", 
         RowBox[{
         "LinkPatternToNoncrossingMatching", "[", "linkpattern", "]"}]}], ";",
         "\n", "\t", 
        RowBox[{"Union", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"j", ",", 
               RowBox[{"noncrossingmatching", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{"j", ",", 
               RowBox[{"noncrossingmatching", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "}"}], ",", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "noncrossingmatching", "]"}]}], "}"}]}], 
          "]"}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LittleArch", "[", "linkpattern_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "pos", "}"}], ",", 
       RowBox[{
        RowBox[{"pos", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"linkpattern", "[", 
             RowBox[{"[", "pos", "]"}], "]"}], "!=", "1"}], "||", 
           RowBox[{
            RowBox[{"linkpattern", "[", 
             RowBox[{"[", 
              RowBox[{"pos", "+", "1"}], "]"}], "]"}], "!=", 
            RowBox[{"-", "1"}]}]}], ",", 
          RowBox[{"pos", "=", 
           RowBox[{"pos", "+", "1"}]}]}], "]"}], ";", "pos"}]}], "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OpeningPositions", "[", "linkpattern_", "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{"First", ",", 
       RowBox[{"Position", "[", 
        RowBox[{"linkpattern", ",", "1"}], "]"}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LittleArches", "[", 
      RowBox[{"linkpattern_", ",", "wraparound_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"arches", ",", "len"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"arches", "=", 
         RowBox[{"Arches", "[", "linkpattern", "]"}]}], ";", "\n", "\t", 
        RowBox[{"len", "=", 
         RowBox[{"Length", "[", "linkpattern", "]"}]}], ";", "\n", "\t", 
        RowBox[{"Select", "[", 
         RowBox[{"arches", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{"wraparound", " ", "&&", " ", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "==", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "len", "-", "1"}]}]}], 
             ")"}]}], "&"}]}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LittleArches", "[", "linkpattern_", "]"}], ":=", 
     RowBox[{"LittleArches", "[", 
      RowBox[{"linkpattern", ",", "True"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfLittleArches", "[", 
      RowBox[{"linkpattern_", ",", " ", "wraparound_"}], "]"}], ":=", 
     RowBox[{"Length", "[", 
      RowBox[{"LittleArches", "[", 
       RowBox[{"linkpattern", ",", " ", "wraparound"}], "]"}], "]"}]}], ";"}],
    "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfLittleArches", "[", "linkpattern_", "]"}], ":=", 
     RowBox[{"Length", "[", 
      RowBox[{"LittleArches", "[", "linkpattern", "]"}], "]"}]}], ";"}], "\n",
    "\n", 
   RowBox[{
    RowBox[{"RotateLinkPatternForward", "[", "linkpattern_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "PartnerOfLastElement", "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"PartnerOfLastElement", "=", 
        RowBox[{"Last", "[", 
         RowBox[{
         "LinkPatternToNoncrossingMatching", "[", "linkpattern", "]"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", "\n", "\t\t ", 
         RowBox[{"linkpattern", "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", 
             RowBox[{"PartnerOfLastElement", "-", "1"}]}], "]"}], "]"}], 
          "]"}], ",", "\n", "\t\t ", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}], ",", "\n", "\t\t ", 
         RowBox[{"linkpattern", "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"PartnerOfLastElement", "+", "1"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "linkpattern", "]"}], "-", "1"}]}], 
            "]"}], "]"}], "]"}]}], "]"}]}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"RotateLinkPatternBack", "[", "linkpattern_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "PartnerOfFirstElement", "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"PartnerOfFirstElement", "=", 
        RowBox[{"First", "[", 
         RowBox[{
         "LinkPatternToNoncrossingMatching", "[", "linkpattern", "]"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"linkpattern", "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", 
            RowBox[{"2", ",", 
             RowBox[{"PartnerOfFirstElement", "-", "1"}]}], "]"}], "]"}], 
          "]"}], ",", "\n", "\t\t ", 
         RowBox[{"{", "1", "}"}], ",", "\n", "\t\t ", 
         RowBox[{"linkpattern", "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"PartnerOfFirstElement", "+", "1"}], ",", 
             RowBox[{"Length", "[", "linkpattern", "]"}]}], "]"}], "]"}], 
          "]"}], ",", "\n", "\t\t ", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}]}], "]"}]}]}], "\n", "]"}]}], "\n", "\n", 
   "\n", "\n", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatternGraphicsCircular", "[", 
      RowBox[{"linkpattern_", ",", "numbered_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "len", ",", "noncrossingmatching", ",", "nestinglevels", ",", 
         "nestinglevels1", ",", "nestinglevels2"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"len", "=", 
         RowBox[{
          RowBox[{"Length", "[", "linkpattern", "]"}], "/", "2"}]}], ";", 
        "\n", "\t", 
        RowBox[{"noncrossingmatching", "=", 
         RowBox[{
         "LinkPatternToNoncrossingMatching", "[", "linkpattern", "]"}]}], ";",
         "\n", "\t", 
        RowBox[{"nestinglevels1", "=", 
         RowBox[{"LinkPatternRightNestingLevels", "[", "linkpattern", "]"}]}],
         ";", "\n", "\t", 
        RowBox[{"nestinglevels2", "=", 
         RowBox[{"LinkPatternLeftNestingLevels", "[", "linkpattern", "]"}]}], 
        ";", "\n", "\t", 
        RowBox[{"nestinglevels", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"nestinglevels1", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"nestinglevels2", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "nestinglevels1", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Circle", "[", "]"}], "}"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"Pi", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], " ", 
                    RowBox[{"Pi", "/", "len"}]}]}], "]"}], ",", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"Pi", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], " ", 
                    RowBox[{"Pi", "/", "len"}]}]}], "]"}]}], "}"}], ",", 
               RowBox[{"0.4", "/", 
                RowBox[{"(", 
                 RowBox[{"len", "+", "10"}], ")"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", 
               RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}], ",", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"Union", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"BezierCurve", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"Pi", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "-", "1"}], 
                    ")"}], " ", 
                    RowBox[{"Pi", "/", "len"}]}]}], "]"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"Pi", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "-", "1"}], 
                    ")"}], " ", 
                    RowBox[{"Pi", "/", "len"}]}]}], "]"}]}], "}"}], ",", "\n",
                  "\t\t\t\t\t\t\t\t\t ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"nestinglevels", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"len", "+", "1"}], ")"}]}]}]}], ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"Pi", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], 
                    RowBox[{"Pi", "/", "len"}]}]}], "]"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t \t", "+", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"Pi", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "-", "1"}], ")"}], 
                    RowBox[{"Pi", "/", "len"}]}]}], "]"}]}], ")"}], "/", 
                    "2"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t  ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"nestinglevels", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"len", "+", "1"}], ")"}]}]}]}], ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{"Pi", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], 
                    RowBox[{"Pi", "/", "len"}]}]}], "]"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t \t", "+", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"Pi", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "-", "1"}], ")"}], 
                    RowBox[{"Pi", "/", "len"}]}]}], "]"}]}], ")"}], "/", 
                    "2"}]}]}], "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"Pi", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "-", "1"}], 
                    ")"}], " ", 
                    RowBox[{"Pi", "/", "len"}]}]}], "]"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t  ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"Pi", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "-", "1"}], 
                    ")"}], " ", 
                    RowBox[{"Pi", "/", "len"}]}]}], "]"}]}], "}"}]}], "}"}], 
               "\n", "\t\t\t\t\t\t\t\t", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}], "]"}], ",", "\n",
            "\t\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"numbered", ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"n", ",", "18"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1.1", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"Pi", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], " ", 
                    RowBox[{"Pi", "/", "len"}]}]}], "]"}]}], ",", 
                   RowBox[{"1.1", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"Pi", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], " ", 
                    RowBox[{"Pi", "/", "len"}]}]}], "]"}]}]}], "}"}]}], "]"}],
                ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"{", "}"}]}], "]"}]}], "]"}], "\n", "\t\t\t", "]"}]}]}], 
      "\n", "]"}]}], ";"}], "\n", "\t", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatternGraphicsLinear", "[", 
      RowBox[{"linkpattern_", ",", " ", "numbered_"}], "]"}], " ", ":=", " ", 
     
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "len", ",", " ", "noncrossingmatching", ",", " ", "nestinglevels", 
         ",", " ", "dyck"}], "}"}], ",", " ", "\n", "   ", 
       RowBox[{
        RowBox[{"len", " ", "=", " ", 
         RowBox[{
          RowBox[{"Length", "[", "linkpattern", "]"}], "/", "2"}]}], ";", 
        "\n", "   ", 
        RowBox[{"noncrossingmatching", " ", "=", " ", 
         RowBox[{
         "LinkPatternToNoncrossingMatching", "[", "linkpattern", "]"}]}], ";",
         "\n", "   ", 
        RowBox[{"dyck", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "1", ",", " ", 
             RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}]}], ";", "\n", "   ", 
        
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dyck", "[", 
            RowBox[{"[", "j", "]"}], "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"dyck", "[", 
             RowBox[{"[", 
              RowBox[{"j", " ", "-", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
            
            RowBox[{"linkpattern", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "2", ",", " ", 
            RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}], ";", "\n", "   ", 
        RowBox[{"nestinglevels", " ", "=", " ", 
         RowBox[{"LinkPatternRightNestingLevels", "[", "linkpattern", "]"}]}],
         ";", "\n", "   ", 
        RowBox[{"Graphics", "[", "\n", "\t\t", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"AbsoluteThickness", "[", "1.5", "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.5", ",", " ", "0"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"2", " ", "len"}], " ", "+", " ", "0.5"}], ",", 
                  " ", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", " ", "\n", 
           "\t\t\t", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"n", ",", " ", "0"}], "}"}], ",", " ", 
               RowBox[{"2", "/", 
                RowBox[{"(", 
                 RowBox[{"len", " ", "+", " ", "10"}], ")"}]}]}], "]"}], ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"n", ",", " ", "1", ",", " ", 
               RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}], ",", " ", "\n", 
           "\t\t\t", 
           RowBox[{"Union", "[", 
            RowBox[{"Table", "[", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Circle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"n", ",", " ", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], " ", "+", " ", 
                    RowBox[{"nestinglevels", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{"1", "/", "2"}]}], ",", " ", "0"}], "}"}], ",", 
                  " ", 
                  RowBox[{
                   RowBox[{"nestinglevels", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], " ", "-", " ", 
                   RowBox[{"1", "/", "2"}]}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Pi", "/", "2"}], ",", " ", "Pi"}], "}"}]}], 
                 "]"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"Circle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"n", ",", " ", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], " ", "-", " ", 
                    RowBox[{"nestinglevels", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"1", "/", "2"}]}], ",", " ", "0"}], "}"}], ",", 
                  " ", 
                  RowBox[{
                   RowBox[{"nestinglevels", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], " ", "-", " ", 
                   RowBox[{"1", "/", "2"}]}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", 
                    RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}], ",", "\n", 
                "\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"n", ",", " ", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "+", 
                    RowBox[{"nestinglevels", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "-", 
                    RowBox[{"1", "/", "2"}]}], "<", 
                   RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "-", 
                    RowBox[{"nestinglevels", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", " ", 
                    RowBox[{"1", "/", "2"}]}]}], ",", " ", "\n", 
                  "\t\t\t\t\t\t", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"n", ",", " ", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], " ", "+", " ", 
                    RowBox[{"nestinglevels", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{"1", "/", "2"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"nestinglevels", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{"1", "/", "2"}]}]}], "}"}], ",", " ", "\n", 
                    "\t\t\t\t\t\t\t  ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"n", ",", " ", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], " ", "-", " ", 
                    RowBox[{"nestinglevels", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"1", "/", "2"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"nestinglevels", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{"1", "/", "2"}]}]}], "}"}]}], "}"}], "]"}], ",", 
                  " ", 
                  RowBox[{"{", "}"}]}], "\n", "\t\t\t\t\t  ", "]"}]}], "\n", 
               "\t\t\t\t", "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"n", ",", " ", "1", ",", " ", 
                RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}], "]"}], ",", " ", 
           "\n", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"numbered", ",", " ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"n", ",", " ", "14"}], "]"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", " ", 
                   RowBox[{"-", "0.6"}]}], "}"}]}], "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"n", ",", " ", "1", ",", " ", 
                 RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}], ",", " ", 
             RowBox[{"{", "}"}]}], "]"}]}], "]"}], "\n", "   ", "]"}]}]}], 
      "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NoncrossingMatchingGraphicsCircular", "[", 
      RowBox[{"matching_", ",", " ", "numbered_"}], "]"}], " ", ":=", "\n", 
     "  ", 
     RowBox[{"LinkPatternGraphicsCircular", "[", 
      RowBox[{
       RowBox[{"NoncrossingMatchingToLinkPattern", "[", "matching", "]"}], 
       ",", "numbered"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NoncrossingMatchingGraphicsLinear", "[", 
      RowBox[{"matching_", ",", " ", "numbered_"}], "]"}], " ", ":=", "\n", 
     "  ", 
     RowBox[{"LinkPatternGraphicsLinear", "[", 
      RowBox[{
       RowBox[{"NoncrossingMatchingToLinkPattern", "[", "matching", "]"}], 
       ",", "numbered"}], "]"}]}], ";"}], "\n", "\n", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatternGraphicsDyckPath", "[", 
      RowBox[{
      "linkpattern_", ",", "numbered_", ",", "showlinks_", ",", 
       "showyoungdiagram_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\n", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "len", ",", "noncrossingmatching", ",", "dyckpath", ",", 
         "nestinglevels", ",", "positions1", ",", "positions2"}], "}"}], ",", 
       "\n", "\t", 
       RowBox[{
        RowBox[{"len", "=", 
         RowBox[{
          RowBox[{"Length", "[", "linkpattern", "]"}], "/", "2"}]}], ";", 
        "\n", "\t", 
        RowBox[{"noncrossingmatching", "=", 
         RowBox[{
         "LinkPatternToNoncrossingMatching", "[", "linkpattern", "]"}]}], ";",
         "\n", "\t", 
        RowBox[{"dyckpath", "=", 
         RowBox[{"LinkPatternToDyckPath", "[", "linkpattern", "]"}]}], ";", 
        "\n", "\t", 
        RowBox[{"nestinglevels", "=", 
         RowBox[{"LinkPatternRightNestingLevels", "[", "linkpattern", "]"}]}],
         ";", "\n", "\t", 
        RowBox[{"positions1", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"First", ",", 
           RowBox[{"Position", "[", 
            RowBox[{"linkpattern", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"positions2", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"First", ",", 
           RowBox[{"Position", "[", 
            RowBox[{"linkpattern", ",", "1"}], "]"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"2", "len"}], "+", "1"}], ",", "0"}], "}"}]}], 
               "}"}], "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "-", "1"}], ",", 
                   RowBox[{"dyckpath", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "&"}], ",", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"2", "len"}], "+", "1"}], "]"}]}], "]"}], "]"}]}], 
            "}"}], ",", "\n", "\t\t\t ", 
           RowBox[{"If", "[", 
            RowBox[{"showyoungdiagram", ",", "\n", "\t\t\t \t", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"GrayLevel", "[", "0.9", "]"}], ",", 
                 RowBox[{"Polygon", "[", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "-", "1"}], ",", 
                    RowBox[{"dyckpath", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"2", "len"}], "+", "1"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"len", ",", "len"}], "}"}]}], "]"}], "]"}]}], 
                "}"}], ",", "\n", "\t\t\t \t ", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}], "+", 
                    RowBox[{"dyckpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"positions1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"dyckpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"positions1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"len", "+", "j", "-", "1"}], ",", 
                    RowBox[{"len", "-", "j", "+", "1"}]}], "}"}]}], "}"}], 
                  "]"}], ",", "\n", "\t\t\t \t \t\t", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", "len"}], "}"}]}], "]"}], ",", 
               "\n", "\t\t\t\t ", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"positions2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"dyckpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"positions2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "j"}], "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", "len"}], "}"}]}], "]"}]}], 
              "}"}], ",", "\n", "\t\t\t\t", 
             RowBox[{"{", "}"}]}], "\n", "\t\t\t   ", "]"}], ",", "\n", 
           "\t\t\t ", 
           RowBox[{"If", "[", 
            RowBox[{"numbered", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Disk", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"j", "-", "0.5"}], ",", "0"}], "}"}], ",", 
                   "0.1"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"j", ",", "20"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"j", "-", "0.5"}], ",", 
                    RowBox[{"-", "0.5"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}]}], "}"}], ",", 
             
             RowBox[{"{", "}"}]}], "]"}], ",", "\n", "\t\t\t ", 
           RowBox[{"If", "[", 
            RowBox[{"showlinks", ",", 
             RowBox[{"Union", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Dashing", "[", 
                   RowBox[{"{", 
                    RowBox[{"0.01", ",", "0.01"}], "}"}], "]"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t\t  ", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.5"}], "+", 
                    RowBox[{"Min", "[", 
                    RowBox[{"j", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"len", "+", "0.5"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.5"}], "+", 
                    RowBox[{"Min", "[", 
                    RowBox[{"j", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"dyckpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"Min", "[", 
                    RowBox[{"j", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "]"}], 
                    "+", "0.5"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.5"}], "+", 
                    RowBox[{"Max", "[", 
                    RowBox[{"j", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"dyckpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"Min", "[", 
                    RowBox[{"j", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "]"}], 
                    "+", "0.5"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.5"}], "+", 
                    RowBox[{"Max", "[", 
                    RowBox[{"j", ",", 
                    RowBox[{"noncrossingmatching", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"len", "+", "0.5"}]}], "}"}]}], "}"}], "]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "]"}], "\n", "\t", "]"}]}]}], 
      "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatternGraphicsParticles", "[", 
      RowBox[{"linkpattern_", ",", "numbered_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"len", ",", "particles", ",", "holes"}], "}"}], ",", "\n", 
       "\t", 
       RowBox[{
        RowBox[{"len", "=", 
         RowBox[{
          RowBox[{"Length", "[", "linkpattern", "]"}], "/", "2"}]}], ";", 
        "\n", "\t", 
        RowBox[{"particles", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"First", ",", 
           RowBox[{"Position", "[", 
            RowBox[{"linkpattern", ",", "1"}], "]"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"holes", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"First", ",", 
           RowBox[{"Position", "[", 
            RowBox[{"linkpattern", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"2", " ", "len"}], ",", "0"}], "}"}]}], "}"}], 
              "]"}], ",", "\n", "\t\t\t\t   ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Disk", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"particles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", "0.5"}], ",", "0"}], 
                  "}"}], ",", "0.2"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "len"}], "}"}]}], "]"}], ",", 
             "\n", "\t\t\t\t   ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Circle", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"holes", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", "0.5"}], ",", "0"}], 
                  "}"}], ",", "0.1"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "len"}], "}"}]}], "]"}]}], "}"}], 
           ",", "\n", "\t\t\t\t   ", 
           RowBox[{"If", "[", 
            RowBox[{"numbered", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"j", "-", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"2", " ", "len"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "]"}], "\n", "\t\t\t", "]"}]}]}], 
      "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveTrailingZeros", "[", "diag_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "p", "}"}], ",", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"diag", ",", "0"}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "p", "]"}], "==", "0"}], ",", "diag", ",", 
          RowBox[{"diag", "[", 
           RowBox[{"[", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "]"}], "]"}], 
           "]"}]}], "]"}]}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatternGraphicsYoungDiagram", "[", "linkpattern_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"diag", ",", "diag2"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"diag", "=", 
         RowBox[{"RemoveTrailingZeros", "[", 
          RowBox[{"LinkPatternToYoungDiagram", "[", "linkpattern", "]"}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"diag2", "=", 
         RowBox[{"RemoveTrailingZeros", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Select", "[", 
              RowBox[{"diag", ",", " ", 
               RowBox[{
                RowBox[{"#", " ", ">=", " ", "j"}], " ", "&"}]}], "]"}], 
             "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", "1", ",", " ", 
              RowBox[{"Max", "[", 
               RowBox[{"Append", "[", 
                RowBox[{"diag", ",", "0"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"diag", "==", 
           RowBox[{"{", "}"}]}], ",", "\n", "\t   ", 
          RowBox[{"Graphics", "[", "]"}], ",", "\n", "\t   ", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"diag", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], 
                 "}"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"-", 
                    RowBox[{"diag2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], "}"}], 
                "]"}]}], "}"}], ",", "\n", "\t\t\t\t\t  ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"-", "j"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"diag", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"-", "j"}]}], "}"}]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", "diag", "]"}]}], "}"}]}], "]"}], ",", 
             "\n", "\t\t\t\t\t  ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"j", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"-", 
                    RowBox[{"diag2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], "}"}], "]"}],
                ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", "diag2", "]"}]}], "}"}]}], "]"}]}], 
            "]"}], "\n", "\t\t\t   ", "]"}]}], "\n", "\t  ", "]"}]}]}], "\n", 
      "]"}]}], ";"}], "\n", "\n", "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Code", " ", "for", " ", "sampling", " ", "random", " ", "link", " ", 
      "patterns", " ", "from", " ", "the", " ", "Razumov"}], "-", 
     RowBox[{"Stroganov", " ", "distribution"}]}], " ", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"InitialDoubleSidedLinkPattern", "[", "n_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"1", "+", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"i", "-", "1", "+", 
           RowBox[{"2", "n"}]}], ",", 
          RowBox[{"4", "n"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"4", "n"}]}], "}"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplyTLOperatorToDSLP", "[", 
      RowBox[{"lp_", ",", "index_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "order", ",", "index2", ",", "partner", ",", "partner2", ",", 
         "newlp"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"order", "=", 
         RowBox[{
          RowBox[{"Length", "[", "lp", "]"}], "/", "4"}]}], ";", "\n", "\t", 
        RowBox[{"index2", "=", 
         RowBox[{"index", "+", "1"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"index2", ">", 
           RowBox[{"2", " ", "order"}]}], ",", 
          RowBox[{"index2", "=", "1"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"partner", "=", 
         RowBox[{"lp", "[", 
          RowBox[{"[", "index", "]"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"partner2", "=", 
         RowBox[{"lp", "[", 
          RowBox[{"[", "index2", "]"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"disconnectedflag", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"partner", ">", 
            RowBox[{"2", " ", "order"}]}], "&&", 
           RowBox[{"partner2", ">", 
            RowBox[{"2", " ", "order"}]}]}], ")"}]}], ";", "\n", "\t", 
        RowBox[{"newlp", "=", "lp"}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"partner", "!=", "index2"}], ",", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"newlp", "[", 
             RowBox[{"[", "index", "]"}], "]"}], "=", "index2"}], ";", 
           RowBox[{
            RowBox[{"newlp", "[", 
             RowBox[{"[", "index2", "]"}], "]"}], "=", "index"}], ";", 
           RowBox[{
            RowBox[{"newlp", "[", 
             RowBox[{"[", "partner", "]"}], "]"}], "=", "partner2"}], ";", 
           RowBox[{
            RowBox[{"newlp", "[", 
             RowBox[{"[", "partner2", "]"}], "]"}], "=", "partner"}]}]}], 
         "\n", "\t  ", "]"}], ";", "\n", "\t", "newlp"}]}], "\n", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DSLPDisconnectedQ", "[", "lp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "halflength", "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"halflength", "=", 
         RowBox[{
          RowBox[{"Length", "[", "lp", "]"}], "/", "2"}]}], ";", "\n", "\t", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"lp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "<=", "halflength"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "halflength"}], "}"}]}], "]"}]}], 
         "]"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"RandomLinkPattern", "[", "order_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lp", ",", "count", ",", "twiceorder"}], "}"}], ",", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"twiceorder", "=", 
        RowBox[{"2", " ", "order"}]}], ";", "\n", "\t", 
       RowBox[{"lp", "=", 
        RowBox[{"InitialDoubleSidedLinkPattern", "[", "order", "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"doublesidedconnections", "=", "order"}], ";", "\n", "\t", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"doublesidedconnections", ">", "0"}], ",", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"lp", "=", 
           RowBox[{"ApplyTLOperatorToDSLP", "[", 
            RowBox[{"lp", ",", 
             RowBox[{"Random", "[", 
              RowBox[{"Integer", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "twiceorder"}], "}"}]}], "]"}]}], "]"}]}], 
          ";", "\n", "\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{"disconnectedflag", ",", 
            RowBox[{"doublesidedconnections", "=", 
             RowBox[{"doublesidedconnections", "-", "1"}]}]}], "]"}]}]}], 
        "\n", "\t\t ", "]"}], ";", "\n", "\t", 
       RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
        RowBox[{
         RowBox[{"lp", "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"twiceorder", "+", "1"}], ",", 
             RowBox[{"4", " ", "order"}]}], "]"}], "]"}], "]"}], "-", 
         "twiceorder"}], "]"}]}]}], "\n", "]"}]}], "\n", "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"MultiCartesianProduct", "[", "lists_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{"Outer", ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "List", "}"}], ",", "lists"}], "]"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"Length", "[", "lists", "]"}], "-", "1"}]}], "]"}]}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Old", " ", "routine", " ", "for", " ", "computing", " ", "link", " ", 
      "pattern", " ", "polynomials", " ", "of", " ", "the", " ", "second", 
      " ", "kind"}], " ", "-", " ", 
     RowBox[{"keeping", " ", "for", " ", "future", " ", "reference"}]}], " ", 
    "*)"}], "\n", 
   RowBox[{"(*", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"NilpPolynomialOld", "[", 
       RowBox[{"linkpattern_", ",", " ", "var_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "len", ",", "positions", ",", "vectors", ",", "prefactor", ",", 
          "sum"}], "}"}], ",", 
        RowBox[{
         RowBox[{"len", "=", 
          RowBox[{
           RowBox[{"Length", "[", "linkpattern", "]"}], "/", "2"}]}], ";", 
         RowBox[{"positions", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"Position", "[", 
            RowBox[{"linkpattern", ",", "1"}], "]"}]}]}], ";", "\n", 
         RowBox[{"vectors", "=", 
          RowBox[{"MultiCartesianProduct", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"positions", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "len"}], "}"}]}], "]"}], "]"}]}], 
         ";", "\n", 
         RowBox[{"prefactor", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"len", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"len", "-", "1"}], ")"}], "/", "2"}]}], ")"}]}], 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"q", " ", 
               RowBox[{"var", "[", "j", "]"}]}], "-", 
              RowBox[{
               RowBox[{"q", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}]}], " ", 
               RowBox[{"var", "[", "k", "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{
                RowBox[{"2", "len"}], "-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"j", "+", "1"}], ",", 
               RowBox[{"2", "len"}]}], "}"}]}], "]"}]}]}], ";", "\n", 
         RowBox[{"sum", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Product", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"var", "[", 
                   RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], "-", 
                  RowBox[{"var", "[", 
                   RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"q", " ", 
                   RowBox[{"var", "[", 
                    RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"q", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}]}], 
                   RowBox[{"var", "[", 
                    RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}]}]}], ")"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"len", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"j", "+", "1"}], ",", "len"}], "}"}]}], "]"}], "\n", 
             "\t\t", "/", 
             RowBox[{"Product", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"q", " ", 
                    RowBox[{"var", "[", 
                    RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"q", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}]}], 
                    RowBox[{"var", "[", "k", "]"}]}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", 
                    RowBox[{"2", "len"}]}], "}"}]}], "]"}], 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "!=", "k"}], ",", 
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "-", 
                    RowBox[{"var", "[", "k", "]"}]}], ",", "1"}], "]"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], "\n", 
               ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "len"}], "}"}]}], "]"}]}], "\n", 
            ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "1", ",", 
              RowBox[{"Length", "[", "vectors", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\n", 
         RowBox[{"Simplify", "[", 
          RowBox[{"prefactor", "*", "sum"}], "]"}]}]}], "]"}]}], ";"}], "\n", 
    "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfInversions", "[", "seq_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ">", 
          RowBox[{"seq", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ",", "1", ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "seq", "]"}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"j", "+", "1"}], ",", 
         RowBox[{"Length", "[", "seq", "]"}]}], "}"}]}], "]"}]}], ";"}], "\n",
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LPPolynomialsOfSecondKind", "[", 
      RowBox[{"seq_", ",", " ", "var_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vectors", ",", "n"}], "}"}], ",", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "seq", "]"}]}], ";", "\n", 
         RowBox[{"vectors", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"MultiCartesianProduct", "[", 
             RowBox[{"Map", "[", 
              RowBox[{"Range", ",", "seq"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Union", "[", "#", "]"}], "]"}], "==", "n"}], "&"}]}], 
           "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], "^", 
               RowBox[{"NumberOfInversions", "[", 
                RowBox[{"vectors", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], " ", 
              RowBox[{"Product", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", " ", 
                  RowBox[{"var", "[", 
                   RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"q", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}]}], " ", 
                  RowBox[{"var", "[", 
                   RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"j", "+", "1"}], ",", "n"}], "}"}]}], "]"}], "\n", 
              RowBox[{
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}]}], 
                    ")"}], "||", 
                    RowBox[{"k", "<=", 
                    RowBox[{"seq", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], ",", 
                   RowBox[{
                    RowBox[{"q", " ", 
                    RowBox[{"var", "[", "j", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"q", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}]}], " ", 
                    RowBox[{"var", "[", "k", "]"}]}]}], ",", "1"}], "]"}], 
                 " ", ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{
                    RowBox[{"2", "n"}], "-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"j", "+", "1"}], ",", 
                   RowBox[{"2", "n"}]}], "}"}]}], "]"}], "/", 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "k"}], "]"}]}], 
                    ")"}], "||", 
                    RowBox[{"k", ">", 
                    RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ",", 
                   RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{
                    RowBox[{"vectors", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "-", 
                    RowBox[{"var", "[", "k", "]"}]}], ",", "1"}], "]"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", 
                   RowBox[{"seq", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
             "\n", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "vectors", "]"}]}], "}"}]}], "]"}], "/.", 
           RowBox[{
            RowBox[{"q", "^", "k_"}], "->", 
            RowBox[{"q", "^", 
             RowBox[{"Mod", "[", 
              RowBox[{"k", ",", "3"}], "]"}]}]}]}], "//", "Simplify"}]}]}], 
       "\n", "]"}], "/.", 
      RowBox[{
       RowBox[{"q", "^", "k_"}], "->", 
       RowBox[{"q", "^", 
        RowBox[{"Mod", "[", 
         RowBox[{"k", ",", "3"}], "]"}]}]}]}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LPPolynomialsConversionCoefficient", "[", 
      RowBox[{"sequence_", ",", "linkpattern_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"counts", ",", "arches", ",", "len"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"len", "=", 
         RowBox[{
          RowBox[{"Length", "[", "linkpattern", "]"}], "/", "2"}]}], ";", 
        "\n", "\t", 
        RowBox[{"arches", "=", 
         RowBox[{"Arches", "[", "linkpattern", "]"}]}], ";", "\n", "\t", 
        RowBox[{"counts", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"Plus", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"arches", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<=", "#", "<", 
                    RowBox[{
                    RowBox[{"arches", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "1", ",", "0"}], 
                  "]"}], "&"}], ",", "sequence"}], "]"}]}], "]"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"arches", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{
                RowBox[{"arches", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}], "/", 
             "2"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "len"}], "}"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"counts", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{"counts", ",", "3"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"counts", ",", "2"}], "]"}], ">", "0"}], ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"Count", "[", 
             RowBox[{"counts", ",", "1"}], "]"}], ")"}]}]}], "]"}]}]}], "\n", 
      "]"}]}], ";"}], "\n", "\t", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LPPolynomialsConversionCoefficientVariant", "[", 
      RowBox[{"linkpattern1_", ",", "linkpattern2_"}], "]"}], ":=", 
     RowBox[{
     "LPPolynomialsConversionCoefficient", "[", "\n", 
      "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
      RowBox[{
       RowBox[{"OpeningPositions", "[", "linkpattern1", "]"}], ",", 
       "linkpattern2"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LPPolynomialChangeOfBasisMatrix", "[", "n_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "lps", "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"lps", "=", 
         RowBox[{"LinkPatterns", "[", "n", "]"}]}], ";", "\n", "\t", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"LPPolynomialsConversionCoefficientVariant", "[", 
           RowBox[{
            RowBox[{"lps", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"lps", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "lps", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "lps", "]"}]}], "}"}]}], "]"}]}]}], "\n", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LPPolynomialInverseChangeOfBasisMatrix", "[", "n_", "]"}], ":=", 
     RowBox[{"Inverse", "[", 
      RowBox[{"LPPolynomialChangeOfBasisMatrix", "[", "n", "]"}], "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LPPolynomialsOfSecondKindEvaluateAtOne", "[", "seq_", "]"}], 
     " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "n", "}"}], ",", " ", "\n", "\t", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "seq", "]"}]}], ";", "\n", "\t", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{
            RowBox[{"Product", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"z", "[", "k", "]"}], " ", "-", " ", 
                 RowBox[{"z", "[", "j", "]"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", " ", "+", " ", 
                 RowBox[{"z", "[", "k", "]"}], " ", "+", " ", 
                 RowBox[{
                  RowBox[{"z", "[", "j", "]"}], " ", 
                  RowBox[{"z", "[", "k", "]"}]}]}], ")"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", "1", ",", " ", 
                RowBox[{"n", " ", "-", " ", "1"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"j", "+", "1"}], ",", "n"}], "}"}]}], "]"}], "\n", 
            "\t\t   ", 
            RowBox[{"Product", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"z", "[", "j", "]"}], "^", 
               RowBox[{"(", 
                RowBox[{"1", " ", "-", " ", 
                 RowBox[{"seq", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
           "]"}], ",", " ", "NumberQ"}], "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ComputeLPPolynomialChangeOfBasisMatrices", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<This will take a minute...\>\"", "]"}], 
        ";", "\n", "\t", 
        RowBox[{"Timing", "[", 
         RowBox[{
          RowBox[{"LPMatrices", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"LPPolynomialChangeOfBasisMatrix", "[", "n", "]"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", "7"}], "}"}]}], "]"}]}], ";", "\n", 
          "\t", 
          RowBox[{"LPInvMatrices", "=", 
           RowBox[{"Map", "[", 
            RowBox[{"Inverse", ",", "LPMatrices"}], "]"}]}], ";"}], "]"}]}]}],
       "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LoadLPPolynomialChangeOfBasisMatrices", "[", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
       "<<", "\"\<~/Dropbox/projects/lp/Mathematica code/Precomputed \
data/matrices.txt\>\""}], ";"}], ")"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CoefficientVectorForCriterion", "[", 
      RowBox[{"order_", ",", "criterion_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "lps", "}"}], ",", 
       RowBox[{
        RowBox[{"lps", "=", 
         RowBox[{"LinkPatterns", "[", "order", "]"}]}], ";", "\n", "\t", 
        RowBox[{"Apply", "[", 
         RowBox[{"Plus", ",", 
          RowBox[{
           RowBox[{"LPInvMatrices", "[", 
            RowBox[{"[", "order", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "lps", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"criterion", "[", 
                RowBox[{"lps", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}]}], "]"}], "]"}],
            "]"}]}], "]"}]}]}], "]"}]}], ";"}], "\n", "\t", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CoefficientVectorForLinkPattern", "[", 
      RowBox[{"order_", ",", "linkpattern_"}], "]"}], ":=", 
     RowBox[{"CoefficientVectorForCriterion", "[", 
      RowBox[{"order", ",", 
       RowBox[{
        RowBox[{"#", "==", "linkpattern"}], "&"}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CoefficientVectorForPrefix", "[", 
      RowBox[{"order_", ",", "prefix_"}], "]"}], ":=", 
     RowBox[{"CoefficientVectorForCriterion", "[", 
      RowBox[{"order", ",", 
       RowBox[{
        RowBox[{"LinkPatternBeginsWithQ", "[", 
         RowBox[{"#", ",", "prefix"}], "]"}], "&"}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LinkPatternBeginsWithQ", "[", 
      RowBox[{"linkpattern_", ",", "prefix_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"linkpattern", "[", 
        RowBox[{"[", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "prefix", "]"}], "]"}], "]"}], "]"}], "==", 
       "prefix"}], ")"}]}], ";"}], "\n"}]}]], "Code",
 CellChangeTimes->{{3.616300375997471*^9, 3.616300378639812*^9}, {
  3.616304457446147*^9, 3.616304467297133*^9}, {3.616304528184331*^9, 
  3.616304530386105*^9}}],

Cell[BoxData["\<\"linkpatterns version 1.1\\nCopyright (c) 2014 Dan \
Romik\\nType LinkPatternsHelp[] for more information\"\>"], "Print",
 CellChangeTimes->{
  3.616300955560766*^9, {3.616301040114575*^9, 3.616301053085477*^9}, 
   3.616301401650745*^9, {3.616302591331881*^9, 3.616302634821558*^9}, 
   3.616302671506427*^9, 3.616302758288323*^9, 3.61630438904156*^9, 
   3.616304496060994*^9, 3.616304547665455*^9, 3.616369210067548*^9, 
   3.616376760852681*^9, 3.61637685131141*^9, 3.616376892179694*^9, 
   3.616376957093289*^9, 3.616377553180653*^9, 3.6163785258835506`*^9, 
   3.616378724847522*^9, 3.616380165421299*^9, 3.616380315791832*^9, 
   3.616387579958041*^9, 3.6167680236817713`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Function Library, part 2", "Subsubsection",
 CellChangeTimes->{{3.61630016955964*^9, 3.616300172197173*^9}}],

Cell[TextData[{
 "Another ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " package loops.m I prepared for the MathFest talk. It implements more \
algorithms related to Fully Packed Loops, loop percolation, and several \
interactive demos"
}], "Text",
 CellChangeTimes->{{3.6163004145905037`*^9, 3.616300423002586*^9}, {
  3.61630056401866*^9, 3.616300588794174*^9}, {3.6163022172189493`*^9, 
  3.616302236169435*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\n", 
   RowBox[{"loops", ",", " ", 
    RowBox[{
     RowBox[{
     "a", " ", "Mathematica", " ", "8", " ", "software", " ", "package", " ", 
      "by", " ", "Dan", " ", "Romik", "\n", "Version", " ", "1.0", "\n", 
      "Copyright", " ", 
      RowBox[{"(", "c", ")"}], " ", "Dan", " ", "Romik", " ", "2014", "\n", 
      "\n", "Package", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"documentation", "\n", "--"}], "--"}], "--"}], "--"}], 
            "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], "-", "\n", 
     RowBox[{"No", " ", "documentation", " ", "yet"}]}], ",", " ", 
    RowBox[{"sorry", "..."}]}], "\n", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LoopsInfoMessage", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<loops version 1.0\\nCopyright (c) 2014 Dan Romik\\nType \
LoopsHelp[] for more information\>\"", "]"}], ";"}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{"LoopsHelp", "[", "]"}], ":=", 
    RowBox[{"Print", "[", "\"\<No documentation yet, sorry...\>\"", "]"}]}], 
   " ", 
   RowBox[{"(*", " ", 
    RowBox[{"TODO", " ", "add", " ", "this"}], " ", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"LoopsInfoMessage", "[", "]"}], ";"}], "\n", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"plaquette", "[", 
      RowBox[{"type_", ",", " ", "\n", "   ", "coords_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"White", ",", " ", 
         RowBox[{"EdgeForm", "[", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.7", ",", " ", "0.7", ",", " ", "0.7"}], "]"}], "]"}], 
         ",", " ", "\n", "    ", 
         RowBox[{"Rectangle", "[", 
          RowBox[{"coords", ",", " ", 
           RowBox[{"coords", " ", "+", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "1"}], "}"}]}]}], "]"}]}], "}"}], ",", 
       " ", "\n", "   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", " ", "==", " ", "0"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"Black", ",", " ", 
           RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", " ", "\n", 
           "     ", 
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"coords", " ", "+", " ", 
              RowBox[{"{", 
               RowBox[{"1", ",", " ", "0"}], "}"}]}], ",", " ", 
             RowBox[{"1", "/", "2"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Pi", "/", "2"}], ",", " ", "Pi"}], "}"}]}], "]"}], 
           ",", " ", "\n", "     ", 
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"coords", " ", "+", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1"}], "}"}]}], ",", " ", 
             RowBox[{"1", "/", "2"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"3", " ", 
                RowBox[{"Pi", "/", "2"}]}], ",", " ", 
               RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}]}], "}"}], ",", " ", 
         "\n", "    ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"type", " ", "==", " ", "1"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"Black", ",", " ", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", " ", "\n", 
             "      ", 
             RowBox[{"Circle", "[", 
              RowBox[{"coords", ",", " ", 
               RowBox[{"1", "/", "2"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}], ",", " ", "\n", 
             "      ", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{"coords", " ", "+", " ", 
                RowBox[{"{", 
                 RowBox[{"1", ",", " ", "1"}], "}"}]}], ",", " ", 
               RowBox[{"1", "/", "2"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"Pi", ",", " ", 
                 RowBox[{"3", " ", 
                  RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], "]"}]}], "}"}], ",", 
           " ", 
           RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], "}"}]}], ";"}], "\n", 
   "      ", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"plaquettes", "[", "typesmatrix_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"plaquette", "[", 
        RowBox[{
         RowBox[{"typesmatrix", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "typesmatrix", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"typesmatrix", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "      ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"randomplaquettes", "[", 
      RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"Integer", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"m", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"randombits", "[", 
      RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"Integer", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"m", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"plaquettesendpointpath", "[", 
      RowBox[{"plaqs_", ",", "x0_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "path", ",", "side", ",", "x", ",", "y", ",", "width", ",", "height", 
         ",", "oldx", ",", "oldy", ",", "arccode"}], "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"path", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"side", "=", "1"}], ";", 
        RowBox[{"x", "=", "x0"}], ";", 
        RowBox[{"y", "=", "1"}], ";", 
        RowBox[{"width", "=", 
         RowBox[{"Length", "[", "plaqs", "]"}]}], ";", 
        RowBox[{"height", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"plaqs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"y", ">", "0"}], " ", "&&", " ", 
           RowBox[{"y", "<=", "height"}]}], ",", "\n", "    ", 
          RowBox[{
           RowBox[{"oldx", " ", "=", " ", "x"}], ";", " ", 
           RowBox[{"oldy", " ", "=", " ", "y"}], ";", "\n", "    ", 
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"side", ",", 
               RowBox[{"plaqs", "[", 
                RowBox[{"[", 
                 RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "}"}], ",", "\n", 
             "      ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"side", "=", "2"}], ";", " ", 
               RowBox[{"x", "=", 
                RowBox[{"x", "+", "1"}]}], ";", " ", 
               RowBox[{"arccode", "=", "4"}]}], ")"}], ",", "\n", "      ", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"side", "=", "1"}], ";", " ", 
               RowBox[{"y", "=", 
                RowBox[{"y", "+", "1"}]}], ";", " ", 
               RowBox[{"arccode", "=", "2"}]}], ")"}], ",", "\n", "      ", 
             RowBox[{"{", 
              RowBox[{"3", ",", "0"}], "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"side", "=", "4"}], ";", " ", 
               RowBox[{"x", "=", 
                RowBox[{"x", "-", "1"}]}], ";", " ", 
               RowBox[{"arccode", "=", "2"}]}], ")"}], ",", "\n", "      ", 
             RowBox[{"{", 
              RowBox[{"4", ",", "0"}], "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"side", "=", "3"}], ";", " ", 
               RowBox[{"y", "=", 
                RowBox[{"y", "-", "1"}]}], ";", " ", 
               RowBox[{"arccode", "=", "4"}]}], ")"}], ",", "\n", "      ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"side", "=", "4"}], ";", " ", 
               RowBox[{"x", "=", 
                RowBox[{"x", "-", "1"}]}], ";", " ", 
               RowBox[{"arccode", "=", "1"}]}], ")"}], ",", "\n", "      ", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"side", "=", "3"}], ";", " ", 
               RowBox[{"y", "=", 
                RowBox[{"y", "-", "1"}]}], ";", " ", 
               RowBox[{"arccode", "=", "1"}]}], ")"}], ",", "\n", "      ", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"side", "=", "2"}], ";", " ", 
               RowBox[{"x", "=", 
                RowBox[{"x", "+", "1"}]}], ";", " ", 
               RowBox[{"arccode", "=", "3"}]}], ")"}], ",", "\n", "      ", 
             RowBox[{"{", 
              RowBox[{"4", ",", "1"}], "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"side", "=", "1"}], ";", " ", 
               RowBox[{"y", "=", 
                RowBox[{"y", "+", "1"}]}], ";", " ", 
               RowBox[{"arccode", "=", "3"}]}], ")"}]}], "\n", "    ", "]"}], 
           ";", "\n", "    ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "==", "0"}], ",", 
             RowBox[{"x", "=", "width"}]}], "]"}], ";", "\n", "    ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "==", 
              RowBox[{"width", "+", "1"}]}], ",", 
             RowBox[{"x", "=", "1"}]}], "]"}], ";", "\n", "    ", 
           RowBox[{"path", " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"path", ",", 
              RowBox[{"{", 
               RowBox[{"oldx", ",", "oldy", ",", "arccode"}], "}"}]}], 
             "]"}]}], ";"}]}], "\n", "  ", "]"}], ";", "\n", "  ", "path"}]}],
       "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"plaquettesendpointpathgraphics", "[", 
      RowBox[{"plaqs_", ",", "x0_", ",", "color_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"path", ",", "arcs"}], "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"path", " ", "=", " ", 
         RowBox[{"plaquettesendpointpath", "[", 
          RowBox[{"plaqs", ",", "x0"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"arcs", "=", 
         RowBox[{"Table", "[", "\n", "    ", 
          RowBox[{
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"path", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", "\n", "      ", "1", ",", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], "+", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"1", "/", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}], ",", "\n", 
             "      ", "2", ",", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}], "+", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"1", "/", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"3", 
                  RowBox[{"Pi", "/", "2"}]}], ",", 
                 RowBox[{"2", "Pi"}]}], "}"}]}], "]"}], ",", "\n", "      ", 
             "3", ",", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], "+", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"1", "/", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"Pi", ",", 
                 RowBox[{"3", 
                  RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], "]"}], ",", "\n", 
             "      ", "4", ",", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}], "+", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"1", "/", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Pi", "/", "2"}], ",", "Pi"}], "}"}]}], "]"}]}], 
            "\n", "    ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "path", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\n", "  ", 
        RowBox[{"{", 
         RowBox[{"color", ",", 
          RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", "arcs"}], 
         "}"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"computematching", "[", "plaqs_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "n", ",", " ", "matching", ",", "path", ",", " ", "lastarccode"}], 
        "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"Length", "[", "plaqs", "]"}]}], ";", "\n", "  ", 
        RowBox[{"matching", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        "  ", 
        RowBox[{"Do", "[", "\n", "    ", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"matching", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "==", "0"}], ",", " ", "\n", 
            "      ", 
            RowBox[{
             RowBox[{"path", "=", 
              RowBox[{"plaquettesendpointpath", "[", 
               RowBox[{"plaqs", ",", "i"}], "]"}]}], ";", "\n", "      ", 
             RowBox[{"lastarccode", " ", "=", " ", 
              RowBox[{
               RowBox[{"Last", "[", "path", "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ";", "\n", "      ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"lastarccode", " ", "==", " ", "1"}], " ", "||", " ", 
                
                RowBox[{"lastarccode", " ", "==", " ", "4"}]}], ",", " ", 
               "\n", "        ", 
               RowBox[{
                RowBox[{
                 RowBox[{"matching", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
                 RowBox[{
                  RowBox[{"Last", "[", "path", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "        ", 
                RowBox[{
                 RowBox[{"matching", "[", 
                  RowBox[{"[", 
                   RowBox[{"matching", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], " ", "=", 
                 " ", "i"}], ";"}]}], "\n", "      ", "]"}], ";"}]}], "\n", 
           "    ", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "  ",
         "matching"}]}], "\n", "]"}]}], ";"}], "\n", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LoopPercolationInteractiveDemo", "[", "]"}], " ", ":=", " ", 
     RowBox[{"DynamicModule", "[", "\n", " ", 
      RowBox[{
       RowBox[{"{", "\n", "   ", 
        RowBox[{
         RowBox[{"width", " ", "=", " ", "8"}], ",", " ", 
         RowBox[{"height", " ", "=", " ", "16"}], ",", " ", 
         RowBox[{"bias", " ", "=", " ", "0.5"}], ",", "\n", "   ", 
         RowBox[{"pathflag", " ", "=", " ", "False"}], ",", " ", 
         RowBox[{"matchingflag", " ", "=", " ", "False"}], ",", "\n", "   ", 
         RowBox[{"matching", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
           "2", ",", "1", ",", "4", ",", "3", ",", "6", ",", "5", ",", "8", 
            ",", "7"}], "}"}]}], ",", "\n", "   ", 
         RowBox[{"randomreals", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", 
             RowBox[{"Real", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "8"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "16"}], "}"}]}], "]"}]}], ",", "\n", 
         "   ", 
         RowBox[{"plaqs", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ",", "\n", "   ", 
         RowBox[{"numbers", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"i", "+", 
                   RowBox[{"1", "/", "2"}]}], ",", "0.5"}], "}"}]}], "]"}], 
              ",", "16"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]}]}], "\n", " ",
         "}"}], ",", "\n", " ", 
       RowBox[{
        RowBox[{"plaqs", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"randomreals", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "<", 
              RowBox[{"1", "/", "2"}]}], ",", "0", ",", "1"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "16"}], "}"}]}], "]"}]}], ";", "\n", 
        " ", 
        RowBox[{"matching", " ", "=", " ", 
         RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
          RowBox[{"computematching", "[", "plaqs", "]"}], "]"}]}], ";", "\n", 
        " ", 
        RowBox[{"Panel", "[", 
         RowBox[{"Column", "[", 
          RowBox[{"{", "\n", "    ", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", "\n", "      ", 
              RowBox[{"\"\<Width:  \>\"", ",", "\n", "      ", 
               RowBox[{"Slider", "[", "\n", "       ", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"width", ",", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"width", " ", "=", " ", "#"}], ";", " ", "\n", 
                    "\t\t\t           ", 
                    RowBox[{"plaqs", " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"i", " ", "-", " ", "1"}], ",", " ", "2"}], "]"}],
                     ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", " ", "1", ",", " ", "width"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", " ", "1", ",", " ", "height"}], "}"}]}],
                     "]"}]}], ";", "\n", "\t\t\t           ", 
                    RowBox[{"matching", " ", "=", " ", 
                    RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
                    RowBox[{"computematching", "[", "plaqs", "]"}], "]"}]}], 
                    ";", "\n", "\t\t\t\t\t   ", 
                    RowBox[{"randomreals", " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Random", "[", 
                    RowBox[{"Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "width"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "height"}], "}"}]}], "]"}]}], 
                    ";", "\n", "\t\t\t\t\t   ", 
                    RowBox[{"numbers", " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}], ",", "0.5"}], "}"}]}], "]"}], 
                    ",", "16"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "width"}], "}"}]}], "]"}]}], 
                    ";"}], "\n", "            \t\t  ", ")"}], " ", "&"}]}], 
                  "\n", "              ", "]"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", " ", "20", ",", "2"}], "}"}]}], "\n", 
                "         ", "]"}], ",", " ", "\"\<   \>\"", ",", " ", 
               RowBox[{"InputField", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "width", "]"}], ",", 
                 RowBox[{"Enabled", "->", "False"}], ",", 
                 RowBox[{"FieldSize", "->", "2"}]}], "]"}]}], "\n", "      ", 
              "}"}], "]"}], ",", "\n", "    ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", "\n", "      ", 
              RowBox[{"\"\<Height:  \>\"", ",", "\n", "      ", 
               RowBox[{"Slider", "[", "\n", "       ", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"height", ",", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"height", " ", "=", " ", "#"}], ";", " ", "\n", 
                    "\t\t\t           ", 
                    RowBox[{"plaqs", " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"i", " ", "-", " ", "1"}], ",", " ", "2"}], "]"}],
                     ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", " ", "1", ",", " ", "width"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", " ", "1", ",", " ", "height"}], "}"}]}],
                     "]"}]}], ";", "\n", "\t\t\t           ", 
                    RowBox[{"matching", " ", "=", " ", 
                    RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
                    RowBox[{"computematching", "[", "plaqs", "]"}], "]"}]}], 
                    ";", "\n", "\t\t\t\t\t   ", 
                    RowBox[{"randomreals", " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Random", "[", 
                    RowBox[{"Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "width"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "height"}], "}"}]}], "]"}]}], 
                    ";"}], "\n", "            \t\t  ", ")"}], " ", "&"}]}], 
                  "\n", "              ", "]"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", " ", "20", ",", "1"}], "}"}]}], "\n", 
                "        ", "]"}], ",", " ", "\"\<   \>\"", ",", " ", 
               RowBox[{"InputField", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "height", "]"}], ",", 
                 RowBox[{"Enabled", "->", "False"}], ",", 
                 RowBox[{"FieldSize", "->", "2"}]}], "]"}]}], "\n", "      ", 
              "}"}], "]"}], ",", "\n", "    ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", "\n", "      ", 
              RowBox[{"\"\<Bias:\>\"", ",", "\n", "      ", 
               RowBox[{"Slider", "[", "\n", "       ", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"bias", ",", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"bias", " ", "=", " ", "#"}], ";", " ", "\n", 
                    "          ", 
                    RowBox[{"plaqs", " ", "=", " ", 
                    RowBox[{"Table", "[", "\n", "            ", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"randomreals", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "<", " ", 
                    "bias"}], ",", " ", "0", ",", " ", "1"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", " ", "1", ",", " ", "width"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", " ", "1", ",", " ", "height"}], "}"}]}],
                     "]"}]}], ";", "\n", "\t\t\t   ", 
                    RowBox[{"matching", " ", "=", " ", 
                    RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
                    RowBox[{"computematching", "[", "plaqs", "]"}], "]"}]}]}],
                     ")"}], " ", "&"}]}], "]"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", "1"}], "}"}]}], "]"}], ",", "\n", 
               "\t\t\t   ", "\"\<  \>\"", ",", " ", 
               RowBox[{"InputField", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "bias", "]"}], ",", 
                 RowBox[{"Enabled", "->", "False"}], ",", 
                 RowBox[{"FieldSize", "->", "4"}]}], "]"}], ",", "\"\<  \>\"",
                ",", "\n", "      ", 
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Rerandomize\>\"", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"randomreals", " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Random", "[", 
                    RowBox[{"Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "width"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "height"}], "}"}]}], "]"}]}], 
                   ";", "\n", "\t\t\t\t\t        ", 
                   RowBox[{"plaqs", " ", "=", " ", 
                    RowBox[{"Table", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"randomreals", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "<", " ", 
                    "bias"}], ",", " ", "0", ",", " ", "1"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", " ", "1", ",", " ", "width"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", " ", "1", ",", " ", "height"}], "}"}]}],
                     "]"}]}], ";", "\n", "\t   \t\t\t            ", 
                   RowBox[{"matching", " ", "=", " ", 
                    RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
                    RowBox[{"computematching", "[", "plaqs", "]"}], "]"}]}]}],
                   ")"}]}], "]"}]}], "\n", "      ", "}"}], "]"}], ",", "\n", 
            "    ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Paths: \>\"", ",", 
               RowBox[{"Checkbox", "[", 
                RowBox[{"Dynamic", "[", "pathflag", "]"}], "]"}]}], "}"}], 
             "]"}], ",", "\n", "    ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Connectivity pattern: \>\"", ",", 
               RowBox[{"Checkbox", "[", 
                RowBox[{"Dynamic", "[", "matchingflag", "]"}], "]"}]}], "}"}],
              "]"}], ",", "\n", "    ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", "\n", "    ", 
              RowBox[{
               RowBox[{"ClickPane", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Graphics", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"numbers", ",", "\n", "    \t\t\t\t  ", 
                    RowBox[{"plaquettes", "[", "plaqs", "]"}], ",", "\n", 
                    "\t\t\t\t      ", 
                    RowBox[{"If", "[", 
                    RowBox[{"pathflag", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"plaquettesendpointpathgraphics", "[", 
                    RowBox[{"plaqs", ",", "j", ",", 
                    RowBox[{"Hue", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"width", "-", "1"}], ")"}]}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "width"}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "\n", " \t\t\t\t     ", 
                    "}"}], ",", " ", 
                    RowBox[{"ImageSize", " ", "->", " ", "300"}]}], "]"}], 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"plaqs", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Floor", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Floor", "[", "#", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "=", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"plaqs", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Floor", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Floor", "[", "#", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}]}], ";", 
                    "\n", " \t\t\t\t     ", 
                    RowBox[{"matching", " ", "=", " ", 
                    RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
                    RowBox[{"computematching", "[", "plaqs", "]"}], "]"}]}]}],
                    ")"}], "&"}]}], "]"}], ",", "\n", " \t\t\t\t     ", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\n", " \t\t\t\t     ", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"matchingflag", ",", 
                    RowBox[{
                    RowBox[{"LinkPatternGraphicsCircular", "[", 
                    RowBox[{"matching", ",", "True"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "->", "300"}]}], "]"}], "]"}], ",", 
                  "\n", " \t\t\t\t     ", 
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"matchingflag", ",", 
                    RowBox[{
                    RowBox[{"LinkPatternGraphicsLinear", "[", 
                    RowBox[{"matching", ",", "True"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "->", "300"}]}], "]"}], "]"}]}], 
                 "\n", " \t\t\t\t     ", "}"}], "]"}]}], "\n", " \t  ", "}"}],
              "]"}]}], "\n", "    ", "}"}], "]"}], "\n", "  ", "]"}]}]}], 
      "\n", " ", "]"}]}], ";"}], "\n", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"stickfigure", "[", 
      RowBox[{"x_", ",", " ", "y_", ",", "scale_"}], "]"}], " ", ":=", " ", 
     "\n", "  ", 
     RowBox[{"Translate", "[", 
      RowBox[{
       RowBox[{"Scale", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.49", ",", " ", "0.5"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0.51", ",", " ", "0.8"}], "}"}]}], "]"}], ",", " ", 
           "\n", "    ", 
           RowBox[{"Disk", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.5", ",", " ", "0.8"}], "}"}], ",", " ", "0.09"}], 
            "]"}], ",", "\n", "    ", 
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.49", ",", " ", "0.5"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.51", ",", " ", "0.5"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.42", ",", " ", "0.3"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.4", ",", " ", "0.3"}], "}"}]}], "}"}], "]"}], ",", 
           "\n", "    ", 
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.49", ",", " ", "0.5"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.51", ",", " ", "0.5"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.6", ",", " ", "0.3"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.58", ",", " ", "0.3"}], "}"}]}], "}"}], "]"}], ",", 
           "\n", "    ", 
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.49", ",", " ", "0.62"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.51", ",", " ", "0.62"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.38", ",", " ", "0.7"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.373", ",", " ", "\n", "       ", "0.69"}], "}"}]}], 
             "}"}], "]"}], ",", "\n", "    ", 
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.51", ",", " ", "0.62"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.49", ",", " ", "0.62"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.62", ",", " ", "0.7"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0.627", ",", " ", "0.69"}], "}"}]}], "}"}], "]"}]}], 
          "\n", "    ", "}"}], ",", "scale"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "-", 
          RowBox[{"1", "/", "2"}]}], ",", " ", 
         RowBox[{"y", "-", 
          RowBox[{"1", "/", "2"}]}]}], "}"}]}], "]"}]}], ";"}], "\n", "\n", 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PipeOperatorGraphics", "[", 
      RowBox[{"n_", ",", "k_", ",", "height_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "heightscalingfactor", "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"heightscalingfactor", " ", "=", " ", "1.2"}], ";", "\n", 
        "  ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"White", ",", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"GrayLevel", "[", "0.8", "]"}], "]"}], ",", " ", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", 
                RowBox[{"heightscalingfactor", "*", "height"}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{
                RowBox[{"n", "+", 
                 RowBox[{"1", "/", "2"}]}], ",", 
                RowBox[{"heightscalingfactor", "*", 
                 RowBox[{"(", 
                  RowBox[{"height", "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"Black", ",", " ", "\n", "  ", 
            RowBox[{"Join", "[", "\n", "    ", 
             RowBox[{
              RowBox[{"Table", "[", "\n", "      ", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"j", "!=", "k"}], " ", "&&", " ", 
                   RowBox[{"j", "!=", 
                    RowBox[{"k", "+", "1"}]}], " ", "&&", " ", 
                   RowBox[{"j", "!=", 
                    RowBox[{"k", "+", "1", "-", "n"}]}]}], ",", " ", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"heightscalingfactor", "*", "height"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"heightscalingfactor", "*", 
                    RowBox[{"(", 
                    RowBox[{"height", "+", "1"}], ")"}]}]}], "}"}]}], "}"}], 
                   "]"}], ",", " ", 
                  RowBox[{"{", "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "\n", "    ", 
               "]"}], ",", "\n", "    ", 
              RowBox[{"{", "\n", "      ", 
               RowBox[{
                RowBox[{"Circle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"k", "+", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{"heightscalingfactor", "*", "height"}]}], "}"}], 
                  ",", 
                  RowBox[{"1", "/", "2"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Pi", "/", "2"}], ",", "Pi"}], "}"}]}], "]"}], 
                ",", "\n", "      ", 
                RowBox[{"Circle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"k", "+", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{"heightscalingfactor", "*", 
                    RowBox[{"(", 
                    RowBox[{"height", "+", "1"}], ")"}]}]}], "}"}], ",", 
                  RowBox[{"1", "/", "2"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Pi", ",", 
                    RowBox[{"3", 
                    RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], "]"}], ",", "\n", 
                "      ", 
                RowBox[{"Circle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"k", "==", "n"}], ",", "0", ",", "k"}], "]"}], 
                    "+", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{"heightscalingfactor", "*", "height"}]}], "}"}], 
                  ",", 
                  RowBox[{"1", "/", "2"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}], ",", "\n", 
                "      ", 
                RowBox[{"Circle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"k", "==", "n"}], ",", "0", ",", "k"}], "]"}], 
                    "+", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{"heightscalingfactor", "*", 
                    RowBox[{"(", 
                    RowBox[{"height", "+", "1"}], ")"}]}]}], "}"}], ",", 
                  RowBox[{"1", "/", "2"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"3", 
                    RowBox[{"Pi", "/", "2"}]}], ",", 
                    RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], "\n", "    ", 
               "}"}]}], "\n", "  ", "]"}]}], "}"}]}], "}"}]}]}], "\n", 
      "]"}]}], ";"}], "\n", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pipesendpointpath", "[", 
      RowBox[{"ops_", ",", "x0_", ",", "width_", ",", "height_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "path", ",", "direction", ",", "x", ",", "y", ",", "oldx", ",", 
         "oldy"}], "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"path", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\n", "  ", 
        RowBox[{"x", " ", "=", " ", "x0"}], ";", "\n", "  ", 
        RowBox[{"y", " ", "=", " ", "1"}], ";", "\n", "  ", 
        RowBox[{"direction", " ", "=", " ", "1"}], ";", "\n", "  ", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"direction", " ", "==", " ", "1"}], " ", "&&", " ", 
             RowBox[{"y", " ", "<=", " ", "height"}]}], ")"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"direction", " ", "==", " ", 
              RowBox[{"-", "1"}]}], " ", "&&", " ", 
             RowBox[{"y", " ", ">", " ", "1"}]}], ")"}]}], ",", "\n", "    ", 
          
          RowBox[{
           RowBox[{"oldx", " ", "=", " ", "x"}], ";", " ", 
           RowBox[{"oldy", " ", "=", " ", "y"}], ";", "\n", "    ", 
           RowBox[{"Switch", "[", 
            RowBox[{"direction", ",", "\n", "      ", "1", ",", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"x", "==", 
                RowBox[{"ops", "[", 
                 RowBox[{"[", "y", "]"}], "]"}]}], ",", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "=", 
                  RowBox[{"x", "+", "1"}]}], ";", " ", 
                 RowBox[{"direction", " ", "=", " ", 
                  RowBox[{"-", "1"}]}]}], ")"}], ",", "\n", "             ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "==", 
                   RowBox[{
                    RowBox[{"ops", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "+", "1"}]}], " ", "||", 
                  " ", 
                  RowBox[{"x", "==", 
                   RowBox[{
                    RowBox[{"ops", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "+", "1", "-", 
                    "width"}]}]}], ",", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"x", "=", 
                    RowBox[{"x", "-", "1"}]}], ";", " ", 
                   RowBox[{"direction", " ", "=", " ", 
                    RowBox[{"-", "1"}]}]}], ")"}], ",", " ", 
                 RowBox[{"y", "=", 
                  RowBox[{"y", "+", "1"}]}]}], "]"}]}], "\n", "           ", 
              "]"}], ",", "\n", "      ", 
             RowBox[{"-", "1"}], ",", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"x", "==", 
                RowBox[{"ops", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", "-", "1"}], "]"}], "]"}]}], ",", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "=", 
                  RowBox[{"x", "+", "1"}]}], ";", " ", 
                 RowBox[{"direction", " ", "=", " ", "1"}]}], ")"}], ",", 
               "\n", "             ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "==", 
                   RowBox[{
                    RowBox[{"ops", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", "-", "1"}], "]"}], "]"}], "+", "1"}]}], " ", 
                  "||", " ", 
                  RowBox[{"x", "==", 
                   RowBox[{
                    RowBox[{"ops", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", "-", "1"}], "]"}], "]"}], "+", "1", "-", 
                    "width"}]}]}], ",", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"x", "=", 
                    RowBox[{"x", "-", "1"}]}], ";", " ", 
                   RowBox[{"direction", " ", "=", " ", "1"}]}], ")"}], ",", 
                 " ", 
                 RowBox[{"y", "=", 
                  RowBox[{"y", "-", "1"}]}]}], "]"}]}], "\n", "            ", 
              "]"}]}], "\n", "    ", "]"}], ";", "\n", "    ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "==", "0"}], ",", " ", 
             RowBox[{"x", "=", "width"}]}], "]"}], ";", "\n", "    ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "==", 
              RowBox[{"width", "+", "1"}]}], ",", " ", 
             RowBox[{"x", "=", "1"}]}], "]"}], ";", "\n", "    ", 
           RowBox[{"path", " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"path", ",", 
              RowBox[{"{", 
               RowBox[{"oldx", ",", "oldy", ",", "direction"}], "}"}]}], 
             "]"}]}], ";"}]}], "\n", "  ", "]"}], ";", "\n", "    ", 
        RowBox[{"path", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"path", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "direction"}], "}"}]}], "]"}]}], ";", 
        "\n", "  ", "path"}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pipesendpointpathgraphics", "[", 
      RowBox[{
      "ops_", ",", "x0_", ",", "width_", ",", "height_", ",", "color_"}], 
      "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "path", ",", " ", "left", ",", " ", "right", ",", " ", "temp"}], 
        "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"path", " ", "=", " ", 
         RowBox[{"pipesendpointpath", "[", 
          RowBox[{"ops", ",", "x0", ",", "width", ",", "height"}], "]"}]}], 
        ";", "\n", "  ", 
        RowBox[{"pathlength", " ", "=", " ", 
         RowBox[{"Length", "[", "path", "]"}]}], ";", "\n", "  ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "4", "]"}], ",", " ", "color", 
          ",", " ", "\n", "    ", 
          RowBox[{"Table", "[", "\n", "      ", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"path", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "!=", 
               RowBox[{
                RowBox[{"path", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "           ", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"path", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"path", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "1.2"}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "1.2"}]}], "}"}]}], 
                "}"}], "]"}], ",", "\n", "           ", 
              RowBox[{
               RowBox[{"left", " ", "=", " ", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", "\n", 
               "           ", 
               RowBox[{"right", " ", "=", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", "\n", 
               "           ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"left", " ", "==", " ", "1"}], " ", "&&", " ", 
                  RowBox[{"right", " ", "==", " ", "width"}]}], ",", " ", 
                 RowBox[{
                  RowBox[{"temp", " ", "=", " ", "left"}], ";", " ", 
                  RowBox[{"left", " ", "=", " ", "right"}], ";", " ", 
                  RowBox[{"right", " ", "=", " ", "temp"}]}]}], "]"}], ";", 
               "\n", "           ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "3", "]"}], "]"}], " ", "==", " ", 
                  RowBox[{"-", "1"}]}], ",", " ", "\n", "           \t\t", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"left", "+", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"path", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "1.2"}]}], "}"}], 
                    ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Pi", "/", "2"}], ",", "Pi"}], "}"}]}], "]"}], 
                   ",", " ", "\n", "           \t\t ", 
                   RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"right", "-", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"path", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "1.2"}]}], "}"}], 
                    ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}]}], "}"}], ",", 
                 "\n", "           \t\t", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"left", "+", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"path", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "1.2"}]}], "}"}], 
                    ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Pi", ",", 
                    RowBox[{"3", 
                    RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], "]"}], ",", " ", 
                   "\n", "           \t\t ", 
                   RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"right", "-", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"path", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "1.2"}]}], "}"}], 
                    ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"3", 
                    RowBox[{"Pi", "/", "2"}]}], ",", 
                    RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], "}"}]}], "\n", 
                "             ", "]"}]}]}], "\n", "        ", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"pathlength", "-", "1"}]}], "}"}]}], "\n", "    ", 
           "]"}]}], "\n", "  ", "}"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"computepipesmatching", "[", 
      RowBox[{"ops_", ",", " ", "width_", ",", " ", "height_"}], "]"}], ":=", 
     
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"matching", ",", " ", "path", ",", " ", "lastdirection"}], 
        "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"matching", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "width"}], "}"}]}], "]"}]}], ";", 
        "\n", "  ", 
        RowBox[{"Do", "[", "\n", "    ", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"matching", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "==", "0"}], ",", " ", "\n", 
            "      ", 
            RowBox[{
             RowBox[{"path", "=", 
              RowBox[{"pipesendpointpath", "[", 
               RowBox[{"ops", ",", "i", ",", "width", ",", "height"}], 
               "]"}]}], ";", "\n", "      ", 
             RowBox[{"lastdirection", " ", "=", " ", 
              RowBox[{
               RowBox[{"Last", "[", "path", "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ";", "\n", "      ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"lastdirection", " ", "==", " ", 
                RowBox[{"-", "1"}]}], ",", "\n", "        ", 
               RowBox[{
                RowBox[{
                 RowBox[{"matching", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
                 RowBox[{
                  RowBox[{"Last", "[", "path", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "        ", 
                RowBox[{
                 RowBox[{"matching", "[", 
                  RowBox[{"[", 
                   RowBox[{"matching", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], " ", "=", 
                 " ", "i"}], ";"}]}], "\n", "      ", "]"}], ";"}]}], "\n", 
           "    ", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "width"}], "}"}]}], "]"}], ";", "\n", 
        "  ", "matching"}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PipePercolationInteractiveDemo", "[", "]"}], " ", ":=", " ", 
     RowBox[{"DynamicModule", "[", "\n", "  ", 
      RowBox[{
       RowBox[{"{", "\n", "    ", 
        RowBox[{
         RowBox[{"width", " ", "=", " ", "10"}], ",", "\n", "    ", 
         RowBox[{"height", " ", "=", " ", "10"}], ",", "\n", "    ", 
         RowBox[{"ops", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", 
             RowBox[{"Integer", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "10"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "100"}], "}"}]}], "]"}]}], ",", "\n",
          "    ", 
         RowBox[{"pathflag", " ", "=", " ", "False"}], ",", "\n", "    ", 
         RowBox[{"matchingflag", " ", "=", " ", "False"}], ",", "\n", "    ", 
         
         RowBox[{"matching", " ", "=", " ", 
          RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
           RowBox[{"{", 
            RowBox[{
            "2", ",", "1", ",", "4", ",", "3", ",", "6", ",", "5", ",", "8", 
             ",", "7", ",", "10", ",", "9"}], "}"}], "]"}]}]}], "\n", "  ", 
        "}"}], ",", "\n", "  ", 
       RowBox[{"Panel", "[", "\n", "    ", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\n", "      ", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", "\n", "        ", 
             RowBox[{"\"\<Width:  \>\"", ",", "\n", "        ", 
              RowBox[{"Slider", "[", "\n", "         ", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"width", ",", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"width", " ", "=", " ", "#"}], ";", " ", "\n", 
                    "\t\t  \t\t\t     ", 
                    RowBox[{"ops", " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Random", "[", 
                    RowBox[{"Integer", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "width"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "100"}], "}"}]}], "]"}]}], 
                    ";", "\n", "\t\t  \t\t\t     ", 
                    RowBox[{"matching", " ", "=", " ", 
                    RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
                    RowBox[{"computepipesmatching", "[", 
                    RowBox[{"ops", ",", "width", ",", "height"}], "]"}], 
                    "]"}]}], ";"}], "\n", "              \t\t    ", ")"}], 
                   " ", "&"}]}], "\n", "                ", "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"2", ",", " ", "20", ",", "2"}], "}"}]}], "\n", 
               "           ", "]"}], ",", " ", "\"\<   \>\"", ",", " ", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "width", "]"}], ",", 
                RowBox[{"Enabled", "->", "False"}], ",", 
                RowBox[{"FieldSize", "->", "2"}]}], "]"}]}], "\n", "        ",
              "}"}], "]"}], ",", "\n", "      ", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\n", "        ", 
             RowBox[{"\"\<Height:  \>\"", ",", "\n", "        ", 
              RowBox[{"Slider", "[", "\n", "         ", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"height", ",", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"height", " ", "=", " ", "#"}], ";"}], " ", "\n", 
                    "              \t\t    ", ")"}], " ", "&"}]}], "\n", 
                 "                ", "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"1", ",", " ", "50", ",", "1"}], "}"}]}], "\n", 
               "           ", "]"}], ",", " ", "\"\<   \>\"", ",", " ", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "height", "]"}], ",", 
                RowBox[{"Enabled", "->", "False"}], ",", 
                RowBox[{"FieldSize", "->", "2"}]}], "]"}]}], "\n", "        ",
              "}"}], "]"}], ",", "\n", "      ", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{"\"\<Rerandomize\>\"", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ops", " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Random", "[", 
                    RowBox[{"Integer", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "width"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "100"}], "}"}]}], "]"}]}], 
                   ";", "\n", "\t\t\t\t\t\t         ", 
                   RowBox[{"matching", " ", "=", " ", 
                    RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
                    RowBox[{"computepipesmatching", "[", 
                    RowBox[{"ops", ",", "width", ",", "height"}], "]"}], 
                    "]"}]}], ";"}], "\n", "      \t\t\t\t\t\t    ", ")"}], 
                 "&"}]}], "]"}], ",", "\n", "           ", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<Random walk step\>\"", ",", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ops", " ", "=", " ", 
                    RowBox[{
                    RowBox[{"Insert", "[", 
                    RowBox[{"ops", ",", 
                    RowBox[{"Random", "[", 
                    RowBox[{"Integer", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "width"}], "}"}]}], "]"}], ",", "1"}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Range", "[", "100", "]"}], "]"}], "]"}]}], ";", 
                   "\n", "        \t\t\t\t\t\t\t   ", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"height", "<", "50"}], ",", " ", 
                    RowBox[{"height", "=", 
                    RowBox[{"height", "+", "1"}]}]}], "]"}], ";", "\n", 
                   "        \t\t\t\t\t\t\t   ", 
                   RowBox[{"matching", " ", "=", " ", 
                    RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
                    RowBox[{"computepipesmatching", "[", 
                    RowBox[{"ops", ",", "width", ",", "height"}], "]"}], 
                    "]"}]}], ";"}], "\n", 
                  "                                      ", ")"}], "&"}]}], 
               "]"}]}], "\n", "          ", "}"}], "]"}], ",", "\n", "      ", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Paths: \>\"", ",", 
              RowBox[{"Checkbox", "[", 
               RowBox[{"Dynamic", "[", "pathflag", "]"}], "]"}]}], "}"}], 
            "]"}], ",", "\n", "      ", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Connectivity pattern: \>\"", ",", 
              RowBox[{"Checkbox", "[", 
               RowBox[{"Dynamic", "[", "matchingflag", "]"}], "]"}]}], "}"}], 
            "]"}], ",", "\n", "      ", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\n", "        ", 
             RowBox[{
              RowBox[{"ClickPane", "[", "\n", "          ", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"Graphics", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"PipeOperatorGraphics", "[", 
                    RowBox[{"width", ",", 
                    RowBox[{"ops", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "height"}], "}"}]}], "]"}]}], 
                    "}"}], ",", "\n", "                            ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    "pathflag", ",", " ", "\n", 
                    "                               ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"pipesendpointpathgraphics", "[", 
                    RowBox[{"ops", ",", "j", ",", "width", ",", "height", ",", 
                    RowBox[{"Hue", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"width", "-", "1"}], ")"}]}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "width"}], "}"}]}], "]"}], 
                    ",", " ", 
                    RowBox[{"{", "}"}]}], "]"}]}], "\n", 
                    "                           ", "}"}], ",", 
                   RowBox[{"ImageSize", "->", 
                    RowBox[{"{", 
                    RowBox[{"400", ",", "500"}], "}"}]}], ",", 
                   RowBox[{"AspectRatio", "->", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"height", "<", "20"}], ",", "Automatic", ",", 
                    RowBox[{"1.44", "*", 
                    RowBox[{"16", "/", "width"}]}]}], "]"}]}]}], "]"}], "]"}],
                 ",", "\n", "          ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ops", "[", 
                    RowBox[{"[", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "1.2"}], "]"}], 
                    "]"}], "]"}], "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
                   "\n", "           ", 
                   RowBox[{"matching", " ", "=", " ", 
                    RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
                    RowBox[{"computepipesmatching", "[", 
                    RowBox[{"ops", ",", "width", ",", "height"}], "]"}], 
                    "]"}]}], ";"}], "\n", "          ", ")"}], "&"}]}], "\n", 
               "        ", "]"}], ",", "\n", " \t\t", 
              RowBox[{"Column", "[", 
               RowBox[{"{", "\n", "   \t\t  ", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Graphics", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"matchingflag", ",", 
                    RowBox[{
                    RowBox[{"LinkPatternGraphicsCircular", "[", 
                    RowBox[{"matching", ",", "True"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "->", "300"}]}], "]"}], "]"}], ",", 
                 "\n", " \t\t  ", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Graphics", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"matchingflag", ",", 
                    RowBox[{
                    RowBox[{"LinkPatternGraphicsLinear", "[", 
                    RowBox[{"matching", ",", "True"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "->", "300"}]}], "]"}], "]"}]}], 
                "\n", " \t\t", "}"}], "]"}]}], "\n", "      ", "}"}], "]"}]}],
           "\n", "    ", "}"}], "]"}], "\n", "  ", "]"}]}], "\n", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplyTLOperatorToNoncrossingMatching", "[", 
      RowBox[{"order_", ",", "op_", ",", "matching_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "newmatching"}], 
        "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"a", " ", "=", " ", "op"}], ";", "\n", "  ", 
        RowBox[{"b", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"a", "==", "order"}], ",", "1", ",", 
           RowBox[{"a", "+", "1"}]}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"c", "=", 
         RowBox[{"matching", "[", 
          RowBox[{"[", "a", "]"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"d", "=", 
         RowBox[{"matching", "[", 
          RowBox[{"[", "b", "]"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"newmatching", " ", "=", " ", "matching"}], ";", "\n", "  ", 
        RowBox[{
         RowBox[{"newmatching", "[", 
          RowBox[{"[", "a", "]"}], "]"}], "=", "b"}], ";", "\n", "  ", 
        RowBox[{
         RowBox[{"newmatching", "[", 
          RowBox[{"[", "b", "]"}], "]"}], "=", "a"}], ";", "\n", "  ", 
        RowBox[{
         RowBox[{"newmatching", "[", 
          RowBox[{"[", "c", "]"}], "]"}], "=", "d"}], ";", "\n", "  ", 
        RowBox[{
         RowBox[{"newmatching", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "=", "c"}], ";", "\n", "  ", 
        "newmatching"}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FunAnimation", "[", 
      RowBox[{
      "order_", ",", " ", "updatespersec_", ",", " ", "secondstorun_"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", "\n", "    ", 
        RowBox[{
         RowBox[{"matching", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"j", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"2", "*", "order"}]}], "}"}]}], "]"}]}], ",", "\n", 
         "    ", 
         RowBox[{"ops", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ",", "\n", "    ", 
         RowBox[{"counter", " ", "=", " ", "0"}], ",", "\n", "    ", 
         RowBox[{"a", " ", "=", " ", "1"}], ",", "\n", "    ", 
         RowBox[{"b", " ", "=", " ", "2"}], ",", "\n", "    ", 
         RowBox[{"c", " ", "=", " ", "1"}], ",", "\n", "    ", 
         RowBox[{"d", " ", "=", " ", "2"}]}], "\n", "  ", "}"}], ",", "\n", 
       "  ", 
       RowBox[{"Dynamic", "[", "\n", "    ", 
        RowBox[{"Refresh", "[", "\n", "      ", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"counter", " ", "<", " ", 
              RowBox[{"secondstorun", "*", "updatespersec"}]}], ",", "\n", 
             "        ", 
             RowBox[{
              RowBox[{"ops", " ", "=", " ", 
               RowBox[{"Insert", "[", 
                RowBox[{"ops", ",", 
                 RowBox[{"Random", "[", 
                  RowBox[{"Integer", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "*", "order"}]}], "}"}]}], "]"}], ",", "1"}],
                 "]"}]}], ";", "\n", "        ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "ops", "]"}], ">", "200"}], ",", " ", 
                
                RowBox[{"ops", " ", "=", " ", 
                 RowBox[{"Most", "[", "ops", "]"}]}]}], "]"}], ";", "\n", 
              "\t    ", 
              RowBox[{"a", " ", "=", " ", 
               RowBox[{"ops", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t", 
              RowBox[{"b", " ", "=", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"a", "==", 
                  RowBox[{"2", "*", "order"}]}], ",", "1", ",", 
                 RowBox[{"a", "+", "1"}]}], "]"}]}], ";", "\n", "\t    ", 
              RowBox[{"c", "=", 
               RowBox[{"matching", "[", 
                RowBox[{"[", "a", "]"}], "]"}]}], ";", "\n", "\t    ", 
              RowBox[{"d", "=", 
               RowBox[{"matching", "[", 
                RowBox[{"[", "b", "]"}], "]"}]}], ";", "\n", "        ", 
              RowBox[{"matching", " ", "=", " ", 
               RowBox[{"ApplyTLOperatorToNoncrossingMatching", "[", 
                RowBox[{
                 RowBox[{"2", "*", "order"}], ",", 
                 RowBox[{"ops", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "matching"}], "]"}]}], 
              ";", "\n", "        ", 
              RowBox[{"counter", "=", 
               RowBox[{"counter", "+", "1"}]}], ";"}]}], "\n", "      ", 
            "]"}], ";", "\n", "      ", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\n", "        ", 
             RowBox[{
              RowBox[{"Graphics", "[", "\n", "          ", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"PipeOperatorGraphics", "[", 
                   RowBox[{
                    RowBox[{"2", "*", "order"}], ",", 
                    RowBox[{"ops", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"20", ",", 
                    RowBox[{"Length", "[", "ops", "]"}]}], "]"}]}], "}"}]}], 
                 "]"}], ",", "\n", "          ", 
                RowBox[{"ImageSize", "->", 
                 RowBox[{"{", 
                  RowBox[{"400", ",", "400"}], "}"}]}]}], "\n", "        ", 
               "]"}], ",", "\n", "        ", 
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", "\n", "          ", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"White", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1.4"}], "]"}]}], 
                   "}"}], ",", "\n", "          ", 
                  RowBox[{
                   RowBox[{"LinkPatternGraphicsCircular", "[", 
                    RowBox[{
                    RowBox[{
                    "NoncrossingMatchingToLinkPattern", "[", "matching", 
                    "]"}], ",", "False"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "          ", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", "\n", "            ", 
                    RowBox[{
                    RowBox[{"Switch", "[", 
                    RowBox[{
                    "j", ",", "a", ",", "Red", ",", "b", ",", "Red", ",", "c",
                     ",", "Blue", ",", "d", ",", "Blue", ",", "_", ",", 
                    "Black"}], "]"}], ",", "\n", "            ", 
                    RowBox[{"stickfigure", "[", 
                    RowBox[{
                    RowBox[{"1.2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"2", " ", "Pi", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", " ", "-", " ", "1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "order"}], ")"}]}]}], "+", "Pi"}], 
                    "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"-", "0.1"}], "+", 
                    RowBox[{"1.2", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"2", " ", "Pi", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", " ", "-", " ", "1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "order"}], ")"}]}]}], "+", "Pi"}], 
                    "]"}]}]}], ",", " ", "\n", "\t\t\t            ", 
                    RowBox[{"Switch", "[", 
                    RowBox[{
                    "j", ",", "a", ",", "0.43", ",", "b", ",", "0.43", ",", 
                    "c", ",", "0.43", ",", "d", ",", "0.43", ",", "_", ",", 
                    "0.4"}], "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", 
                    "          ", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"2", "*", "order"}]}], "}"}]}], "]"}]}], "\n", 
                 "        ", "}"}], ",", 
                RowBox[{"ImageSize", "->", "400"}]}], "]"}]}], "\n", "      ",
              "}"}], "]"}]}], ",", 
          RowBox[{"UpdateInterval", "->", 
           RowBox[{"1", "/", "updatespersec"}]}], ",", 
          RowBox[{"TrackedSymbols", "->", 
           RowBox[{"{", "}"}]}]}], "\n", "    ", "]"}], "\n", "  ", "]"}]}], 
      "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FunAnimation", "[", "]"}], " ", ":=", " ", 
     RowBox[{"FunAnimation", "[", 
      RowBox[{"8", ",", " ", "6", ",", " ", "500"}], "]"}]}], ";"}], "\n", 
   "\n", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"sqicefrommt", "[", "triangle_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"updown", ",", " ", "leftright", ",", " ", "n"}], "}"}], ",", 
       "\n", "   ", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"Length", "[", "triangle", "]"}]}], ";", "\n", "   ", 
        RowBox[{"updown", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}], 
            "}"}], ",", " ", 
           RowBox[{"Table", "[", "\n", "      ", 
            RowBox[{
             RowBox[{"Table", "[", "\n", "       ", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"triangle", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", " ", "j"}], "]"}], 
                  " ", "==", " ", 
                  RowBox[{"{", "}"}]}], ",", " ", "0", ",", " ", "1"}], "]"}],
                ",", " ", 
               RowBox[{"{", 
                RowBox[{"j", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}], 
             ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "1", ",", " ", "\n", "       ", "n"}], 
              "}"}]}], "\n", "      ", "]"}]}], "]"}]}], ";", "\n", "   ", 
        RowBox[{"leftright", " ", "=", " ", "\n", "    ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", " ", "==", " ", "0"}], ",", " ", "\n", "      ", 
             "1", ",", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", " ", "+", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], "^", "\n", "          ", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"updown", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", " ", "k"}], "]"}], "]"}], " ", "!=", 
                    " ", 
                    RowBox[{"updown", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "k"}], "]"}],
                     "]"}]}], ",", " ", "1", ",", " ", "0"}], "]"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    "k", ",", " ", "1", ",", " ", "\n", "            ", "j"}],
                     "}"}]}], "]"}]}]}], ")"}], "/", "2"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "0", ",", " ", "n"}], "}"}]}], "]"}]}], 
        ";", "\n", "   ", 
        RowBox[{"{", 
         RowBox[{"updown", ",", " ", "leftright"}], "}"}]}]}], "\n", "   ", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"fplfromsqice", "[", "arrows_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", " ", "hedges", ",", " ", "vedges"}], "}"}], ",", 
       "\n", "   ", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"arrows", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "-", " ", "1"}]}], 
        ";", "\n", "   ", 
        RowBox[{"vedges", " ", "=", " ", "\n", "    ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"arrows", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "+", " ", 
              "i", " ", "+", " ", "j", " ", "+", " ", "1"}], ",", " ", "2"}], 
            "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", 
             RowBox[{"n", " ", "+", " ", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "\n", "      ", "1", ",", " ", "n"}], 
            "}"}]}], "]"}]}], ";", "\n", "   ", 
        RowBox[{"hedges", " ", "=", " ", "\n", "    ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"arrows", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "+", " ", 
              "i", " ", "+", " ", "j", " ", "+", " ", "1"}], ",", " ", "2"}], 
            "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "1", ",", " ", "\n", "      ", 
             RowBox[{"n", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], ";", "\n",
         "   ", 
        RowBox[{"{", 
         RowBox[{"vedges", ",", " ", "hedges"}], "}"}]}]}], "\n", "   ", 
      "]"}]}], ";"}], "\n", "   ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"QuickAndDirtyRandomFPL", "[", "size_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tri", ",", "sq", ",", "fpl"}], "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"tri", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "k"}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", "\n",
         "  ", 
        RowBox[{"sq", " ", "=", " ", 
         RowBox[{"sqicefrommt", "[", "tri", "]"}]}], ";", "\n", "  ", 
        RowBox[{"fpl", " ", "=", " ", 
         RowBox[{"fplfromsqice", "[", "sq", "]"}]}], ";", "\n", "  ", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"fpl", "=", 
           RowBox[{"localgyrationop", "[", 
            RowBox[{"fpl", ",", 
             RowBox[{"Random", "[", 
              RowBox[{"Integer", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"size", "-", "1"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Random", "[", 
              RowBox[{"Integer", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"size", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "1", ",", "10000"}], "}"}]}], "]"}], ";", "\n", 
        "  ", "fpl"}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RandomFPL", "[", "size_", "]"}], ":=", 
     RowBox[{"QuickAndDirtyRandomFPL", "[", "size", "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{"FPLendpointpath", "[", 
     RowBox[{"edges_", ",", " ", "endpoint_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "path", ",", "x", ",", "y"}], "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"edges", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "-", " ", "1"}]}], ";",
        "\n", "  ", 
       RowBox[{"x", "=", 
        RowBox[{"endpoint", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"y", "=", 
        RowBox[{"endpoint", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"path", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "}"}]}], ";", "\n", "  ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"y", "==", "0"}], ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"edges", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "x"}], "]"}], "]"}], "==", "0"}], ",", " ", 
           RowBox[{"Return", "[", "path", "]"}], ",", " ", 
           RowBox[{"y", "=", "1"}]}], "]"}], ",", "\n", "    ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"y", "==", 
            RowBox[{"n", "+", "1"}]}], ",", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"edges", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"n", "+", "1"}], ",", "x"}], "]"}], "]"}], "==", 
              "0"}], ",", " ", 
             RowBox[{"Return", "[", "path", "]"}], ",", " ", 
             RowBox[{"y", "=", "n"}]}], "]"}], ",", "\n", "      ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "==", "0"}], ",", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"edges", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", "1"}], "]"}], "]"}], "==", "0"}], ",", 
               " ", 
               RowBox[{"Return", "[", "path", "]"}], ",", " ", 
               RowBox[{"x", "=", "1"}]}], "]"}], ",", "\n", "        ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"x", "==", 
                RowBox[{"n", "+", "1"}]}], ",", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"edges", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"y", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "==", "0"}], ",",
                  " ", 
                 RowBox[{"Return", "[", "path", "]"}], ",", " ", 
                 RowBox[{"x", "=", "n"}]}], "]"}], ",", "\n", "          ", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<error\>\"", "]"}], ";", " ", 
                RowBox[{"return", "[", "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
        "]"}], ";", "\n", "  ", 
       RowBox[{"path", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"path", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", ">", "0"}], " ", "&&", " ", 
          RowBox[{"x", "<", 
           RowBox[{"n", "+", "1"}]}], " ", "&&", " ", 
          RowBox[{"y", ">", "0"}], " ", "&&", " ", 
          RowBox[{"y", "<", 
           RowBox[{"n", "+", "1"}]}]}], ",", "\n", "    ", 
         RowBox[{
          RowBox[{"newpoint", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "-", "1"}]}], "}"}], ",", " ", 
                   RowBox[{
                    RowBox[{"edges", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "x"}], "]"}], "]"}]}], " ", "}"}], ",", 
                 "\n", "\t\t\t\t        ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}], ",", " ", 
                   RowBox[{
                    RowBox[{"edges", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "+", "1"}], ",", "x"}], "]"}], "]"}]}], " ", 
                  "}"}], ",", "\n", "\t\t\t  \t        ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "-", "1"}], ",", "y"}], "}"}], ",", " ", 
                   RowBox[{
                    RowBox[{"edges", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "x"}], "]"}], "]"}]}], " ", "}"}], ",", 
                 "\n", "\t\t\t\t        ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", "y"}], "}"}], ",", " ", 
                   RowBox[{
                    RowBox[{"edges", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", 
                    RowBox[{"x", "+", "1"}]}], "]"}], "]"}]}], " ", "}"}]}], 
                " ", "}"}], ",", "\n", "\t\t\t\t      ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "!=", " ", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "path", "]"}], "-", "1"}], "]"}], 
                    "]"}]}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "1"}]}], 
                 ")"}], "&"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t", 
          RowBox[{"x", " ", "=", " ", 
           RowBox[{"newpoint", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t", 
          RowBox[{"y", " ", "=", " ", 
           RowBox[{"newpoint", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t", 
          RowBox[{"path", " ", "=", " ", 
           RowBox[{"Append", "[", 
            RowBox[{"path", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";"}]}], "\n", "  ", 
        "]"}], ";", "\n", "  ", "path"}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FPLboundarypoints", "[", "n_", "]"}], ":=", 
     RowBox[{"Join", "[", "\n", "  ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "\n", "  ", 
       
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "\n", "  ", 
       
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n", ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\n", "  ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n", ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "\n", "]"}]}], ";"}], "\n",
    "\n", 
   RowBox[{
    RowBox[{"FPLmatching", "[", "edges_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "boundarypoints"}], "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"edges", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "-", " ", "1"}]}], ";",
        "\n", "  ", 
       RowBox[{"boundarypoints", " ", "=", " ", 
        RowBox[{"FPLboundarypoints", "[", "n", "]"}]}], ";", "\n", "  ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Ceiling", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"boundarypoints", ",", " ", "#"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], "]"}], ")"}], " ", 
          "&"}], ",", " ", "\n", "    ", 
         RowBox[{"Map", "[", 
          RowBox[{"Last", ",", " ", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"FPLendpointpath", "[", 
                 RowBox[{"edges", ",", " ", "#"}], "]"}], " ", "&"}], ",", 
               " ", "\n", "    ", "boundarypoints"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", "#", "]"}], " ", ">", " ", "1"}], 
               ")"}], " ", "&"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\n", 
     "]"}]}], "\n", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FPLgraphics", "[", "edges_", "]"}], " ", ":=", " ", 
     RowBox[{"FPLgraphics", "[", 
      RowBox[{"edges", ",", " ", "True"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FPLgraphics", "[", 
      RowBox[{"edges_", ",", " ", "numbered_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "n", "}"}], ",", "\n", "   ", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"edges", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "-", " ", "1"}]}], 
        ";", "\n", "   ", 
        RowBox[{"{", "\n", "    ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"GrayLevel", "[", "0.75", "]"}], ",", " ", 
            RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", " ", "\n", 
            "     ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", " ", "1"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", " ", "n"}], "}"}]}], "}"}], "]"}], ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}], 
            ",", " ", "\n", "     ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", " ", "i"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", " ", "i"}], "}"}]}], "}"}], "]"}], ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
           "}"}], ",", "\n", "    ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"AbsoluteThickness", "[", "4", "]"}], ",", "\n", "     ", 
            
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"edges", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "==", 
                   " ", "1"}], ",", " ", "Black", ",", " ", 
                  RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", " ", "\n",
                 "       ", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"j", ",", " ", 
                    RowBox[{"i", " ", "-", " ", "1"}]}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", " ", "i"}], "}"}]}], "}"}], "]"}]}], 
               "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "1", ",", " ", 
                RowBox[{"n", " ", "+", " ", "1"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}], 
            ",", "\n", "     ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"edges", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "==", 
                   " ", "1"}], ",", " ", "Black", ",", " ", 
                  RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", " ", "\n",
                 "       ", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"j", " ", "-", " ", "1"}], ",", " ", "i"}], "}"}],
                    ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", " ", "i"}], "}"}]}], "}"}], "]"}]}], 
               "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", "1", ",", " ", 
                RowBox[{"n", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], "\n", 
           "     ", "}"}], ",", "\n", "    ", 
          RowBox[{"If", "[", 
           RowBox[{"numbered", ",", "\n", "    ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"EvenQ", "[", "n", "]"}], ",", "\n", "     ", 
              RowBox[{"{", "\n", "      ", 
               RowBox[{
                RowBox[{"Table", "[", "\n", "       ", 
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"i", ",", " ", "20"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", " ", "i"}], " ", "-", " ", "1"}], ",", " ", 
                    RowBox[{"-", "0.4"}]}], "}"}]}], "]"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", " ", "1", ",", " ", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], ",", " ", "1"}], "}"}]}], 
                 "]"}], ",", "\n", "      ", 
                RowBox[{"Table", "[", "\n", "       ", 
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"j", " ", "+", " ", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"n", "/", "2"}], "]"}]}], ",", " ", "20"}], "]"}],
                     ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", " ", "+", " ", "1.3"}], ",", " ", 
                    RowBox[{
                    RowBox[{"2", " ", "j"}], " ", "-", " ", "1"}]}], "}"}]}], 
                   "]"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", " ", "1", ",", " ", "\n", "        ", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], ",", " ", "1"}], "}"}]}], 
                 "]"}], ",", "\n", "      ", 
                RowBox[{"Table", "[", "\n", "       ", 
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"n", " ", "+", " ", "1", " ", "+", " ", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], " ", "-", " ", "i"}], ",",
                     " ", "20"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", " ", "i"}], ",", " ", 
                    RowBox[{"n", " ", "+", " ", "1.3"}]}], "}"}]}], "]"}], 
                  ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", " ", "\n", "        ", "1", ",", " ", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], ",", " ", "1"}], "}"}]}], 
                 "]"}], ",", "\n", "      ", 
                RowBox[{"Table", "[", "\n", "       ", 
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", " ", "n"}], " ", "+", " ", "1", " ", "-", 
                    " ", "j"}], ",", " ", "20"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.3"}], ",", " ", 
                    RowBox[{"2", " ", "j"}]}], "}"}]}], "]"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", " ", "1", ",", " ", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], ",", " ", "\n", 
                    "        ", "1"}], "}"}]}], "]"}]}], "\n", "      ", 
               "}"}], ",", "\n", "     ", 
              RowBox[{"{", "\n", "      ", 
               RowBox[{
                RowBox[{"Table", "[", "\n", "       ", 
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"i", ",", " ", "20"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", " ", "i"}], " ", "-", " ", "1"}], ",", " ", 
                    RowBox[{"-", "0.4"}]}], "}"}]}], "]"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", " ", "1", ",", " ", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], ",", " ", "1"}], "}"}]}], 
                 "]"}], ",", "\n", "      ", 
                RowBox[{"Table", "[", "\n", "       ", 
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"j", " ", "+", " ", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"n", "/", "2"}], "]"}]}], ",", " ", "20"}], "]"}],
                     ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", " ", "+", " ", "1.3"}], ",", " ", 
                    RowBox[{"2", " ", "j"}]}], "}"}]}], "]"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", " ", "1", ",", " ", "\n", "        ", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], ",", " ", "1"}], "}"}]}], 
                 "]"}], ",", "\n", "      ", 
                RowBox[{"Table", "[", "\n", "       ", 
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"n", " ", "+", " ", "1", " ", "+", " ", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], " ", "-", " ", "i"}], ",",
                     " ", "20"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", " ", "i"}], " ", "-", " ", "1"}], ",", " ", 
                    "\n", "         ", 
                    RowBox[{"n", " ", "+", " ", "1.3"}]}], "}"}]}], "]"}], 
                  ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", " ", "1", ",", " ", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], ",", " ", "1"}], "}"}]}], 
                 "]"}], ",", "\n", "      ", 
                RowBox[{"Table", "[", "\n", "       ", 
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", " ", "n"}], " ", "+", " ", "1", " ", "-", 
                    " ", "j"}], ",", " ", "20"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.3"}], ",", " ", 
                    RowBox[{"2", " ", "j"}]}], "}"}]}], "]"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", " ", "1", ",", " ", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"n", "/", "2"}], "]"}], ",", " ", "\n", 
                    "        ", "1"}], "}"}]}], "]"}]}], "\n", "      ", 
               "}"}]}], "]"}], "\n", "      ", ",", 
            RowBox[{"{", "}"}]}], "]"}]}], "\n", "    ", "}"}]}]}], "\n", 
      "   ", "]"}]}], ";"}], "\n", "   ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"localgyrationop", "[", 
      RowBox[{"edges_", ",", " ", "i_", ",", " ", "j_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "newedges", "}"}], ",", "\n", "   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"edges", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "j"}], "]"}], 
            "]"}], " ", "==", " ", 
           RowBox[{
            RowBox[{"edges", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", " ", "+", " ", "1"}], ",", " ", 
              RowBox[{"j", " ", "+", " ", "1"}]}], "]"}], "]"}]}], " ", "&&", 
          "\n", "     ", 
          RowBox[{
           RowBox[{
            RowBox[{"edges", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", 
              RowBox[{"j", " ", "+", " ", "1"}]}], "]"}], "]"}], " ", "==", 
           " ", 
           RowBox[{
            RowBox[{"edges", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", " ", "+", " ", "1"}], ",", " ", 
              RowBox[{"j", " ", "+", " ", "1"}]}], "]"}], "]"}]}], " ", "&&", 
          "\n", "     ", 
          RowBox[{
           RowBox[{
            RowBox[{"edges", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "j"}], "]"}], 
            "]"}], " ", "!=", " ", 
           RowBox[{
            RowBox[{"edges", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", 
              RowBox[{"j", " ", "+", " ", "1"}]}], "]"}], "]"}]}]}], ",", 
         "\n", "    ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"newedges", " ", "=", " ", "edges"}], ";", "\n", "     ", 
           RowBox[{
            RowBox[{
             RowBox[{"newedges", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "j"}], "]"}], 
             "]"}], " ", "=", " ", 
            RowBox[{"1", " ", "-", " ", 
             RowBox[{
              RowBox[{"edges", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "j"}], "]"}], 
              "]"}]}]}], ";", "\n", "     ", 
           RowBox[{
            RowBox[{
             RowBox[{"newedges", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", " ", "+", " ", "1"}], ",", " ", 
               RowBox[{"j", " ", "+", " ", "1"}]}], "]"}], "]"}], " ", "=", 
            " ", 
            RowBox[{"1", " ", "-", " ", 
             RowBox[{
              RowBox[{"edges", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", " ", "+", " ", "1"}], ",", " ", 
                RowBox[{"j", " ", "+", " ", "1"}]}], "]"}], "]"}]}]}], ";", 
           "\n", "     ", 
           RowBox[{
            RowBox[{
             RowBox[{"newedges", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", 
               RowBox[{"j", " ", "+", " ", "1"}]}], "]"}], "]"}], " ", "=", 
            " ", 
            RowBox[{"1", " ", "-", " ", 
             RowBox[{
              RowBox[{"edges", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", 
                RowBox[{"j", " ", "+", " ", "1"}]}], "]"}], "]"}]}]}], ";", 
           "\n", "     ", 
           RowBox[{
            RowBox[{
             RowBox[{"newedges", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", " ", "+", " ", "1"}], ",", " ", 
               RowBox[{"j", " ", "+", " ", "1"}]}], "]"}], "]"}], " ", "=", 
            " ", 
            RowBox[{"1", " ", "-", " ", 
             RowBox[{
              RowBox[{"edges", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", " ", "+", " ", "1"}], ",", " ", 
                RowBox[{"j", " ", "+", " ", "1"}]}], "]"}], "]"}]}]}], ";", 
           "\n", "     ", "newedges"}], ")"}], ",", "\n", "    ", "edges"}], 
        "]"}]}], "\n", "   ", "]"}]}], ";"}], "  ", "\n", "   ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"globalgyrationop", "[", 
      RowBox[{"edges_", ",", " ", "parity_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "newedges"}], "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"edges", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "2"}]}], ";", "\n", 
        "  ", 
        RowBox[{"newedges", " ", "=", " ", "edges"}], ";", "\n", "  ", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", 
             RowBox[{"i", "+", "j", "+", "parity"}], "]"}], ",", 
            RowBox[{"newedges", " ", "=", " ", 
             RowBox[{"localgyrationop", "[", 
              RowBox[{"newedges", ",", "i", ",", "j"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "  ",
         "newedges"}]}], "\n", "]"}]}], ";"}], "\n", "   ", "\n", "   ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FPLsInteractiveDemo", "[", "]"}], " ", ":=", " ", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", "\n", "  ", 
        RowBox[{"tri", ",", "sq", ",", "fpl", ",", "\n", "  ", 
         RowBox[{"matchingflag", " ", "=", " ", "False"}], ",", "\n", "  ", 
         RowBox[{"autoinvertcolors", " ", "=", " ", "False"}], ",", "\n", 
         "  ", "size", ",", "\n", "  ", 
         RowBox[{"alternatingflag", " ", "=", " ", "0"}], ",", "\n", "  ", 
         RowBox[{"checkerboardflag", " ", "=", " ", "False"}]}], "\n", "  ", 
        "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"size", " ", "=", " ", "8"}], ";", "\n", "  ", 
        RowBox[{"tri", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "k"}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", "\n",
         "  ", 
        RowBox[{"sq", " ", "=", " ", 
         RowBox[{"sqicefrommt", "[", "tri", "]"}]}], ";", "\n", "  ", 
        RowBox[{"fpl", " ", "=", " ", 
         RowBox[{"fplfromsqice", "[", "sq", "]"}]}], ";", "\n", "  ", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"fpl", "=", 
           RowBox[{"localgyrationop", "[", 
            RowBox[{"fpl", ",", 
             RowBox[{"Random", "[", 
              RowBox[{"Integer", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"size", "-", "1"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Random", "[", 
              RowBox[{"Integer", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"size", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "1", ",", "10000"}], "}"}]}], "]"}], ";", "\n", 
        "  ", 
        RowBox[{"Panel", "[", "\n", "    ", 
         RowBox[{"Column", "[", 
          RowBox[{"{", "\n", "      ", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", "\n", "        ", 
              RowBox[{"\"\<Size:  \>\"", ",", 
               RowBox[{"Slider", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"size", ",", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"size", "=", "#"}], ";", " ", 
                    RowBox[{"tri", " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "k"}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
                    ";", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"sq", " ", "=", " ", 
                    RowBox[{"sqicefrommt", "[", "tri", "]"}]}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"fpl", " ", "=", " ", 
                    RowBox[{"fplfromsqice", "[", "sq", "]"}]}], ";"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "30", ",", "1"}], "}"}]}], "]"}], ",", 
               "\n", "\t\t", "\"\<   \>\"", ",", " ", 
               RowBox[{"InputField", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "size", "]"}], ",", 
                 RowBox[{"Enabled", "->", "False"}], ",", 
                 RowBox[{"FieldSize", "->", "2"}]}], "]"}]}], 
              "\t\t\t\t\t\t\t\t\t\t", "\n", "      ", "}"}], "]"}], ",", "\n",
             "      ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", "\n", "        ", 
              RowBox[{
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Even half-gyration\>\"", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"fpl", "=", 
                    RowBox[{"globalgyrationop", "[", 
                    RowBox[{"fpl", ",", "0"}], "]"}]}], ";", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{"autoinvertcolors", ",", " ", 
                    RowBox[{"fpl", "=", 
                    RowBox[{"1", "-", "fpl"}]}]}], "]"}]}], ")"}], "&"}]}], 
                "]"}], ",", "\n", "        ", 
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Odd half-gyration\>\"", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"fpl", "=", 
                    RowBox[{"globalgyrationop", "[", 
                    RowBox[{"fpl", ",", "1"}], "]"}]}], ";", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{"autoinvertcolors", ",", " ", 
                    RowBox[{"fpl", "=", 
                    RowBox[{"1", "-", "fpl"}]}]}], "]"}]}], ")"}], "&"}]}], 
                "]"}], ",", "\n", "        ", 
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Alternating half-gyration\>\"", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"fpl", "=", 
                    RowBox[{"globalgyrationop", "[", 
                    RowBox[{"fpl", ",", "alternatingflag"}], "]"}]}], ";", 
                    "\n", "        \t\t\t\t\t\t\t\t\t", 
                    RowBox[{"alternatingflag", " ", "=", " ", 
                    RowBox[{"1", "-", "alternatingflag"}]}], ";", " ", "\n", 
                    "        \t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{"autoinvertcolors", ",", " ", 
                    RowBox[{"fpl", "=", 
                    RowBox[{"1", "-", "fpl"}]}]}], "]"}]}], "\n", 
                   "        \t\t\t\t\t\t\t\t\t", ")"}], "&"}]}], "\n", 
                "\t\t\t  ", "]"}], ",", "\n", "        ", 
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Full gyration\>\"", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"fpl", "=", 
                    RowBox[{"globalgyrationop", "[", 
                    RowBox[{"fpl", ",", "1"}], "]"}]}], ";", "\n", 
                    "\t\t\t\t\t\t        ", 
                    RowBox[{"fpl", "=", 
                    RowBox[{"globalgyrationop", "[", 
                    RowBox[{"fpl", ",", "0"}], "]"}]}]}], "\n", 
                   "        \t\t\t\t\t   ", ")"}], "&"}]}], "]"}]}], "\n", 
              "      ", "}"}], "]"}], ",", "\n", "      ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", "\n", "        ", 
              RowBox[{
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Simple\>\"", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"tri", " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "k"}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
                    ";", "\n", "\t\t\t\t\t\t ", 
                    RowBox[{"sq", " ", "=", " ", 
                    RowBox[{"sqicefrommt", "[", "tri", "]"}]}], ";", "\n", 
                    "\t\t\t\t\t\t ", 
                    RowBox[{"fpl", " ", "=", " ", 
                    RowBox[{"fplfromsqice", "[", "sq", "]"}]}], ";"}], ")"}], 
                  "&"}]}], "]"}], ",", "\n", "        ", 
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Random\>\"", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"fpl", "=", 
                    RowBox[{"localgyrationop", "[", 
                    RowBox[{"fpl", ",", 
                    RowBox[{"Random", "[", 
                    RowBox[{"Integer", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"size", "-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Random", "[", 
                    RowBox[{"Integer", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"size", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "1", ",", "10000"}], "}"}]}], "]"}], 
                   ")"}], "&"}]}], "]"}], ",", "\n", "        ", 
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Invert edges\>\"", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"fpl", "=", 
                    RowBox[{"1", "-", "fpl"}]}], ")"}], "&"}]}], "]"}]}], 
              "\n", "      ", "}"}], "]"}], ",", "\n", "\t  ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Checkerboard pattern: \>\"", ",", 
               RowBox[{"Checkbox", "[", 
                RowBox[{"Dynamic", "[", "checkerboardflag", "]"}], "]"}]}], 
              "}"}], "]"}], ",", "            ", "\n", "\t  ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Connectivity pattern: \>\"", ",", 
               RowBox[{"Checkbox", "[", 
                RowBox[{"Dynamic", "[", "matchingflag", "]"}], "]"}]}], "}"}],
              "]"}], ",", "      ", "\n", "\t  ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Invert edges after each half-gyration: \>\"", ",", 
               RowBox[{"Checkbox", "[", 
                RowBox[{"Dynamic", "[", "autoinvertcolors", "]"}], "]"}]}], 
              "}"}], "]"}], ",", "\n", "\t  ", 
            RowBox[{"Row", "[", 
             RowBox[{"{", "\n", "        ", 
              RowBox[{
               RowBox[{"ClickPane", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Graphics", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FPLgraphics", "[", "fpl", "]"}], ",", "\n", 
                    "        \t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{"checkerboardflag", ",", "\n", "        \t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"GrayLevel", "[", "0.85", "]"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "0.1"}], ",", 
                    RowBox[{"j", "+", "0.1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "0.9"}], ",", 
                    RowBox[{"j", "+", "0.9"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"size", "-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"1", "+", 
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}]}], ",", 
                    RowBox[{"size", "-", "1"}], ",", "2"}], "}"}]}], "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "\n", "        ", "}"}], 
                    ",", 
                    RowBox[{"ImageSize", "->", "400"}]}], "]"}], "]"}], ",", 
                 " ", "\n", "           ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"fpl", " ", "=", " ", 
                    RowBox[{"localgyrationop", "[", 
                    RowBox[{"fpl", ",", " ", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ")"}], 
                  " ", "&"}]}], "]"}], ",", "\n", "        ", 
               RowBox[{"Dynamic", "[", 
                RowBox[{"If", "[", 
                 RowBox[{"matchingflag", ",", " ", "\n", "        \t\t\t", 
                  RowBox[{"Graphics", "[", "\n", 
                   RowBox[{
                    RowBox[{"LinkPatternGraphicsCircular", "[", 
                    RowBox[{
                    RowBox[{"NoncrossingMatchingToLinkPattern", "[", 
                    RowBox[{"FPLmatching", "[", "fpl", "]"}], "]"}], ",", 
                    "True"}], "]"}], "        \t\t\t", "\n", "        \t\t\t",
                     ",", 
                    RowBox[{"ImageSize", "->", "400"}]}], "]"}], ",", "\n", 
                  "        \t\t\t", 
                  RowBox[{"Graphics", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0", "]"}], ",", 
                    RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "->", "400"}]}], "]"}]}], "]"}], 
                "]"}]}], "\n", "      ", "}"}], "]"}]}], "\n", "    ", "}"}], 
          "]"}], "\n", "  ", "]"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FunFPLAnimation", "[", "size_", "]"}], ":=", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fpl", ",", "parity"}], "}"}], ",", 
       RowBox[{
        RowBox[{"parity", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"fpl", "=", 
         RowBox[{"QuickAndDirtyRandomFPL", "[", "size", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Dynamic", "[", 
            RowBox[{"Refresh", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"fpl", "=", 
                RowBox[{"1", "-", 
                 RowBox[{"globalgyrationop", "[", 
                  RowBox[{"fpl", ",", "parity"}], "]"}]}]}], ";", 
               RowBox[{"parity", "=", 
                RowBox[{"1", "-", "parity"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Graphics", "[", 
                RowBox[{
                 RowBox[{"FPLgraphics", "[", 
                  RowBox[{"fpl", ",", "False"}], "]"}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}], ",", 
              RowBox[{"UpdateInterval", "\[Rule]", 
               RowBox[{"1", "/", "4"}]}], ",", 
              RowBox[{"TrackedSymbols", "\[Rule]", 
               RowBox[{"{", "}"}]}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"NoncrossingMatchingGraphicsCircular", "[", 
                RowBox[{
                 RowBox[{"FPLmatching", "[", "fpl", "]"}], ",", "True"}], 
                "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OEISLookup", "[", "sequence_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "url", "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"url", " ", "=", " ", "\"\<http://oeis.org/search?q=\>\""}], 
        ";", "\n", "  ", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"url", " ", "=", " ", 
           RowBox[{"url", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"sequence", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "<", 
               RowBox[{"Length", "[", "sequence", "]"}]}], ",", "\"\<%2C\>\"",
               ",", "\"\<&languge=english&go=Search\>\""}], "]"}]}]}], " ", 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "sequence", "]"}]}], "}"}]}], "]"}], ";", 
        "\n", "  ", 
        RowBox[{"SystemOpen", "[", "url", "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
     "OnlineEncyclopediaOfIntegerSequencesLookup", "[", "sequence_", "]"}], ":=", 
     RowBox[{"OEISLookup", "[", "sequence", "]"}]}], ";"}], "\n", "\n", "\n", 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Code", " ", "to", " ", "compute", " ", "all", " ", "complete", " ", 
     "monotone", " ", "triangles", " ", "and", " ", "all", " ", "FPLs", " ", 
     "of", " ", "given", " ", "order"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RowsInterlacingWith", "[", "row_", "]"}], " ", ":=", " ", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"MultiCartesianProduct", "[", "\n", "    ", 
        RowBox[{"Table", "[", "\n", "     ", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"row", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
            RowBox[{"row", "[", 
             RowBox[{"[", 
              RowBox[{"j", " ", "+", " ", "1"}], "]"}], "]"}]}], "]"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "1", ",", " ", 
            RowBox[{
             RowBox[{"Length", "[", "row", "]"}], " ", "-", " ", "1"}]}], 
           "}"}]}], "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", " ", "==", " ", "\n", "      ", 
          RowBox[{"Union", "[", "#", "]"}]}], ")"}], " ", "&"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MonotoneTrianglesWithBottomRow", "[", "row_", "]"}], " ", ":=", 
     " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "row", "]"}], " ", "==", " ", "1"}], ",", " ", 
       
       RowBox[{"{", 
        RowBox[{"{", "row", "}"}], "}"}], ",", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", " ", "b", ",", " ", "c"}], "}"}], ",", "\n", 
         "    ", 
         RowBox[{
          RowBox[{"a", " ", "=", " ", 
           RowBox[{"RowsInterlacingWith", "[", "row", "]"}]}], ";", "\n", 
          "    ", 
          RowBox[{"b", " ", "=", " ", 
           RowBox[{"Map", "[", 
            RowBox[{"MonotoneTrianglesWithBottomRow", ",", " ", "a"}], 
            "]"}]}], ";", "\n", "    ", 
          RowBox[{"c", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Append", "[", 
                 RowBox[{"#", ",", " ", "row"}], "]"}], " ", "&"}], ",", " ", 
               
               RowBox[{"b", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "1", ",", " ", 
               RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}]}], ";", 
          "\n", "    ", 
          RowBox[{"Apply", "[", 
           RowBox[{"Join", ",", " ", "c"}], "]"}]}]}], "\n", "    ", "]"}]}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CompleteMonotoneTriangles", "[", "n_", "]"}], " ", ":=", " ", 
     "\n", "  ", 
     RowBox[{"MonotoneTrianglesWithBottomRow", "[", 
      RowBox[{"Range", "[", "n", "]"}], "]"}]}], ";"}], "\n", "  ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AllFPLs", "[", "n_", "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fplfromsqice", "[", 
         RowBox[{"sqicefrommt", "[", "#", "]"}], "]"}], "&"}], ",", 
       RowBox[{"CompleteMonotoneTriangles", "[", "n", "]"}]}], "]"}]}], ";"}],
    "\n", "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"ProbabilityForSubmatchingEvent", "[", 
     RowBox[{"n_", ",", " ", "submatching_"}], "]"}], " ", ":=", " ", "\n", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sublplength", ",", " ", "sublp", ",", " ", "linkpatterns", ",", " ", 
        "rseigenvector"}], "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"linkpatterns", " ", "=", " ", 
        RowBox[{"LinkPatterns", "[", "n", "]"}]}], ";", "\n", "  ", 
       RowBox[{"sublp", " ", "=", " ", 
        RowBox[{
        "NoncrossingMatchingToLinkPattern", "[", "submatching", "]"}]}], ";", 
       "\n", "  ", 
       RowBox[{"sublplength", " ", "=", " ", 
        RowBox[{"Length", "[", "submatching", "]"}]}], ";", "\n", "  ", 
       RowBox[{"rseigenvector", " ", "=", " ", 
        RowBox[{"RazumovStroganovEigenvector", "[", "n", "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"Plus", ",", " ", "\n", "    ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rseigenvector", "[", 
              RowBox[{"[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], " ", "&"}], 
            ",", " ", "\n", "     ", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"j", ",", " ", 
                  RowBox[{"linkpatterns", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"j", ",", " ", "1", ",", " ", "\n", "        ", 
                  RowBox[{"Length", "[", "linkpatterns", "]"}]}], "}"}]}], 
               "]"}], ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"Range", "[", 
                    RowBox[{"1", ",", " ", "sublplength"}], "]"}], "]"}], 
                  "]"}], " ", "==", " ", "\n", "         ", "sublp"}], ")"}], 
               " ", "&"}]}], "]"}]}], "]"}]}], "]"}], "/", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", "j"}], " ", "+", " ", "1"}], ")"}], "!"}], 
           "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", " ", "+", " ", "j"}], ")"}], "!"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "0", ",", " ", 
            RowBox[{"n", " ", "-", " ", "1"}]}], "}"}]}], "]"}]}]}]}], "\n", 
     "  ", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"GuessFormula", "[", 
     RowBox[{"seq_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"n_", ",", " ", "a_", ",", " ", "b_"}], "}"}], ",", " ", 
      "hint_"}], "]"}], " ", ":=", " ", "\n", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", " ", "\n", "  ", 
      RowBox[{"TraditionalForm", "[", "\n", "   ", 
       RowBox[{"Simplify", "[", "\n", "    ", 
        RowBox[{
         RowBox[{"ReplaceAll", "[", "\n", "      ", 
          RowBox[{
           RowBox[{"InterpolatingPolynomial", "[", "\n", "       ", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"j", "^", "2"}], ",", " ", "\n", "         ", 
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    "j", " ", "-", " ", "a", " ", "+", " ", "\n", 
                    "             ", "1"}], "]"}], "]"}], " ", 
                  RowBox[{"Product", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", 
                    RowBox[{"j", "^", "2"}]}], " ", "-", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "k"}], " ", "-", " ", "1"}], ")"}], "^",
                     "2"}]}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"hint", " ", "+", " ", "1", " ", "-", " ", "k"}], 
                    ")"}]}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    "k", ",", " ", "1", ",", " ", "\n", "            ", 
                    "hint"}], "}"}]}], "]"}]}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"j", ",", " ", "a", ",", " ", "b"}], "}"}]}], "]"}], 
             ",", " ", "x"}], "]"}], ",", " ", 
           RowBox[{"x", " ", "->", " ", 
            RowBox[{"n", "^", "2"}]}]}], "]"}], "/", "\n", "     ", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               RowBox[{"n", "^", "2"}]}], " ", "-", " ", 
              RowBox[{"k", "^", "2"}]}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"hint", " ", "+", " ", "1", " ", "-", " ", "k"}], 
             ")"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"k", ",", " ", "1", ",", " ", "hint"}], "}"}]}], "]"}]}], 
        "]"}], "]"}]}], "]"}]}], "\n", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CylinderGraphics", "[", "gr2d_", "]"}], " ", ":=", " ", "\n", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "height", ",", " ", "xmin", ",", " ", "xmax", ",", " ", "ymin", ",", 
         " ", "ymax", ",", " ", "lmap"}], "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"height", " ", "=", " ", 
         RowBox[{"2", " ", "Pi"}]}], ";", "\n", "  ", 
        RowBox[{"xmin", " ", "=", " ", "0.02"}], ";", "\n", "  ", 
        RowBox[{"xmax", " ", "=", " ", 
         RowBox[{"1", " ", "-", " ", "0.021"}]}], ";", "\n", "  ", 
        RowBox[{"ymin", " ", "=", " ", "0.02"}], ";", "\n", "  ", 
        RowBox[{"ymax", " ", "=", " ", 
         RowBox[{"1", " ", "-", " ", "0.018"}]}], ";", "\n", "  ", 
        RowBox[{"lmap", " ", "=", " ", 
         RowBox[{"Function", "[", "\n", "    ", 
          RowBox[{"pt", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xmin", " ", "+", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"xmax", " ", "-", " ", "xmin"}], ")"}], " ", 
               RowBox[{"pt", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", "\n", "     ", 
             RowBox[{"ymin", " ", "+", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ymax", " ", "-", " ", "ymin"}], ")"}], " ", 
               RowBox[{"pt", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}]}], "]"}]}], ";", 
        "\n", "  ", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Specularity", "[", 
             RowBox[{"Gray", ",", " ", "40"}], "]"}], ",", "\n", "    ", 
            RowBox[{"Texture", "[", "gr2d", "]"}], ",", " ", 
            RowBox[{"EdgeForm", "[", "]"}], ",", " ", "\n", "    ", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"dphi", " ", "=", " ", 
                RowBox[{"Pi", "/", "180"}]}], "}"}], ",", " ", "\n", "     ", 
              
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Polygon", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "phi", "]"}], ",", " ", 
                    RowBox[{"Sin", "[", "phi", "]"}], ",", " ", "0"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"phi", " ", "+", " ", "dphi"}], "]"}], ",", " ", 
                    "\n", "         ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"phi", " ", "+", " ", "dphi"}], "]"}], ",", " ", 
                    "0"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"phi", " ", "+", " ", "dphi"}], "]"}], ",", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"phi", " ", "+", " ", "dphi"}], "]"}], ",", " ", 
                    "\n", "         ", "height"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "phi", "]"}], ",", " ", 
                    RowBox[{"Sin", "[", "phi", "]"}], ",", " ", "height"}], 
                    "}"}]}], "}"}], ",", " ", "\n", "       ", 
                  RowBox[{
                  "VertexTextureCoordinates", " ", "->", " ", "\n", 
                   "        ", 
                   RowBox[{"Map", "[", 
                    RowBox[{"lmap", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"phi", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "Pi"}], ")"}]}], ",", " ", "0"}], "}"}],
                     ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"phi", " ", "+", " ", "dphi"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "Pi"}], ")"}]}], ",", " ", "\n", 
                    "           ", "0"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"phi", " ", "+", " ", "dphi"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "Pi"}], ")"}]}], ",", " ", "1"}], "}"}],
                     ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"phi", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "Pi"}], ")"}]}], ",", " ", "1"}], 
                    "}"}]}], "}"}]}], "]"}]}]}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"phi", ",", " ", "0", ",", " ", "\n", "       ", 
                  RowBox[{
                   RowBox[{"2", " ", "Pi"}], " ", "-", " ", "dphi"}], ",", 
                  " ", "dphi"}], "}"}]}], "]"}]}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"Boxed", " ", "->", " ", "False"}], ",", " ", 
          RowBox[{"Lighting", " ", "->", " ", "\"\<Neutral\>\""}], ",", " ", 
          "\n", "   ", 
          RowBox[{"ImageSize", " ", "->", " ", "200"}]}], "]"}]}]}], "\n", 
      "  ", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Code", " ", "for", " ", "an", " ", "adjustable", " ", "slider", " ", 
     "that", " ", "sets", " ", "the", " ", "magnification", " ", 
     "continuously"}], " ", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MyMagnificationSlider", "[", "notebook_", "]"}], ":=", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mag", "=", "100"}], ",", " ", 
         RowBox[{"oldmag", "=", "100"}], ",", " ", 
         RowBox[{"actualmag", "=", "100"}]}], "}"}], ",", "\n", "  ", 
       RowBox[{"Panel", "[", "\n", "  ", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\n", "    ", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", "\n", "      ", 
             RowBox[{"\"\<Magnification: \>\"", ",", "\n", "      ", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"mag", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"mag", "=", "#"}], ";", " ", 
                    RowBox[{"oldmag", " ", "=", " ", "actualmag"}], ";", " ", 
                    
                    RowBox[{"actualmag", "=", "mag"}], ";", " ", 
                    RowBox[{"SetOptions", "[", 
                    RowBox[{"notebook", ",", " ", 
                    RowBox[{"Magnification", "->", 
                    RowBox[{"(", 
                    RowBox[{"mag", "/", "100.0"}], ")"}]}]}], "]"}]}], ")"}], 
                   "&"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"50", ",", "150", ",", "1"}], "}"}]}], "]"}], ",", 
              "\"\<  \>\"", ",", "\n", "      ", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "mag", "]"}], "<>", "\"\<%\>\""}], 
                 "]"}], ",", "String", ",", 
                RowBox[{"Enabled", "->", "False"}], ",", 
                RowBox[{"FieldSize", "->", "4"}]}], "]"}]}], "\n", "    ", 
             "}"}], "]"}], ",", "\n", "    ", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\n", "      ", 
             RowBox[{"Button", "[", 
              RowBox[{"\"\<Revert\>\"", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"mag", " ", "=", " ", "oldmag"}], ";", " ", 
                  RowBox[{"SetOptions", "[", 
                   RowBox[{"notebook", ",", " ", 
                    RowBox[{"Magnification", "->", 
                    RowBox[{"(", 
                    RowBox[{"mag", "/", "100.0"}], ")"}]}]}], "]"}]}], ")"}], 
                "&"}]}], "]"}], "\n", "    ", "}"}], "]"}]}], "\n", "  ", 
          "}"}], "]"}], "\n", "  ", "]"}]}], "\n", "]"}]}], ";"}]}]}]], "Code",\

 CellChangeTimes->{{3.61630061191182*^9, 3.616300651945877*^9}, {
  3.6163007678800592`*^9, 3.616300770090721*^9}, {3.616300835922394*^9, 
  3.616300878285941*^9}, {3.6163024585483027`*^9, 3.6163025132111807`*^9}, {
  3.616303297438129*^9, 3.6163033055901318`*^9}, {3.61637363746664*^9, 
  3.6163736434816504`*^9}, {3.616376718050123*^9, 3.6163767220795116`*^9}, {
  3.6163769371421432`*^9, 3.616376940508451*^9}}],

Cell[BoxData["\<\"loops version 1.0\\nCopyright (c) 2014 Dan Romik\\nType \
LoopsHelp[] for more information\"\>"], "Print",
 CellChangeTimes->{
  3.616300955677023*^9, {3.616301040238121*^9, 3.616301053203905*^9}, 
   3.616301401762224*^9, {3.616302461701252*^9, 3.616302515413727*^9}, {
   3.616302591461506*^9, 3.616302634937189*^9}, 3.616302671649557*^9, 
   3.6163027584041843`*^9, 3.616304389217443*^9, 3.6163044961770782`*^9, 
   3.616304547780725*^9, 3.6163692101863117`*^9, 3.61637676101381*^9, 
   3.616376851447255*^9, 3.616376892292076*^9, 3.616376957251815*^9, 
   3.61637755328578*^9, 3.61637852603257*^9, 3.61637872498835*^9, 
   3.6163801655838346`*^9, 3.616380315921606*^9, 3.616387580121526*^9, 
   3.616768023844117*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Other initialization code", "Subsubsection",
 CellChangeTimes->{{3.6161586237021112`*^9, 3.616158637664947*^9}, {
  3.616158757170019*^9, 3.616158759930278*^9}}],

Cell["\<\
Some stuff to set things up for the presentation\
\>", "Text",
 CellChangeTimes->{{3.616300680747102*^9, 3.616300685696477*^9}, {
  3.616302245931856*^9, 3.616302247944623*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Code", " ", "for", " ", "an", " ", "adjustable", " ", "slider", " ", 
    "that", " ", "sets", " ", "the", " ", "notebook", " ", "magnification", 
    " ", "continuously"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MyMagnificationSliderPalette", "[", "]"}], ":=", 
     RowBox[{"SetOptions", "[", 
      RowBox[{
       RowBox[{"CreatePalette", "[", 
        RowBox[{"MyMagnificationSlider", "[", 
         RowBox[{"EvaluationNotebook", "[", "]"}], "]"}], "]"}], ",", " ", 
       "\n", "    ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Magnification", " ", "->", " ", "0.5"}], ",", " ", 
         RowBox[{"WindowTitle", " ", "->", " ", "\"\<Magnification\>\""}]}], 
        "}"}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"MyMagnificationSliderPalette", "[", "]"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Finished initialization.\>\"", "]"}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{{3.6163006695988293`*^9, 3.616300744364437*^9}, {
  3.616300785381003*^9, 3.6163007924118357`*^9}, {3.61630101511775*^9, 
  3.616301026654961*^9}}],

Cell[BoxData["\<\"Finished initialization.\"\>"], "Print",
 CellChangeTimes->{{3.616301040622382*^9, 3.6163010535808764`*^9}, 
   3.6163014019137363`*^9, {3.6163025918481407`*^9, 3.616302635323373*^9}, 
   3.616302672033168*^9, 3.616302758787174*^9, 3.616304389587598*^9, 
   3.6163044965722523`*^9, 3.6163045481856327`*^9, 3.616369210587236*^9, 
   3.6163767612660503`*^9, 3.6163768517515297`*^9, 3.616376892463385*^9, 
   3.61637695763673*^9, 3.616377553431964*^9, 3.6163785263799686`*^9, 
   3.6163787253045797`*^9, 3.616380165913005*^9, 3.61638031625556*^9, 
   3.6163875804320374`*^9, 3.616768024099859*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyMagnificationSliderPalette", "[", "]"}], ";"}]], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Instructions (for everyone)", "Subsection",
 CellChangeTimes->{{3.6161585256624937`*^9, 3.616158543687723*^9}, {
  3.616301810685342*^9, 3.6163018126845207`*^9}}],

Cell[TextData[{
 StyleBox["The presentation begins on the next slide.",
  FontWeight->"Bold"],
 " Try viewing it, and come back here and read the troubleshooting tip below \
if something doesn\[CloseCurlyQuote]t seem to work as expected."
}], "Text",
 CellChangeTimes->{{3.616302013239512*^9, 3.616302056652891*^9}, {
  3.616302155055112*^9, 3.616302178217917*^9}}],

Cell[CellGroupData[{

Cell["Troubleshooting tip", "Subsubsection",
 CellChangeTimes->{{3.616302137905238*^9, 3.6163021409543943`*^9}}],

Cell[TextData[{
 "In order for the presentation to be viewed correctly, the initialization \
code blocks must to be evaluated. This should happen either automatically \
when you first open the notebook, or (depending on your security settings) \
after you specifically approve for initialization cells to be evaluated when \
prompted by ",
 StyleBox["Mathematica ",
  FontSlant->"Italic"],
 "upon opening the notebook. The code block below prints out a test message \
to illustrate that initialization has occurred. If you don\[CloseCurlyQuote]t \
see the blue test message below, select the operation \
\[OpenCurlyDoubleQuote]Evaluation \[Rule] Evaluate Initialization Cells\
\[CloseCurlyDoubleQuote] in the menu bar."
}], "Text",
 CellChangeTimes->{{3.61630108821593*^9, 3.616301135831624*^9}, {
   3.616301266410385*^9, 3.616301476939513*^9}, {3.616301594605194*^9, 
   3.61630174128364*^9}, 3.616302069191216*^9, {3.616302300108466*^9, 
   3.616302304658537*^9}, {3.616369227349753*^9, 3.61636922925666*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Sample", " ", "initialization", " ", 
    RowBox[{"block", " ", "--"}], " ", "prints", " ", "out", " ", "a", " ", 
    "test", " ", "message", " ", "in", " ", "blue", " ", "when", " ", 
    "evaluated"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<This text is blue. Proceed to the presentation!\>\"", ",", "Blue"}],
      "]"}], "]"}], ";"}]}]], "Code",
 CellChangeTimes->{{3.616301150207962*^9, 3.616301243572803*^9}, {
  3.616301455640161*^9, 3.6163015404010677`*^9}, {3.616301836611313*^9, 
  3.616301843962034*^9}}],

Cell[BoxData[
 StyleBox["\<\"This text is blue. Proceed to the presentation!\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{{3.616301840862096*^9, 3.616301844531343*^9}, {
   3.616302591902707*^9, 3.616302635370595*^9}, 3.616302672087452*^9, 
   3.616302758844656*^9, 3.616304389635338*^9, 3.616304496641193*^9, 
   3.616304548234261*^9, 3.616369210645235*^9, 3.6163767612996883`*^9, 
   3.616376851810165*^9, 3.616376892501343*^9, 3.616376957682241*^9, 
   3.616377553507373*^9, 3.616378526442789*^9, 3.616378725406547*^9, 
   3.6163801659928017`*^9, 3.6163803163209877`*^9, 3.616387580497097*^9, 
   3.616768024143188*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["\<\
The combinatorics of fully packed loops and Razumov-Stroganov conjectures\
\>", "Section",
 CellChangeTimes->{3.615751896773769*^9}],

Cell[TextData[{
 StyleBox["Dan Romik\nUniversity of California, Davis\n", "Subtitle"],
 "\n",
 StyleBox["MAA MathFest\nAugust 8 2014", "Subtitle"]
}], "Text",
 Editable->False,
 CellChangeTimes->{{3.61575190911793*^9, 3.615751922741138*^9}, {
  3.615757416145067*^9, 3.615757416519867*^9}, {3.61575745723348*^9, 
  3.6157574591846046`*^9}, {3.615758114686956*^9, 3.615758115536666*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"Refresh", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"DateString", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Hour12\>\"", ",", "\"\<:\>\"", ",", "\"\<Minute\>\"", ",", 
         "\"\<:\>\"", ",", "\"\<Second\>\"", ",", " ", "\"\< \>\"", ",", 
         "\"\<AMPM\>\""}], "}"}], "]"}], ",", "40"}], "]"}], ",", 
    RowBox[{"UpdateInterval", "\[Rule]", "1"}]}], "]"}], "]"}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.616036404554472*^9, 3.616036457058786*^9}}],

Cell[BoxData[
 DynamicBox[ToBoxes[
   Refresh[
    Style[
     DateString[{"Hour12", ":", "Minute", ":", "Second", " ", "AMPM"}], 40], 
    UpdateInterval -> 1], StandardForm],
  ImageSizeCache->{216., {1., 21.}}]], "Output",
 CellChangeTimes->{3.616036484355774*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Style", "[", 
  RowBox[{
   RowBox[{"FunAnimation", "[", "]"}], ",", 
   RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}]], "Input",
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{{3.61586217284888*^9, 3.615862176796953*^9}, {
   3.615862537006013*^9, 3.615862542579977*^9}, {3.615863259277628*^9, 
   3.615863288576713*^9}, {3.615863433219586*^9, 3.61586343345508*^9}, {
   3.61586359936053*^9, 3.615863599870082*^9}, 3.615896988220358*^9, {
   3.616037320591044*^9, 3.6160373372914057`*^9}, {3.6160374186285563`*^9, 
   3.616037419837955*^9}, {3.616299994869385*^9, 3.616299998281301*^9}}],

Cell[BoxData[
 StyleBox[
  DynamicModuleBox[{$CellContext`matching$$ = {2, 1, 4, 3, 6, 5, 8, 7, 10, 9, 
   14, 13, 12, 11, 16, 15}, $CellContext`ops$$ = {15, 1, 12, 12, 9, 1, 11, 2, 
   8, 12, 5, 13}, $CellContext`counter$$ = 12, $CellContext`a$$ = 
   15, $CellContext`b$$ = 16, $CellContext`c$$ = 16, $CellContext`d$$ = 15}, 
   DynamicBox[ToBoxes[
     Refresh[
     If[$CellContext`counter$$ < 
        500 6, $CellContext`ops$$ = Insert[$CellContext`ops$$, 
           Random[Integer, {1, 2 8}], 1]; 
        If[Length[$CellContext`ops$$] > 200, $CellContext`ops$$ = 
          Most[$CellContext`ops$$]]; $CellContext`a$$ = 
         Part[$CellContext`ops$$, 1]; $CellContext`b$$ = 
         If[$CellContext`a$$ == 2 8, 1, $CellContext`a$$ + 
           1]; $CellContext`c$$ = 
         Part[$CellContext`matching$$, $CellContext`a$$]; $CellContext`d$$ = 
         Part[$CellContext`matching$$, $CellContext`b$$]; \
$CellContext`matching$$ = $CellContext`ApplyTLOperatorToNoncrossingMatching[
          2 8, 
           
           Part[$CellContext`ops$$, 
            1], $CellContext`matching$$]; $CellContext`counter$$ = \
$CellContext`counter$$ + 1; Null]; Row[{
         Graphics[
          Table[
           $CellContext`PipeOperatorGraphics[2 8, 
            
            Part[$CellContext`ops$$, $CellContext`j], $CellContext`j], \
{$CellContext`j, 1, 
            Min[20, 
             Length[$CellContext`ops$$]]}], ImageSize -> {400, 400}], 
         Graphics[{{White, 
            Circle[{0, 0}, 1.4]}, 
           Part[
            $CellContext`LinkPatternGraphicsCircular[
             $CellContext`NoncrossingMatchingToLinkPattern[$CellContext`\
matching$$], False], 1], 
           Table[{
             
             Switch[$CellContext`j, $CellContext`a$$, Red, $CellContext`b$$, 
              Red, $CellContext`c$$, Blue, $CellContext`d$$, Blue, 
              Blank[], Black], 
             $CellContext`stickfigure[
             1.2 Cos[2 Pi (($CellContext`j - 1)/(2 8)) + Pi], -0.1 + 
              1.2 Sin[2 Pi (($CellContext`j - 1)/(2 8)) + Pi], 
              Switch[$CellContext`j, $CellContext`a$$, 0.43, $CellContext`b$$,
                0.43, $CellContext`c$$, 0.43, $CellContext`d$$, 0.43, 
               Blank[], 0.4]]}, {$CellContext`j, 1, 2 8}]}, ImageSize -> 
          400]}], UpdateInterval -> 1/6, TrackedSymbols -> {}], StandardForm],
    
    ImageSizeCache->{656., {163., 165.}}],
   DynamicModuleValues:>{}],
  StripOnInput->False,
  TextAlignment->Center]], "Output",
 CellChangeTimes->{
  3.616300028476069*^9, 3.6163009561688423`*^9, {3.61630104076663*^9, 
   3.6163010536849194`*^9}, 3.616301402017304*^9, {3.616302497820817*^9, 
   3.616302520084598*^9}, {3.6163025919940777`*^9, 3.616302635457304*^9}, 
   3.6163026721754627`*^9, 3.616302758929015*^9, 3.616303416331959*^9, 
   3.616304389723383*^9, 3.616304496730872*^9, 3.61630454833853*^9, 
   3.6163692107297792`*^9, 3.616376761367693*^9, 3.616376851908703*^9, 
   3.616376892559009*^9, 3.616376957779779*^9, 3.6163775535444517`*^9, 
   3.616378526542275*^9, 3.616378725523712*^9, 3.616380166088695*^9, 
   3.6163803164269114`*^9, 3.616387580633731*^9, 3.616768024254594*^9}]
}, Open  ]],

Cell[TextData[{
 "Download this ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " notebook at ",
 ButtonBox["https://www.math.ucdavis.edu/~romik/data/uploads/talks/fpl.nb\n",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.math.ucdavis.edu/~romik/data/uploads/talks/fpl.nb"], 
    None},
  ButtonNote->"https://www.math.ucdavis.edu/~romik/data/uploads/talks/fpl.nb"],
 "PDF version at ",
 ButtonBox["https://www.math.ucdavis.edu/~romik/data/uploads/talks/fpl.pdf",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.math.ucdavis.edu/~romik/data/uploads/talks/fpl.pdf"], 
    None},
  ButtonNote->"https://www.math.ucdavis.edu/~romik/data/uploads/talks/fpl.pdf"]
}], "Text",
 CellChangeTimes->{{3.6161095433270407`*^9, 3.616109610524205*^9}, {
  3.6163770882219963`*^9, 3.616377147462778*^9}, {3.616377558437162*^9, 
  3.616377558662154*^9}, {3.61637860289884*^9, 3.6163786456451683`*^9}, {
  3.616378752115481*^9, 3.616378773599718*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Noncrossing matchings", "Section",
 CellChangeTimes->{{3.615752559492584*^9, 3.6157525941603403`*^9}}],

Cell["\<\
This talk will feature several families of combinatorial objects; some \
well-known, others less so. Let\[CloseCurlyQuote]s start with the most \
well-known one.\
\>", "Text",
 CellChangeTimes->{{3.615757438284124*^9, 3.6157574475455303`*^9}, {
  3.615757579536868*^9, 3.61575775560317*^9}, {3.615773353701538*^9, 
  3.615773354212172*^9}, {3.6157749866620398`*^9, 3.615774995626871*^9}, {
  3.615775032263406*^9, 3.6157750689885798`*^9}, {3.615811352180232*^9, 
  3.6158113523794937`*^9}}],

Cell[TextData[{
 "A ",
 StyleBox["noncrossing matching",
  FontWeight->"Bold"],
 " is, informally, a \[OpenCurlyDoubleQuote]handshaking pattern,\
\[CloseCurlyDoubleQuote] that is, a way for an even number of people sitting \
around a table to pair off into pairs, with each pair shaking hands across \
the table, so that their arms don\[CloseCurlyQuote]t have to cross over or \
under each other.  "
}], "Text",
 CellChangeTimes->{{3.615775044422974*^9, 3.615775072563491*^9}}],

Cell[CellGroupData[{

Cell["An example", "Subsection",
 CellChangeTimes->{{3.615992130721416*^9, 3.6159921319338512`*^9}}],

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"NoncrossingMatchingGraphicsCircular", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "2", ",", "1", ",", "8", ",", "5", ",", "4", ",", "7", ",", "6", ",",
           "3"}], "}"}], ",", "False"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}], "/", "7"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"stickfigure", "[", 
            RowBox[{
             RowBox[{"1.25", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "Pi", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}], "/", "8"}]}], "]"}]}], ",", 
             
             RowBox[{
              RowBox[{"-", "0.03"}], "+", 
              RowBox[{"1.25", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", "Pi", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"j", "-", "1"}], ")"}], "/", "8"}]}], "]"}]}]}], 
             ",", "0.5"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Alice\>\"", ",", "\"\<Bob\>\"", ",", "\"\<Cindy\>\"", 
                  ",", "\"\<Dan\>\"", ",", "\"\<Emily\>\"", ",", 
                  "\"\<Fred\>\"", ",", "\"\<Gina\>\"", ",", "\"\<Harry\>\""}],
                  "}"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "16"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1.25", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "Pi", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "/", "8"}]}], "]"}]}], 
               ",", 
               RowBox[{
                RowBox[{"-", "0.15"}], "+", 
                RowBox[{"1.25", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", "Pi", 
                   RowBox[{
                    RowBox[{"(", " ", 
                    RowBox[{"j", "-", "1"}], ")"}], "/", "8"}]}], "]"}]}]}]}],
               "}"}]}], "]"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "8"}], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.6157734742028017`*^9, {3.615773549383027*^9, 3.61577355676505*^9}, {
   3.6157748717505713`*^9, 3.615774900590519*^9}, {3.61589707605691*^9, 
   3.615897076974231*^9}, {3.616093660916875*^9, 3.6160936669097767`*^9}, {
   3.616375296177909*^9, 3.616375297210231*^9}}],

Cell[TextData[{
 "Typically we\[CloseCurlyQuote]ll forget about the people and their social \
interactions and talk about a \[OpenCurlyDoubleQuote]noncrossing matching of \
order ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]]],
 Cell[BoxData[
  FormBox[Cell[""], TraditionalForm]]],
 "\[CloseCurlyDoubleQuote], meaning a matching of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "n"}], TraditionalForm]]],
 " abstract objects, or points, arranged around a circle:"
}], "Text",
 CellChangeTimes->{{3.6157736532571363`*^9, 3.6157737529212017`*^9}, {
  3.615774199882784*^9, 3.615774208497251*^9}, {3.61577524898254*^9, 
  3.615775278243669*^9}, {3.615811211702129*^9, 3.615811238676907*^9}, {
  3.616375273224352*^9, 3.616375291798854*^9}}],

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NoncrossingMatchingGraphicsCircular", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "2", ",", "1", ",", "8", ",", "5", ",", "4", ",", "7", ",", "6", ",", 
        "3"}], "}"}], ",", "True"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "450"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.616093598787093*^9, 3.616093624972134*^9}}],

Cell[TextData[{
 "We can decide to cut the circle open at an arbitrary place, to get a \
matching of points arranged on a ",
 StyleBox["line",
  FontSlant->"Italic"],
 ", giving a slightly different (but equivalent) graphical representation of \
the matching:"
}], "Text",
 CellChangeTimes->{{3.615775307422367*^9, 3.615775375508246*^9}}],

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NoncrossingMatchingGraphicsLinear", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "2", ",", "1", ",", "8", ",", "5", ",", "4", ",", "7", ",", "6", ",", 
        "3"}], "}"}], ",", "True"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "450"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6157753575588303`*^9, 3.615775360861944*^9}, {
  3.616093643113412*^9, 3.6160936497475643`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Enumeration of noncrossing matchings", "Subsection",
 CellChangeTimes->{{3.615992154635387*^9, 3.615992158534567*^9}}],

Cell[TextData[{
 "How many noncrossing matchings are there for a given order ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]]],
 "? Let\[CloseCurlyQuote]s investigate:"
}], "Text",
 CellChangeTimes->{{3.615775418892785*^9, 3.615775440659317*^9}}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"NoncrossingMatchings", "[", "n", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "9"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615775404069962*^9, 3.615775414397361*^9}, {
  3.615775575151038*^9, 3.615775576355205*^9}, {3.6158971645296183`*^9, 
  3.6158971647472267`*^9}}],

Cell["\<\
Hmm. These numbers look familiar... Maybe the internet can help?\
\>", "Text",
 CellChangeTimes->{{3.615775450830011*^9, 3.615775472034999*^9}, {
  3.61577569751521*^9, 3.6157757004776287`*^9}, {3.615775760104287*^9, 
  3.615775799393093*^9}, {3.6158126953118973`*^9, 3.615812695897876*^9}, {
  3.61586387449911*^9, 3.615863875836773*^9}, {3.6160930446598473`*^9, 
  3.616093102147593*^9}}],

Cell[BoxData[
 RowBox[{"OnlineEncyclopediaOfIntegerSequencesLookup", "[", "%", 
  "]"}]], "Input",
 CellChangeTimes->{{3.616093050202318*^9, 3.616093055125431*^9}, {
  3.616093140486866*^9, 3.616093150730213*^9}}],

Cell[TextData[{
 "Indeed, these are the famous ",
 StyleBox["Catalan numbers",
  FontWeight->"Bold"],
 ":"
}], "Text",
 CellChangeTimes->{{3.6160932045000887`*^9, 3.6160932140127907`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"catalan", "[", "n_", "]"}], " ", ":=", " ", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"n", "+", "1"}]], 
     FormBox[
      TemplateBox[{RowBox[{"2", " ", "n"}],"n"},
       "Binomial"],
      TraditionalForm]}]}], ";"}], " "}], "\n", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"catalan", "[", "n", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"n", ",", " ", "1", ",", " ", "9"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6157754751126633`*^9, 3.615775477183741*^9}, {
  3.615775523999488*^9, 3.6157755461256123`*^9}, {3.6157757083048067`*^9, 
  3.615775708616315*^9}, {3.615811721979062*^9, 3.615811769640293*^9}, {
  3.6160047523123503`*^9, 3.6160047524494667`*^9}}],

Cell[TextData[{
 StyleBox[" ",
  FontWeight->"Bold"],
 "The enumeration of noncrossing matchings is one of several hundred \
interpretations (to be listed in a forthcoming book by Richard P. Stanley) of \
these magical numbers."
}], "Text",
 CellChangeTimes->{{3.61577559521286*^9, 3.615775688027541*^9}, {
   3.6158638797050257`*^9, 3.615863880922296*^9}, 3.6160932207506123`*^9}]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Fully Packed Loop arrangements", "Section",
 CellChangeTimes->{{3.615757290048018*^9, 3.615757293466424*^9}, {
  3.615775175454126*^9, 3.615775181065885*^9}}],

Cell[TextData[{
 "A ",
 StyleBox["Fully Packed Loop (FPL) ",
  FontWeight->"Bold"],
 "arrangement of order ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]]],
 " is a certain arrangement of paths and loops on an ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}], "\[Times]", 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}]}], TraditionalForm]]],
 " square lattice to which are added \[OpenCurlyDoubleQuote]stubs\
\[CloseCurlyDoubleQuote] which are ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "n"}], TraditionalForm]]],
 " alternating edges around the boundary of the square. \
Here\[CloseCurlyQuote]s an example:"
}], "Text",
 CellChangeTimes->{{3.615990768215541*^9, 3.615990868329864*^9}, {
  3.615990901780324*^9, 3.6159909908203487`*^9}, {3.616029180342394*^9, 
  3.616029200642755*^9}, {3.616029745345351*^9, 3.616029745345399*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fpl", "=", 
   RowBox[{"RandomFPL", "[", "8", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{"FPLgraphics", "[", "fpl", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615990809203951*^9, 3.615990826429391*^9}, {
  3.616079068149292*^9, 3.616079074970017*^9}}],

Cell[TextData[{
 "Given an FPL arrangement, we can associate with it in an obvious way a \
noncrossing matching of order ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", Cell[""]}], TraditionalForm]]],
 " called its ",
 StyleBox["connectivity pattern:",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6159909683577137`*^9, 3.615990968841588*^9}, {
  3.6159909996077747`*^9, 3.61599104132128*^9}}],

Cell[BoxData[
 RowBox[{"NoncrossingMatchingGraphicsCircular", "[", 
  RowBox[{
   RowBox[{"FPLmatching", "[", "fpl", "]"}], ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.616093719183868*^9, 3.616093726737829*^9}}],

Cell[CellGroupData[{

Cell["Enumeration of Fully Packed Loop arrangements", "Subsection",
 CellChangeTimes->{{3.6159914678585567`*^9, 3.6159915033567743`*^9}, {
  3.61599231173814*^9, 3.615992329614798*^9}, {3.616036610437187*^9, 
  3.616036612285975*^9}}],

Cell[TextData[{
 "How many FPL arrangements are there for a given order ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]]],
 "? Let\[CloseCurlyQuote]s investigate."
}], "Text",
 CellChangeTimes->{{3.615991063484782*^9, 3.615991076269492*^9}}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"AllFPLs", "[", "n", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615991084976454*^9, 3.615991096370936*^9}, {
  3.616107650329151*^9, 3.6161076505302143`*^9}}],

Cell[BoxData[
 RowBox[{"OnlineEncyclopediaOfIntegerSequencesLookup", "[", "%", 
  "]"}]], "Input"],

Cell[TextData[{
 "A formula for this sequence of numbers was guessed by Mills, Robbins and \
Rumsey in the early 1980s:\n           \n             ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["FPL", "n"], " ", "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"1", "!"}], "\[CenterDot]", 
       RowBox[{"4", "!"}], "\[CenterDot]", 
       RowBox[{"7", "!"}], "\[CenterDot]", "\[CenterDot]", "\[CenterDot]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "n"}], "-", "2"}], ")"}], "!"}]}], 
      RowBox[{
       RowBox[{"n", "!"}], "\[CenterDot]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}], "!"}], "\[CenterDot]", 
       "\[CenterDot]", "\[CenterDot]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "n"}], ")"}], "!"}]}]], "=", " ", 
     RowBox[{
      UnderoverscriptBox["\[Product]", 
       RowBox[{"j", "=", "0"}], 
       RowBox[{"n", "-", "1"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "j"}], "+", "1"}], ")"}], "!"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "j"}], ")"}], "!"}]]}]}]}], TraditionalForm]]],
 "\n             \n This was proved in 1994 by Doron Zeilberger, and later by \
Greg Kuperberg and others."
}], "Text",
 CellChangeTimes->{{3.6159911031106043`*^9, 3.615991151908557*^9}, {
  3.6159912196506987`*^9, 3.615991220287919*^9}, {3.6159912623901587`*^9, 
  3.615991263051332*^9}, {3.6160292255949802`*^9, 3.616029251506238*^9}, {
  3.6160292826326933`*^9, 3.616029412360567*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"numfpls", "[", "n_", "]"}], ":=", 
   RowBox[{"Product", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", "j"}], "+", "1"}], ")"}], "!"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "+", "j"}], ")"}], "!"}]], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"numfpls", "[", "n", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "8"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6157582079093647`*^9, 3.615758267337449*^9}, {
  3.6159911644129877`*^9, 3.6159911942263393`*^9}, {3.616377582289365*^9, 
  3.616377589615741*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["A story for another day", "Subsection",
 CellChangeTimes->{{3.615992337751905*^9, 3.6159923403017817`*^9}, {
   3.616028872376268*^9, 3.6160289156144457`*^9}, {3.616029466512312*^9, 
   3.616029473274425*^9}, {3.616030093490333*^9, 3.616030094213674*^9}, 
   3.616036622835823*^9}],

Cell["\<\
FPL arrangements are in (fairly simple) bijective correspondences with \
several other classes of combinatorial objects:\
\>", "Text",
 CellChangeTimes->{{3.615991273540358*^9, 3.615991326977871*^9}, {
  3.61599146048101*^9, 3.615991466832223*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Alternating sign matrices (ASMs)",
 FontWeight->"Bold"]], "Item",
 CellChangeTimes->{{3.6159913393031387`*^9, 3.6159913450054703`*^9}, {
  3.616109286152875*^9, 3.6161092875776367`*^9}}],

Cell[TextData[{
 StyleBox["Square ice configurations ",
  FontWeight->"Bold"],
 "with \[OpenCurlyDoubleQuote]domain wall\[CloseCurlyDoubleQuote] boundary \
conditions"
}], "Item",
 CellChangeTimes->{{3.615991346428321*^9, 3.615991356330563*^9}}],

Cell[TextData[{
 StyleBox["3-colorings of a square lattice ",
  FontWeight->"Bold"],
 "with certain boundary conditions"
}], "Item",
 CellChangeTimes->{{3.615991356991198*^9, 3.615991378118849*^9}}],

Cell[TextData[StyleBox["Complete monotone triangles",
 FontWeight->"Bold"]], "Item",
 CellChangeTimes->{{3.615991386654125*^9, 3.6159913909795103`*^9}}]
}, Open  ]],

Cell["\<\
They are also equinumerous with (but not known to be in natural bijection \
with):\
\>", "Text",
 CellChangeTimes->{{3.615991394003475*^9, 3.615991431180113*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Totally symmetric self complementary plane partitions",
 FontWeight->"Bold"]], "Item",
 CellChangeTimes->{{3.615991445942986*^9, 3.615991454095583*^9}}],

Cell[TextData[StyleBox["Descending plane partitions",
 FontWeight->"Bold"]], "Item",
 CellChangeTimes->{{3.615991454718237*^9, 3.6159914575835*^9}}]
}, Open  ]],

Cell["\<\
These bijections and the remarkable enumeration results mentioned above are \
described in several readable accounts:\
\>", "Text",
 CellChangeTimes->{{3.615991558408778*^9, 3.615991574112853*^9}, {
   3.6159916202478647`*^9, 3.6159916264471483`*^9}, 3.6159919617174397`*^9, {
   3.615992363089407*^9, 3.6159923836040897`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "\[OpenCurlyDoubleQuote]The story of 1, 2, 42, 429, 7436, ...\
\[CloseCurlyDoubleQuote] by David P. Robbins ",
 StyleBox["(Mathematical Intelligencer 1991)",
  FontSlant->"Italic"]
}], "Item",
 CellChangeTimes->{{3.6159916346474447`*^9, 3.615991657637405*^9}}],

Cell[TextData[{
 "\[OpenCurlyDoubleQuote]The many faces of alternating sign matrices\
\[CloseCurlyDoubleQuote] by James Propp ",
 StyleBox["(Discrete Mathematics and Theoretical Computer Science,",
  FontSlant->"Italic"],
 " 2001)"
}], "Item",
 CellChangeTimes->{{3.615991684811674*^9, 3.615991699049024*^9}, {
  3.615991877278767*^9, 3.61599190023074*^9}}],

Cell["\<\
\[OpenCurlyDoubleQuote]Proofs and Confirmations: The Story of the Alternating \
Sign Matrix Conjecture\[CloseCurlyDoubleQuote] by David Bressoud \
(Mathematical Association of America, 1991)\
\>", "Item",
 CellChangeTimes->{{3.615991901328397*^9, 3.615991959567396*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["The rotational symmetry of FPLs", "Subsection",
 CellChangeTimes->{{3.616029659091886*^9, 3.616029659641111*^9}, {
  3.6160296985800743`*^9, 3.616029702429645*^9}}],

Cell[TextData[{
 "The set of noncrossing matchings of order ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]]],
 " has an obvious rotational symmetry -- matchings can be rotated by an angle \
",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Pi]", " ", 
    RowBox[{"j", "/", 
     RowBox[{"(", 
      RowBox[{"2", "n"}], ")"}]}]}], TraditionalForm]]],
 " for integer ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]]],
 ". The square lattice has no such obvious rotational symmetry, but it turns \
out FPLs do have a natural operation whose effect is to rotate the associated \
connectivity pattern. This operation, discovered by Ben Wieland in 2001, is \
called ",
 StyleBox["Wieland gyration",
  FontWeight->"Bold"],
 ". Let\[CloseCurlyQuote]s see how it works."
}], "Text",
 CellChangeTimes->{{3.616029803964587*^9, 3.616030025150482*^9}, {
  3.6160300588003407`*^9, 3.616030068575572*^9}, {3.616037632222211*^9, 
  3.616037638233939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreatePalette", "[", 
   RowBox[{
    RowBox[{"FPLsInteractiveDemo", "[", "]"}], ",", 
    RowBox[{"WindowTitle", "\[Rule]", "\"\<Fully Packed Loops\>\""}]}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.6160300413325167`*^9, 3.6160300420462523`*^9}, {
  3.6161221145273857`*^9, 3.616122146264653*^9}}]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Loop percolation", "Section",
 CellChangeTimes->{{3.615757334081087*^9, 3.615757378856304*^9}, {
  3.615812799250113*^9, 3.615812801275299*^9}}],

Cell[TextData[{
 StyleBox["Loop percolation",
  FontWeight->"Bold"],
 " (a.k.a. the \[OpenCurlyDoubleQuote]",
 StyleBox["dense ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", "1", ")"}], TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox[" loop model",
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote]) is another combinatorial structure that gives \
rise to a noncrossing matching.\nThe idea is to tile a planar region with the \
following two kinds of square tiles (known by the Frenchism \
\[OpenCurlyDoubleQuote]plaquettes\[CloseCurlyDoubleQuote]):"
}], "Text",
 CellChangeTimes->{{3.6158127746404467`*^9, 3.6158129051402483`*^9}, {
  3.6158129578039913`*^9, 3.6158129751668673`*^9}, {3.61581301870706*^9, 
  3.615813020868064*^9}, {3.61581322416039*^9, 3.615813240822809*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"plaquette", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
    RowBox[{"plaquette", "[", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.615812909676403*^9, 3.61581294067946*^9}}],

Cell[BoxData[
 GraphicsBox[{{
    {GrayLevel[1], EdgeForm[RGBColor[0.7, 0.7, 0.7]], RectangleBox[{0, 0}]}, 
    {GrayLevel[0], AbsoluteThickness[2], 
     CircleBox[{1, 0}, NCache[Rational[1, 2], 0.5], 
      NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
       3.141592653589793}]], 
     CircleBox[{0, 1}, NCache[Rational[1, 2], 0.5], 
      NCache[{Rational[3, 2] Pi, 2 Pi}, {4.71238898038469, 
       6.283185307179586}]]}}, {
    {GrayLevel[1], EdgeForm[RGBColor[0.7, 0.7, 0.7]], RectangleBox[{2, 0}]}, 
    {GrayLevel[0], AbsoluteThickness[2], 
     CircleBox[{2, 0}, NCache[Rational[1, 2], 0.5], 
      NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], 
     CircleBox[{3, 1}, NCache[Rational[1, 2], 0.5], 
      NCache[{Pi, Rational[3, 2] Pi}, {3.141592653589793, 
       4.71238898038469}]]}}}]], "Output",
 CellChangeTimes->{3.615813243161765*^9},
 ImageCache->GraphicsData["CompressedBitmap", "\<\
eJy1W81rFVcUn2RensUmtYlJU201L9GqMa2mtTZRq6amfqSl4DaGokEKsRha
kyDoxi8Qt2504yoqKqigopAouhb9C1woRBHRhUvBr9vzOzknjPa++zG2gi+P
O+f3MTN37tx77nm/9Y8M/DHYP7Jje39p41D/3wM7tg+XNvw1RE1pRZJULEyS
5M9SUqDvhr5mP/BvET7Cvn/Pf1Lz4MEDc/HiRfPs2bNkTNroO7fRMYmbCj9x
4gTkzK1bt6bC6Tu30TENr8KfpebKlSt0fNeuXXz84MGDyRK0/Y6jS+QotfJR
ipo8WsxQ0HFqMfIv+Vrazp49yxgwfGOJ67O0tWXagCUOK7bgl7927RpTnD59
OlqeMIwljrzyt2/fZoqjR49GyxOGscSRVx49BhR79+6NlicMY9Gzcsq/evXK
pGlqtmzZEi1PGMYSR6y8hjc1NZnOzs53LIXKAwd8li9Svqenx9TU1Ji3b98G
yy+WNsIwljjoScslv3v3br5/9+/fj5YnDGOJI6/8uXPnmOLMmTPR8oRhLHHk
lX/06BFT7Ny5M1qeMIwljlh5DW9ubjZtbZOdqc0S55IHDvgsX6T8wMAAn8HE
xESwfKu0EYaxxJEszSd/6dIlpjh27Fi0PGEYSxx55V+8eMEPT1dXV7Q8YRhL
HLHyGt7X12cqKyu5+yy2xNnkF0kbui2wxJG055MfGxvjC3jo0KFoecIwljjy
yRfMmzdvTKlU4sHz9evXrZZQm4OFAscrA1BQEFWkCQ0/cuQIn8fJkyeTOAcp
MIwljuTbPPIF8/z5c1NdXW1aW1sxki+yhNocLBA4Bn9AQUFUkSY0fGRkhM/j
/PnzSZyDFBjGEkfyXR75gnn69CmfQHt7O27kQkuozcFXAkc3AhQURBVpQsP3
7dvH53H8+PEkzkEKDGOJI1mWR77AA1FLS4upra3FSSywhNoczM9cQkBBQVSR
JjT86tWrfB7btm1L4hykwDCWOKaWFYHyGr5582ZTUVFhbty4MXVpffLzpO36
9euMJY5keR75gnn48KGpq6szjY2N5smTJ/MtoTYHLQInCENBQVSRJpZLwOXL
l/kydnd3o2PPs4TaTDQLHM8CoKAgqh/iTGj40NAQMxw4cCCJc5ACw1jiSDry
yBfMy5cvTUdHB99Pmt+1BDooCRxTQkBBQVSRJjok4PHjxzy1KhaL6FzNllCb
iSaBoz8CCgqi6owz0SkB9+7dMw0NDTy03blzpxRoYq7ACcJQUBDVijgTKyTg
7t27zFJfXw/GpkATczImAAUFUa2MM7FSAm7evMkM+E/Xdm6giS8ztwNQzNeI
alWciVWZK4FriRtLvWxOoIkvBI6OCSgoiOrHOBOT4VXcJ9Cr0MXxsNEjLwp+
J7OEA8MEsOAAF3Emq+PsrBYqPCd40nTQomEwmR1o53PhwNCpoxa4iDNZE2dn
jVBh7BgeHmYqjMZ4l8wKtNMoHOgswIIDXMSZrI2z0yVUGM7xQsCF3rp1K97T
IuO30yAceLcDCw5wEWfyU5ydyfAiv+LwlsWZYbqAFRT1hYZARzOFBt0HUFCA
CpREvS7OVLewYdaBeQuYMI/DjJLmtTMDTdUKDabCgIICVKAk6p/jTE2GT+P5
GKaEGDTAhkk2pvu0ThFFv7MZwkUYxoIDXOAENxaO6+PsbRBK9AnM2tUe1kFY
kWEhOSPQXo1wYSEJLDjUHrjRVzfG2dvEnx/xqgYLKyzNQIl1KpbL6DQTExPV
gQ6nCx3yDICCAlSgBDUkSKonzuQvEoAOgxUwFuH0XmBaAiCngrQORmskt5CT
mxZouEo+QQ0sOMBFnMkkf4FfQZCENMX96jFfyQn4ohkdHeUEObLUSBUjX0sr
4E0CQH9FLgXpHBrRUxabzmLIT/b29nKWFoniU6dOsRoMHD58GPsCfXK5sUWA
JhxCCEIBARQUoCLKVE4Frw4IQpgM6N3Hwhz2YBN2YRv2BwcH0V717q3Zs2eP
0e2OAn8WOZuL7oi8KJKTyBBSN53sjUXusWjCIYQglCBFRqe8yaGXsldULly4
8D+qpNlTms6XDdsn4+PjfBmxO6CXEcnq/+Qy9kkYQtD0YR0EtrSDwC5sw750
kPfuWbazFiP7PL08bH3e9jj1iHe8bz7gSXWMBR/LRcwxwtgMbxS6HOOfw+Qn
/Bk/UNscrheu2BeIw96nQhn7mrPZ6xau2Nevw14df0bND2zO1glNxGzFYape
2NCzkT0KmEnZTHUJzfvzOlCWmdc5TH3Gn5MTTqRzfBNOm6O1wpGd+IKr3MTX
YUdXBzSFD5qO2+zoKgXLAs1quJYFDju6dgpdrNjs6BoudNHksDNbqEKXcjY7
q4QjdEnpsKML7YA1rs2JLvMDVtgOE5pywItLkwVlVvs2E5rwCMg1OExkky+e
vIfNhKZ+ArIuDhNNGROeDJDNhCbBAvJPDhOakAvIhdlMaDowIBPnMKGZ0YCs
oM2E5mUDcpIOExq+f/9+HcasydHyDtKprEa5pKxXPig7bHOgCfKA3LTDxDwJ
CMiT20wsE3hAlt5hQsN92wXlHfi3KRzyGo50jmuzxCavG1W+TRqvfNBukc2B
7tcF7FU5TGi47t6X2zQr78C/WeeVD9o1tDnQfduAPUuHCQ33bZ6Wd+DftPXK
B+0e2xzo/n3A3rXDhIb7NtHLO/Bv3nvlC7xq0SoCOglbFYHNwRKBB9QwOExo
uK+YorwDfxFHgLyvlMQl7ythcchruK+QxiavxVu+Ap4AeV8ZkUveV74UIO8r
onLJ+4q3HPIa7ishc8n7StcC5H0FdDZ5LdLzFe4FyPvKB13yvrLFAHlf8aRL
3le0GSDvKx11yftKVgNqfn2Fsy55X8FugDwS2q6yYVfNr5YrE0feimdf0bRL
3lesHSDvKxl3yftK1QPkkSJ3Fcy75H2F+gHyaHP9XMAl7/uZQoC8vrNHR0ej
5ZHnB3Z8fDyvfPanHbHy2Z+K+OT1pyK42eju0Pv3T0XAiKMU9c5PRZgv4rcv
2e9JxT9MKt2a\
\>"]]
}, Open  ]],

Cell["\<\
Putting together many of these plaquettes produces a collection of loops and \
paths (reminiscent of Fully Packed Loops, but not quite the same):\
\>", "Text",
 CellChangeTimes->{{3.615813049457266*^9, 3.6158130703690023`*^9}, {
  3.615813144408382*^9, 3.61581315917089*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myplaquettes", "=", 
   RowBox[{"randombits", "[", 
    RowBox[{"10", ",", "10"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{"plaquettes", "[", "myplaquettes", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615813073372222*^9, 3.615813115683172*^9}, {
  3.615813369439529*^9, 3.615813395476272*^9}, {3.615813871013302*^9, 
  3.61581388981479*^9}}],

Cell[TextData[{
 "(Connoisseurs of percolation theory will recognize that this is a disguised \
version of ",
 StyleBox["critical bond percolation on the square lattice.",
  FontWeight->"Bold"],
 ")"
}], "Text",
 CellChangeTimes->{{3.615813168832477*^9, 3.6158132054702187`*^9}, {
  3.6158132790866833`*^9, 3.6158132852991447`*^9}, {3.616029503350727*^9, 
  3.616029508300252*^9}}],

Cell[CellGroupData[{

Cell["The connectivity pattern of loop percolation", "Subsection",
 CellChangeTimes->{{3.616030262330431*^9, 3.616030267067746*^9}}],

Cell[TextData[{
 "What we\[CloseCurlyQuote]ll do is to consider this as an arrangement of \
plaquettes on a ",
 StyleBox["cylinder",
  FontSlant->"Italic"],
 ", by identifying the left and right boundary edges of the big square. The \
paths then connect boundary points on the bottom and top edges (the \
\[OpenCurlyDoubleQuote]lids\[CloseCurlyDoubleQuote] of the cylinder) to each \
other in some complicated pattern."
}], "Text",
 CellChangeTimes->{{3.615813451853548*^9, 3.615813534929701*^9}, {
  3.615813731184786*^9, 3.6158137636474047`*^9}, {3.615814093867702*^9, 
  3.6158141000053062`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plaquettegr", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"plaquettes", "[", "myplaquettes", "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"plaquettesendpointpathgraphics", "[", 
          RowBox[{"myplaquettes", ",", "j", ",", 
           RowBox[{
            RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "/", "9"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{"plaquettegr", ",", " ", 
    RowBox[{"CylinderGraphics", "[", "plaquettegr", "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.615813790811614*^9, 3.615813835649951*^9}, {
  3.6158138815656443`*^9, 3.615813960167844*^9}, {3.615813994792067*^9, 
  3.6158140069669867`*^9}, {3.6163760755554037`*^9, 3.616376113718711*^9}, {
  3.616376144806348*^9, 3.6163761741844187`*^9}, {3.616376294284849*^9, 
  3.616376295758947*^9}, {3.616376799471755*^9, 3.616376800358835*^9}}],

Cell[TextData[{
 "We\[CloseCurlyQuote]re interested in the connectivity pattern that emerges \
between the ",
 StyleBox["bottom",
  FontSlant->"Italic"],
 " boundary endpoints. Imagine now the cylinder to be infinitely long, \
extending upwards all the way to infinity. The bottom boundary endpoints \
become more and more likely to be interconnected among themselves -- in other \
words to define a noncrossing matching."
}], "Text",
 CellChangeTimes->{{3.615814112218585*^9, 3.6158142062077703`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreatePalette", "[", 
   RowBox[{
    RowBox[{"LoopPercolationInteractiveDemo", "[", "]"}], ",", 
    RowBox[{"WindowTitle", "\[Rule]", "\"\<Loop Percolation\>\""}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6158133430569353`*^9, 3.615813344983412*^9}, 
   3.61581436157067*^9, {3.616122253116685*^9, 3.616122264988029*^9}, {
   3.616122324556143*^9, 3.616122348667326*^9}}],

Cell[TextData[{
 "Notice what happens in the randomized setting when the plaquette bias \
becomes very close to 0 or 1. In this case the model converges to a limiting \
process called ",
 StyleBox["pipe percolation",
  FontWeight->"Bold"],
 "."
}], "Text",
 CellChangeTimes->{{3.615815067028325*^9, 3.615815094602675*^9}, {
  3.615816357818598*^9, 3.615816446320304*^9}, {3.615816514834379*^9, 
  3.615816522096745*^9}}]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Pipe percolation", "Section",
 CellChangeTimes->{{3.615816487496725*^9, 3.615816501408824*^9}, {
  3.61581915049452*^9, 3.615819153305591*^9}}],

Cell[TextData[{
 "In ",
 StyleBox["pipe percolation ",
  FontWeight->"Bold"],
 StyleBox["(a.k.a. the ",
  FontWeight->"Plain"],
 StyleBox["Temperley-Lieb random walk",
  FontWeight->"Bold"],
 StyleBox[", ",
  FontWeight->"Plain"],
 StyleBox["Temperley-Lieb stochastic process",
  FontWeight->"Bold"],
 StyleBox["), we lay down a sequence of graphical ",
  FontWeight->"Plain"],
 StyleBox["pipe operators",
  FontWeight->"Bold"],
 " that act on noncrossing matchings."
}], "Text",
 CellChangeTimes->{{3.61581913776346*^9, 3.615819170056096*^9}, {
   3.615819201069344*^9, 3.615819206056829*^9}, 3.615852977208005*^9, {
   3.6160346633696547`*^9, 3.61603466462952*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
    RowBox[{"PipeOperatorGraphics", "[", 
     RowBox[{"10", ",", "3", ",", "0"}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6158207038596087`*^9, 3.615820720757662*^9}}],

Cell[BoxData[
 GraphicsBox[
  {AbsoluteThickness[2], 
   {GrayLevel[1], EdgeForm[GrayLevel[0.8]], 
    RectangleBox[NCache[{Rational[1, 2], 0.}, {0.5, 0.}], 
     NCache[{Rational[21, 2], 1.2}, {10.5, 1.2}]]}, 
   {GrayLevel[0], LineBox[{{1, 0.}, {1, 1.2}}], 
    LineBox[{{2, 0.}, {2, 1.2}}], {}, {}, LineBox[{{5, 0.}, {5, 1.2}}], 
    LineBox[{{6, 0.}, {6, 1.2}}], LineBox[{{7, 0.}, {7, 1.2}}], 
    LineBox[{{8, 0.}, {8, 1.2}}], LineBox[{{9, 0.}, {9, 1.2}}], 
    LineBox[{{10, 0.}, {10, 1.2}}], 
    CircleBox[NCache[{Rational[7, 2], 0.}, {3.5, 0.}], NCache[
     Rational[1, 2], 0.5], 
     NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
      3.141592653589793}]], 
    CircleBox[NCache[{Rational[7, 2], 1.2}, {3.5, 1.2}], NCache[
     Rational[1, 2], 0.5], 
     NCache[{Pi, Rational[3, 2] Pi}, {3.141592653589793, 4.71238898038469}]], 
    CircleBox[NCache[{Rational[7, 2], 0.}, {3.5, 0.}], NCache[
     Rational[1, 2], 0.5], 
     NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], 
    CircleBox[NCache[{Rational[7, 2], 1.2}, {3.5, 1.2}], NCache[
     Rational[1, 2], 0.5], 
     NCache[{Rational[3, 2] Pi, 2 Pi}, {4.71238898038469, 
      6.283185307179586}]]}}]], "Output",
 CellChangeTimes->{
  3.615819182661666*^9, {3.6158206956853952`*^9, 3.615820721087804*^9}, 
   3.615845130723531*^9}]
}, Open  ]],

Cell[TextData[{
 "In this representation, the ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]]],
 "th operator has the effect of matching points ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"j", "+", "1"}], TraditionalForm]]],
 ", and rerouting the point previously matched to ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]]],
 " to the point that was matched to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"j", "+", "1"}], TraditionalForm]]],
 ". For each operator, ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]]],
 " is chosen uniformly at random from the integers 1,...,",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "n"}], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.6160346699301577`*^9, 3.6160347334434633`*^9}, {
  3.616034770396096*^9, 3.616034794458041*^9}, {3.616375439915039*^9, 
  3.6163754402886868`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreatePalette", "[", 
   RowBox[{
    RowBox[{"PipePercolationInteractiveDemo", "[", "]"}], ",", 
    RowBox[{"WindowTitle", "\[Rule]", "\"\<Pipe Percolation\>\""}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6158261423271513`*^9, 3.615826146335888*^9}, {
  3.6161224320833483`*^9, 3.6161224440086412`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["All loops lead to Rome", "Section",
 CellChangeTimes->{{3.615816611124556*^9, 3.6158166671013937`*^9}, {
  3.6160330160557003`*^9, 3.616033019392242*^9}, {3.616033063093328*^9, 
  3.6160330645668077`*^9}, {3.6160334209897213`*^9, 3.616033423311108*^9}}],

Cell["\<\
We defined random noncrossing matchings obtained as the connectivity patterns \
of several different processes: Fully Packed Loop arrangements, loop \
percolation, and pipe percolation. There are several amazing connections \
between these different random objects.\
\>", "Text",
 CellChangeTimes->{{3.616032506219119*^9, 3.616032565482047*^9}, {
   3.616032672234613*^9, 3.616032677597212*^9}, {3.6160333475998783`*^9, 
   3.6160333715879793`*^9}, {3.616034577415496*^9, 3.616034599040433*^9}, 
   3.6160367514157343`*^9}],

Cell[CellGroupData[{

Cell[TextData[{
 "The connectivity pattern of loop percolation is independent of the \
plaquette bias ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "<", "p", "<", "1"}], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{{3.616032587320232*^9, 3.616032648761902*^9}, {
  3.6160326994646053`*^9, 3.616032700702894*^9}, {3.616033155408546*^9, 
  3.61603317428343*^9}, {3.616033301611356*^9, 3.6160333282620087`*^9}}],

Cell[CellGroupData[{

Cell["\<\
This property observed by Di Francesco, Zinn-Justin (2006) and possibly \
others. Catch phrase: \[OpenCurlyDoubleQuote]Loop percolation is integrable\
\[CloseCurlyDoubleQuote]\
\>", "Item",
 CellChangeTimes->{{3.616032656347459*^9, 3.616032667421927*^9}, {
  3.616032730461424*^9, 3.6160327882355833`*^9}, {3.61603303961796*^9, 
  3.6160330414928837`*^9}, {3.616034550091217*^9, 3.616034556189472*^9}}],

Cell[TextData[{
 "Technically, the row-transfer matrices ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["T", "n"], 
    RowBox[{"(", "p", ")"}]], TraditionalForm]]],
 " all commute with each other, therefore share the same Frobenius-Perron \
eigenvector"
}], "Item",
 CellChangeTimes->{{3.6160327887244577`*^9, 3.616032838903054*^9}, {
  3.616033198696294*^9, 3.6160332141093607`*^9}}],

Cell[TextData[{
 "Proof using a beautiful algebraic technique -- the ",
 StyleBox["Yang-Baxter equation",
  FontWeight->"Bold"]
}], "Item",
 CellChangeTimes->{{3.6160328395506163`*^9, 3.616032872640436*^9}, {
  3.61603322917213*^9, 3.616033230422073*^9}, {3.616374547007111*^9, 
  3.616374548518148*^9}}],

Cell["\<\
New proof (R.+Peled 2014) using an explicit combinatorial bijection\
\>", "Item",
 CellChangeTimes->{{3.6160328729015627`*^9, 3.6160328925770493`*^9}, {
   3.616032927477775*^9, 3.616032931727969*^9}, 3.616032977904009*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
The connectivity pattern of pipe percolation is the same as that of loop \
percolation\
\>", "Subsection",
 CellChangeTimes->{{3.616033121920302*^9, 3.616033137732584*^9}, {
  3.616033233634591*^9, 3.616033237934708*^9}, {3.616033335261832*^9, 
  3.616033339024534*^9}}],

Cell[TextData[{
 "Follows easily from the above invariance result by taking the limit as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", "\[Rule]", "0"}], TraditionalForm]]]
}], "Item",
 CellChangeTimes->{{3.616033384350663*^9, 3.616033409213825*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["The Cantini-Sportiello-Razumov-Stroganov theorem", "Subsection",
 CellChangeTimes->{{3.6160329973169813`*^9, 3.6160330050543737`*^9}}],

Cell["\<\
In 2001, Alexander Razumov and Yuri Stroganov, and independently Murray \
Batchelor, Jan de Gier and Bernard Nienhuis, numerically computed the \
distribution of the connectivity pattern of pipe percolation (equivalently: \
the stationary distribution of the Temperley-Lieb random walk). Let\
\[CloseCurlyQuote]s follow in their footsteps:\
\>", "Item",
 CellChangeTimes->{{3.616033450615158*^9, 3.6160334865655603`*^9}, {
  3.616033527967093*^9, 3.616033605818122*^9}, {3.616034292309391*^9, 
  3.616034328096966*^9}, {3.6163878739517384`*^9, 3.616387885402259*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"Plus", ",", " ", "#"}], "]"}], ",", " ", "#"}], "}"}], 
      "]"}], " ", "&"}], "@", 
    RowBox[{"RazumovStroganovEigenvector", "[", "n", "]"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"n", ",", " ", "1", ",", " ", "7", ",", " ", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.616033623789013*^9, 3.616033657594109*^9}, {
  3.6160336880332603`*^9, 3.616033696683465*^9}, {3.616033782162044*^9, 
  3.616033823077058*^9}, {3.616034501784894*^9, 3.616034510275324*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Razumov and Stroganov recognized that the coordinates of the vector \
enumerated Fully Packed Loops, and formulated a conjecture, which was proved \
in 2010 by Luigi Cantini and Andrea Sportiello:\n\n",
 StyleBox["The Cantini-Sportiello-Razumov-Stroganov theorem.",
  FontWeight->"Bold"],
 " The probability in pipe percolation/loop percolation (of order ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]]],
 ") for a given connectivity pattern ",
 Cell[BoxData[
  FormBox["\[Alpha]", TraditionalForm]]],
 " is equal to the number of FPL arrangements (of order ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]]],
 ") whose connectivity pattern is equal to \[Alpha] divided by the total \
number ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["FPL", "n"], TraditionalForm]]],
 " of arrangements.\n\nEquivalently: the connectivity pattern of a uniformly \
random FPL arrangement is ",
 StyleBox["equal in distribution",
  FontSlant->"Italic"],
 " to that of loop percolation (with any bias ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]]],
 ") and pipe percolation."
}], "Item",
 CellChangeTimes->{{3.616033882787484*^9, 3.616034273470498*^9}, {
  3.616387867593446*^9, 3.616387871239132*^9}}],

Cell[TextData[StyleBox["Cantini and Sportiello\[CloseCurlyQuote]s proof is \
ingenious and highly nontrivial. A variant of Wieland\[CloseCurlyQuote]s \
gyration map plays a key role.", "Item"]], "Item",
 CellChangeTimes->{{3.616034357735628*^9, 3.616034400660994*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["\<\
Rational probabilities of connectivity events\
\>", "Section",
 CellChangeTimes->{{3.615817048508507*^9, 3.615817068546495*^9}, {
  3.6163709720222816`*^9, 3.6163710049108*^9}}],

Cell["\<\
In numerical work around 2001-2004, D. Wilson, J.-B. Zuber and \
Mitra-Nienhuis-de Gier-Batchelor found simple formulas for probabilities of \
simple events in the Razumov-Stroganov distribution on noncrossing matchings \
(the distribution of the connectivity pattern of loop percolation, Fully \
Packed Loops etc.).\
\>", "Text",
 CellChangeTimes->{{3.616370801181555*^9, 3.6163708066558733`*^9}, {
  3.6163708870333643`*^9, 3.616370973997439*^9}, {3.6163710086984577`*^9, 
  3.616371040336508*^9}, {3.6163711000129128`*^9, 3.616371124888541*^9}, {
  3.616371652526848*^9, 3.616371673439163*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Example: The submatching event \[OpenCurlyDoubleQuote]",
 Cell[BoxData[
  GraphicsBox[
   {AbsoluteThickness[1.5], LineBox[{{0.5, 0}, {2.5, 0}}], 
    DiskBox[{1, 0}, NCache[Rational[2, 11], 0.18181818181818182`]], 
    DiskBox[{2, 0}, NCache[Rational[2, 11], 0.18181818181818182`]], {
     CircleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], NCache[
      Rational[1, 2], 0.5], 
      NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
       3.141592653589793}]], 
     CircleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], NCache[
      Rational[1, 2], 0.5], 
      NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], {}}, InsetBox[
     StyleBox["1",
      StripOnInput->False,
      FontSize->14], {1, -0.6}], InsetBox[
     StyleBox["2",
      StripOnInput->False,
      FontSize->14], {2, -0.6}]},
   ImageSize->70]],
  CellChangeTimes->{{3.6163712627465*^9, 3.6163712803532963`*^9}}],
 "\[CloseCurlyDoubleQuote]"
}], "Subsection",
 CellChangeTimes->{{3.616371228592289*^9, 3.616371243392021*^9}, {
  3.616371285766815*^9, 3.616371286406299*^9}}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"ProbabilityForSubmatchingEvent", "[", 
    RowBox[{"n", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.6163711434537907`*^9, {3.616372104512532*^9, 3.616372118714135*^9}}],

Cell[BoxData[
 RowBox[{"GuessFormula", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "6"}], "}"}], ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.616371156700468*^9, 3.6163711599168987`*^9}, {
  3.61637119590466*^9, 3.616371200952652*^9}, {3.616372038871526*^9, 
  3.616372038988391*^9}, {3.616372110037653*^9, 3.616372121363356*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Example: The submatching event \[OpenCurlyDoubleQuote]",
 Cell[BoxData[
  GraphicsBox[
   {AbsoluteThickness[1.5], LineBox[{{0.5, 0}, {4.5, 0}}], 
    DiskBox[{1, 0}, NCache[Rational[1, 6], 0.16666666666666666`]], 
    DiskBox[{2, 0}, NCache[Rational[1, 6], 0.16666666666666666`]], 
    DiskBox[{3, 0}, NCache[Rational[1, 6], 0.16666666666666666`]], 
    DiskBox[{4, 0}, NCache[Rational[1, 6], 0.16666666666666666`]], {
     CircleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], NCache[
      Rational[1, 2], 0.5], 
      NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
       3.141592653589793}]], 
     CircleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], NCache[
      Rational[1, 2], 0.5], 
      NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], {}}, {
     CircleBox[NCache[{Rational[7, 2], 0}, {3.5, 0}], NCache[
      Rational[1, 2], 0.5], 
      NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
       3.141592653589793}]], 
     CircleBox[NCache[{Rational[7, 2], 0}, {3.5, 0}], NCache[
      Rational[1, 2], 0.5], 
      NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], {}}, InsetBox[
     StyleBox["1",
      StripOnInput->False,
      FontSize->14], {1, -0.6}], InsetBox[
     StyleBox["2",
      StripOnInput->False,
      FontSize->14], {2, -0.6}], InsetBox[
     StyleBox["3",
      StripOnInput->False,
      FontSize->14], {3, -0.6}], InsetBox[
     StyleBox["4",
      StripOnInput->False,
      FontSize->14], {4, -0.6}]},
   ImageSize->120]],
  CellChangeTimes->{{3.6163712627465*^9, 3.6163712803532963`*^9}}],
 "\[CloseCurlyDoubleQuote]"
}], "Subsection",
 CellChangeTimes->{{3.616371228592289*^9, 3.616371243392021*^9}, {
  3.616371285766815*^9, 3.616371286406299*^9}, {3.616372380490177*^9, 
  3.6163723809400043`*^9}}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"ProbabilityForSubmatchingEvent", "[", 
    RowBox[{"n", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "4", ",", "3"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "2", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.616372064086521*^9, 3.616372065782058*^9}, {
  3.616372152451231*^9, 3.616372152766263*^9}, {3.616372267503977*^9, 
  3.616372267806365*^9}, {3.616372324880332*^9, 3.6163723251856737`*^9}}],

Cell[BoxData[
 RowBox[{"GuessFormula", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "2", ",", "6"}], "}"}], ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.616372076936843*^9, 3.616372077026119*^9}, {
  3.6163721651764193`*^9, 3.616372166563809*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Other examples", "Subsection",
 CellChangeTimes->{{3.6163713174184027`*^9, 3.616371318780477*^9}}],

Cell[BoxData[GridBox[{
   {
    StyleBox["Event", "Subsubsection"], 
    StyleBox["Probability", "Subsubsection"], 
    RowBox[{
     StyleBox["Probability", "Subsubsection"], 
     StyleBox[" ", "Subsubsection"], 
     StyleBox["as", "Subsubsection"], 
     StyleBox[" ", "Subsubsection"], Cell["n\[RightArrow]\[Infinity]"], Cell[
     ""]}]},
   {
    GraphicsBox[
     {AbsoluteThickness[1.5], LineBox[{{0.5, 0}, {2.5, 0}}], 
      DiskBox[{1, 0}, NCache[Rational[2, 11], 0.18181818181818182`]], 
      DiskBox[{2, 0}, NCache[Rational[2, 11], 0.18181818181818182`]], {
       CircleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
         3.141592653589793}]], 
       CircleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], {}}, 
      InsetBox[
       StyleBox["1",
        StripOnInput->False,
        FontSize->14], {1, -0.6}], InsetBox[
       StyleBox["2",
        StripOnInput->False,
        FontSize->14], {2, -0.6}]},
     ImageSize->70], 
    RowBox[{
     FractionBox["3", "2"], "\[Times]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["n", "2"], "+", "1"}], 
      RowBox[{
       RowBox[{"4", 
        SuperscriptBox["n", "2"]}], "-", "1"}]]}], 
    FractionBox["3", "8"]},
   {
    GraphicsBox[
     {AbsoluteThickness[1.5], LineBox[{{0.5, 0}, {4.5, 0}}], 
      DiskBox[{1, 0}, NCache[Rational[1, 6], 0.16666666666666666`]], 
      DiskBox[{2, 0}, NCache[Rational[1, 6], 0.16666666666666666`]], 
      DiskBox[{3, 0}, NCache[Rational[1, 6], 0.16666666666666666`]], 
      DiskBox[{4, 0}, NCache[Rational[1, 6], 0.16666666666666666`]], {
       CircleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
         3.141592653589793}]], 
       CircleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], {}}, {
       CircleBox[NCache[{Rational[7, 2], 0}, {3.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
         3.141592653589793}]], 
       CircleBox[NCache[{Rational[7, 2], 0}, {3.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], {}}, 
      InsetBox[
       StyleBox["1",
        StripOnInput->False,
        FontSize->14], {1, -0.6}], InsetBox[
       StyleBox["2",
        StripOnInput->False,
        FontSize->14], {2, -0.6}], InsetBox[
       StyleBox["3",
        StripOnInput->False,
        FontSize->14], {3, -0.6}], InsetBox[
       StyleBox["4",
        StripOnInput->False,
        FontSize->14], {4, -0.6}]},
     ImageSize->120], 
    RowBox[{
     FractionBox["1", "8"], "\[Times]", 
     FractionBox[
      RowBox[{
       RowBox[{"97", 
        SuperscriptBox["n", "6"]}], "+", 
       RowBox[{"82", 
        SuperscriptBox["n", "4"]}], "-", 
       RowBox[{"107", 
        SuperscriptBox["n", "2"]}], "-", "792"}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", 
           SuperscriptBox["n", "2"]}], "-", "1"}], ")"}], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", 
          SuperscriptBox["n", "2"]}], "-", "9"}], ")"}]}]]}], 
    FractionBox["97", "512"]},
   {
    GraphicsBox[
     {AbsoluteThickness[1.5], LineBox[{{0.5, 0}, {4.5, 0}}], 
      DiskBox[{1, 0}, NCache[Rational[1, 6], 0.16666666666666666`]], 
      DiskBox[{2, 0}, NCache[Rational[1, 6], 0.16666666666666666`]], 
      DiskBox[{3, 0}, NCache[Rational[1, 6], 0.16666666666666666`]], 
      DiskBox[{4, 0}, NCache[Rational[1, 6], 0.16666666666666666`]], {
       CircleBox[NCache[{Rational[5, 2], 0}, {2.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
         3.141592653589793}]], 
       CircleBox[NCache[{Rational[5, 2], 0}, {2.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], {}}, {
       CircleBox[NCache[{Rational[5, 2], 0}, {2.5, 0}], NCache[
        Rational[3, 2], 1.5], 
        NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
         3.141592653589793}]], 
       CircleBox[NCache[{Rational[5, 2], 0}, {2.5, 0}], NCache[
        Rational[3, 2], 1.5], 
        NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], {}}, 
      InsetBox[
       StyleBox["1",
        StripOnInput->False,
        FontSize->14], {1, -0.6}], InsetBox[
       StyleBox["2",
        StripOnInput->False,
        FontSize->14], {2, -0.6}], InsetBox[
       StyleBox["3",
        StripOnInput->False,
        FontSize->14], {3, -0.6}], InsetBox[
       StyleBox["4",
        StripOnInput->False,
        FontSize->14], {4, -0.6}]},
     ImageSize->120], 
    RowBox[{
     FractionBox["1", "16"], "\[Times]", 
     FractionBox[
      RowBox[{
       RowBox[{"59", 
        SuperscriptBox["n", "6"]}], "+", 
       RowBox[{"299", 
        SuperscriptBox["n", "4"]}], "+", 
       RowBox[{"866", 
        SuperscriptBox["n", "2"]}], "+", "576"}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", 
           SuperscriptBox["n", "2"]}], "-", "1"}], ")"}], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", 
          SuperscriptBox["n", "2"]}], "-", "9"}], ")"}]}]]}], 
    FractionBox["59", "1024"]},
   {
    GraphicsBox[
     {AbsoluteThickness[1.5], LineBox[{{0.5, 0}, {6.5, 0}}], 
      DiskBox[{1, 0}, NCache[Rational[2, 13], 0.15384615384615385`]], 
      DiskBox[{2, 0}, NCache[Rational[2, 13], 0.15384615384615385`]], 
      DiskBox[{3, 0}, NCache[Rational[2, 13], 0.15384615384615385`]], 
      DiskBox[{4, 0}, NCache[Rational[2, 13], 0.15384615384615385`]], 
      DiskBox[{5, 0}, NCache[Rational[2, 13], 0.15384615384615385`]], 
      DiskBox[{6, 0}, NCache[Rational[2, 13], 0.15384615384615385`]], {
       CircleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
         3.141592653589793}]], 
       CircleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], {}}, {
       CircleBox[NCache[{Rational[7, 2], 0}, {3.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
         3.141592653589793}]], 
       CircleBox[NCache[{Rational[7, 2], 0}, {3.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], {}}, {
       CircleBox[NCache[{Rational[11, 2], 0}, {5.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
         3.141592653589793}]], 
       CircleBox[NCache[{Rational[11, 2], 0}, {5.5, 0}], NCache[
        Rational[1, 2], 0.5], 
        NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], {}}, 
      InsetBox[
       StyleBox["1",
        StripOnInput->False,
        FontSize->14], {1, -0.6}], InsetBox[
       StyleBox["2",
        StripOnInput->False,
        FontSize->14], {2, -0.6}], InsetBox[
       StyleBox["3",
        StripOnInput->False,
        FontSize->14], {3, -0.6}], InsetBox[
       StyleBox["4",
        StripOnInput->False,
        FontSize->14], {4, -0.6}], InsetBox[
       StyleBox["5",
        StripOnInput->False,
        FontSize->14], {5, -0.6}], InsetBox[
       StyleBox["6",
        StripOnInput->False,
        FontSize->14], {6, -0.6}]},
     ImageSize->150], 
    StyleBox[
     RowBox[{
      FractionBox["1", "512"], "\[Times]", 
      FractionBox[
       RowBox[{
        RowBox[{"214093", 
         SuperscriptBox["n", "12"]}], "-", 
        RowBox[{"980692", 
         SuperscriptBox["n", "10"]}], "-", 
        RowBox[{"584436", 
         SuperscriptBox["n", "8"]}], "-", 
        RowBox[{"1887916", 
         SuperscriptBox["n", "6"]}], "+", 
        RowBox[{"1361443", 
         SuperscriptBox["n", "4"]}], "-", 
        RowBox[{"17432892", 
         SuperscriptBox["n", "2"]}], "-", "316353600"}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", 
            SuperscriptBox["n", "2"]}], "-", "1"}], ")"}], "3"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", 
            SuperscriptBox["n", "2"]}], "-", "9"}], ")"}], "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", 
           SuperscriptBox["n", "2"]}], "-", "25"}], ")"}]}]]}],
     FontSize->12], 
    FractionBox["214093", 
     SuperscriptBox["2", "21"]]}
  }]], "Input",
 CellChangeTimes->{{3.61637247642097*^9, 3.616372839073777*^9}, {
   3.616372887692515*^9, 3.616372941467326*^9}, {3.61637353668469*^9, 
   3.616373539112404*^9}, {3.616373819629245*^9, 3.6163738389570017`*^9}, 
   3.616373949756125*^9, {3.616374136262453*^9, 3.616374216226309*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Theoretical developments", "Subsection",
 CellChangeTimes->{{3.6163729538572197`*^9, 3.616372973019122*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "The formula for the probability of the simplest submatching event \
\[OpenCurlyDoubleQuote]",
 Cell[BoxData[
  GraphicsBox[
   {AbsoluteThickness[1.5], LineBox[{{0.5, 0}, {2.5, 0}}], 
    DiskBox[{1, 0}, NCache[Rational[2, 11], 0.18181818181818182`]], 
    DiskBox[{2, 0}, NCache[Rational[2, 11], 0.18181818181818182`]], {
     CircleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], NCache[
      Rational[1, 2], 0.5], 
      NCache[{Rational[1, 2] Pi, Pi}, {1.5707963267948966`, 
       3.141592653589793}]], 
     CircleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], NCache[
      Rational[1, 2], 0.5], 
      NCache[{0, Rational[1, 2] Pi}, {0, 1.5707963267948966`}]], {}}, InsetBox[
     StyleBox["1",
      StripOnInput->False,
      FontSize->14], {1, -0.6}], InsetBox[
     StyleBox["2",
      StripOnInput->False,
      FontSize->14], {2, -0.6}]},
   ImageSize->70]],
  CellChangeTimes->{{3.6163712627465*^9, 3.6163712803532963`*^9}}],
 "\[CloseCurlyDoubleQuote] was proved in 2009 (Fonseca-Zinn-Justin 2009)."
}], "Item",
 CellChangeTimes->{{3.616372975006894*^9, 3.6163730702965317`*^9}, {
  3.616373760888381*^9, 3.6163737649755*^9}, {3.616374413290696*^9, 
  3.616374440078422*^9}}],

Cell["\<\
Using the \[OpenCurlyDoubleQuote]qKZ equation\[CloseCurlyDoubleQuote] \
techniques developed by Di Francesco-Zinn Justin (2006) and \
Fonseca-Zinn-Justin, I proved a couple of the other conjectured formulas (R. \
2014).\
\>", "Item",
 CellChangeTimes->{{3.616372975006894*^9, 3.616373121472843*^9}}],

Cell[TextData[{
 "In the same paper, I also proved a general formula expressing the \
probability of an arbitrary submatching event as a constant term of a certain \
multivariate Laurent polynomial. It\[CloseCurlyQuote]s not clear yet how to \
see that this complicated algebraic expression is always a rational function \
of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],
  FormatType->"TraditionalForm"],
 " (the obvious empirical pattern one observes in the simple cases). This is \
an interesting conjecture in algebraic combinatorics with beautiful \
probabilistic consequences (especially in the limit as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[Rule]", "\[Infinity]"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ")."
}], "Item",
 CellChangeTimes->{{3.616373097109488*^9, 3.6163732454531918`*^9}, {
  3.6163763999139557`*^9, 3.616376508450395*^9}}],

Cell[TextData[{
 "My constant term formula was discovered experimentally using ",
 StyleBox["Mathematica.",
  FontSlant->"Italic"],
 " In fact, I wrote ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " code specifically looking for a certain kind of algebraic expansion \
(relating a sum over a certain class of \[OpenCurlyDoubleQuote]wheel \
polynomials\[CloseCurlyDoubleQuote] to another sum involving a different \
basis of the same vector space; see my paper). Thus, using a combination of \
intuition, patience and coding skills I was able to discover (and eventually \
prove) a beautiful mathematical theorem."
}], "Item",
 CellChangeTimes->{{3.616373246212801*^9, 3.616373403374791*^9}, {
  3.616376532089281*^9, 3.6163765336135187`*^9}}],

Cell["\<\
(Moral of the story: good programming skills can make you look smarter than \
you are!)\
\>", "Item",
 CellChangeTimes->{{3.616373404016755*^9, 3.616373437704845*^9}, {
  3.616374344476658*^9, 3.616374344850668*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Razumov-Stroganov conjectures and symmetry classes of FPLS", "Section",
 CellChangeTimes->{{3.6158171176849947`*^9, 3.615817129907866*^9}}],

Cell["\<\
Razumov and Stroganov also studied several natural variants of pipe \
percolation and the associated Temperley-Lieb random walk with different \
boundary conditions, and discovered numerically a host of similar \
\[OpenCurlyDoubleQuote]Razumov-Stroganov conjectures\[CloseCurlyDoubleQuote] \
relating the associated eigenvector with classes of FPL arrangements. A few \
of them were also proved by Cantini and Sportiello using their generalized \
gyration; others are still unsolved.\
\>", "Text",
 CellChangeTimes->{{3.61610812756408*^9, 3.616108244603529*^9}, {
  3.616108280842442*^9, 3.616108333755827*^9}, {3.61610948715725*^9, 
  3.616109494357192*^9}}],

Cell[CellGroupData[{

Cell["\<\
Example: aperiodic boundary conditions and Vertically Symmetric FPLs\
\>", "Subsection",
 CellChangeTimes->{{3.6161082233406057`*^9, 3.616108238965897*^9}, {
   3.616108362956465*^9, 3.6161083637186937`*^9}, {3.61610861797613*^9, 
   3.616108623187335*^9}, 3.616108840329974*^9, {3.616109470156764*^9, 
   3.616109471231415*^9}}],

Cell[TextData[{
 "Thinking of noncrossing matchings as objects existing on a line rather than \
a circle, it is natural to disallow the \[OpenCurlyDoubleQuote]wraparound\
\[CloseCurlyDoubleQuote] pipe operator connecting the points ",
 Cell[BoxData[
  FormBox["1", TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "n"}], TraditionalForm]]],
 ". The associated stationary distribution no longer has rotational symmetry. \
Let\[CloseCurlyQuote]s explore this."
}], "Text",
 CellChangeTimes->{{3.6161083837816477`*^9, 3.616108535722805*^9}, {
  3.616108573324458*^9, 3.6161086011366158`*^9}, {3.6161091635624123`*^9, 
  3.6161091647870693`*^9}, {3.616123161375445*^9, 3.6161231616489353`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eigenvectors", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RazumovStroganovAperiodicEigenvector", "[", "n", "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "1", ",", " ", "7", ",", " ", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"Plus", ",", " ", "#"}], "]"}], ",", " ", "#"}], "}"}], 
      "]"}], " ", "&"}], "@", 
    RowBox[{"eigenvectors", "[", 
     RowBox[{"[", "n", "]"}], "]"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"n", ",", " ", "1", ",", " ", "7", ",", " ", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6160919969752274`*^9, 3.616092005455233*^9}, {
  3.616092054587431*^9, 3.616092079379189*^9}, {3.616092124965644*^9, 
  3.61609216744031*^9}, {3.616304483947711*^9, 3.6163044867154093`*^9}}],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", "#"}], "]"}], "&"}], ",", "eigenvectors"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6160921902068653`*^9, 3.616092208080484*^9}}],

Cell[BoxData[
 RowBox[{"OnlineEncyclopediaOfIntegerSequencesLookup", "[", "%", 
  "]"}]], "Input"],

Cell[TextData[{
 "It turns out that the stationary probabilities are related to the \
connectivity patterns of uniformly random FPL arrangements chosen from the \
set of ",
 StyleBox["Vertically Symmetric FPLs",
  FontWeight->"Bold"],
 " (related to Vertically Symmetric Alternating Sign Matrices, known as \
VSASMs)."
}], "Text",
 CellChangeTimes->{{3.61610862946237*^9, 3.6161086830017347`*^9}, {
  3.616108783490877*^9, 3.616108804316553*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Other Razumov-Stroganov variants", "Subsection",
 CellChangeTimes->{{3.616108697214219*^9, 3.616108700638926*^9}, {
  3.616109458857122*^9, 3.616109459796126*^9}}],

Cell["\<\
The Razumov-Stroganov conjectures involve symmetry classes of FPLs, or \
equivalently of ASMs. Here our story intersects with another story -- the \
enumeration of these symmetry classes (mostly solved in two papers by Greg \
Kuperberg and Soichi Okada). Some of the symmetry classes that show up are:\
\>", "Text",
 CellChangeTimes->{{3.6161091528375874`*^9, 3.6161092699144907`*^9}, {
  3.616109300103265*^9, 3.6161093860841703`*^9}, {3.61610943398061*^9, 
  3.616109449230721*^9}}],

Cell[CellGroupData[{

Cell["Half-Turn Symmetric ASMs (HTASM)", "Item",
 CellChangeTimes->{{3.61610871757729*^9, 3.616108756302754*^9}}],

Cell["Quarter-Turn Symmetric ASMs (QTASM)", "Item",
 CellChangeTimes->{{3.6161087266522703`*^9, 3.616108760877754*^9}}],

Cell["Diagonally and Antidiagonally Symmetric ASMs (DASASM)", "Item",
 CellChangeTimes->{{3.616108739002625*^9, 3.616108776203287*^9}, {
  3.616108813141321*^9, 3.616108813142885*^9}}],

Cell["... (?)", "Item",
 CellChangeTimes->{{3.61610881470385*^9, 3.616108826891836*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["The End - Thank You!", "Section",
 CellChangeTimes->{{3.616302947686363*^9, 3.61630296337327*^9}, {
  3.616373665985351*^9, 3.6163736765286818`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Style", "[", 
  RowBox[{
   RowBox[{"FunFPLAnimation", "[", "10", "]"}], ",", 
   RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}]], "Input",
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{{3.6163029781095133`*^9, 3.616302981549127*^9}, {
  3.616303439862687*^9, 3.6163034490577908`*^9}}],

Cell[BoxData[
 StyleBox[
  DynamicModuleBox[{$CellContext`fpl$$ = {{{1, 0, 1, 0, 1, 0, 1, 0, 1, 0}, {0,
     1, 0, 1, 0, 1, 0, 1, 1, 1}, {1, 0, 1, 0, 1, 0, 0, 0, 0, 0}, {0, 1, 0, 0, 
    0, 1, 0, 0, 0, 0}, {1, 0, 0, 1, 1, 0, 1, 1, 1, 1}, {0, 1, 1, 0, 1, 1, 0, 
    1, 1, 0}, {1, 1, 1, 1, 0, 0, 1, 1, 0, 1}, {1, 1, 1, 1, 1, 1, 1, 0, 1, 
    0}, {0, 0, 0, 1, 1, 1, 0, 1, 0, 1}, {1, 1, 1, 0, 1, 0, 1, 0, 1, 0}, {0, 1,
     0, 1, 0, 1, 0, 1, 0, 1}}, {{0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1}, {1, 0, 1, 
    0, 1, 0, 1, 1, 0, 1, 0}, {0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1}, {1, 0, 1, 1, 
    0, 1, 0, 1, 0, 1, 0}, {0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1}, {1, 0, 0, 0, 1, 
    0, 1, 0, 0, 1, 0}, {0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1}, {1, 0, 1, 0, 0, 0, 
    0, 1, 0, 1, 0}, {0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1}, {1, 0, 0, 1, 0, 1, 0, 
    1, 0, 1, 0}}}, $CellContext`parity$$ = 1}, 
   TemplateBox[{DynamicBox[
      ToBoxes[
       Refresh[$CellContext`fpl$$ = 
         1 - $CellContext`globalgyrationop[$CellContext`fpl$$, \
$CellContext`parity$$]; $CellContext`parity$$ = 1 - $CellContext`parity$$; 
        Graphics[
          $CellContext`FPLgraphics[$CellContext`fpl$$, False], ImageSize -> 
          300], UpdateInterval -> 1/4, TrackedSymbols -> {}], StandardForm], 
      ImageSizeCache -> {246., {122., 124.}}],DynamicBox[
      ToBoxes[
       Graphics[
        Part[
         $CellContext`NoncrossingMatchingGraphicsCircular[
          $CellContext`FPLmatching[$CellContext`fpl$$], True], 1], ImageSize -> 
        300], StandardForm], ImageSizeCache -> {246., {123., 125.}}]},
    "Row",
    DisplayFunction->(RowBox[{#, "\[InvisibleSpace]", #2}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2}], "}"}], "]"}]& )],
   DynamicModuleValues:>{}],
  StripOnInput->False,
  TextAlignment->Center]], "Output",
 CellChangeTimes->{
  3.616302982196727*^9, {3.6163030845134583`*^9, 3.616303092701735*^9}, {
   3.616303153648768*^9, 3.616303182937992*^9}, 3.6163032345954638`*^9, {
   3.616303443988248*^9, 3.616303449705261*^9}, 3.616304389977713*^9, 
   3.616304496975716*^9, 3.616304548591955*^9, 3.616369210985931*^9, 
   3.6163767615769463`*^9, 3.61637685215629*^9, 3.6163768927689342`*^9, 
   3.616376958034625*^9, 3.616377553755877*^9, 3.6163785268154163`*^9, 
   3.616378725802744*^9, 3.616380166365346*^9, 3.6163803167011414`*^9, 
   3.616387580904776*^9, 3.616768024742104*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["References", "Subsection",
 CellChangeTimes->{{3.616303483380725*^9, 3.6163034843325377`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Ben Wieland. A large dihedral symmetry of the set of alternatign sign \
matrices. ",
 StyleBox["Elect. J. Combin. ",
  FontSlant->"Italic"],
 StyleBox["7",
  FontWeight->"Bold"],
 " (2000), #R37."
}], "Item",
 CellChangeTimes->{{3.616303516085678*^9, 3.616303532670086*^9}, {
  3.6163035803439093`*^9, 3.616303611345806*^9}, {3.6163036736484756`*^9, 
  3.616303687864787*^9}}],

Cell[TextData[{
 "Alexander Razumov, Yuri Stroganov. Combinatorial nature of ground state \
vector of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", "1", ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " loop model. ",
 StyleBox["Theor. Math. Phys. ",
  FontSlant->"Italic"],
 StyleBox["138",
  FontWeight->"Bold"],
 " (2004), 333-337."
}], "Item",
 CellChangeTimes->{{3.6163035192947702`*^9, 3.616303535399045*^9}, {
  3.616303613450913*^9, 3.616303642115222*^9}, {3.616303723200757*^9, 
  3.616303768840948*^9}}],

Cell[TextData[{
 "Luigi Cantini, Andrea Sportiello. Proof of the Razumov-Stroganov \
conjecture. ",
 StyleBox["J. Comb. Theory Ser. A",
  FontSlant->"Italic"],
 " ",
 StyleBox["118",
  FontWeight->"Bold"],
 " (2011), 1549-1574."
}], "Item",
 CellChangeTimes->{{3.616303538506689*^9, 3.616303547249365*^9}, {
  3.616303617254448*^9, 3.616303634594873*^9}, {3.616303787936267*^9, 
  3.6163038042045507`*^9}}],

Cell[TextData[{
 "Dan Romik. Connectivity patterns in loop percolation I: the rationality \
phenomenon and constant term identities. ",
 StyleBox["Commun. Math. Phys.",
  FontSlant->"Italic"],
 " ",
 StyleBox["330",
  FontWeight->"Bold"],
 " (2014), 499-538."
}], "Item",
 CellChangeTimes->{{3.616303536290661*^9, 3.616303537928026*^9}, {
  3.616303626168848*^9, 3.616303649182048*^9}, {3.6163038116497297`*^9, 
  3.6163038493769073`*^9}}],

Cell[TextData[{
 "Dan Romik, Ron Peled. Bijective combinatorial proof of the commutation of \
transfer matrices in the dense ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", "1", ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " loop model. Preprint, 2014."
}], "Item",
 CellChangeTimes->{{3.6163035566798267`*^9, 3.616303559170034*^9}, {
  3.6163036512714243`*^9, 3.61630365364452*^9}, {3.61630385106479*^9, 
  3.61630387839014*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
ScreenStyleEnvironment->"SlideShow",
InitializationCellEvaluation->True,
InitializationCellWarning->False,
WindowSize->{1246, 745},
WindowMargins->{{4, Automatic}, {Automatic, 5}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
TaggingRules->{
 "SlideshowSettings" -> {
   "Toolbar" -> True, "WindowElements" -> {"VerticalScrollBar"}}},
ShowCellLabel->False,
Magnification->0.8200000000000001,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb",
PrivateNotebookOptions -> {"VersionedStylesheet" -> {"Default.nb"[8.] -> True}}
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "SlideShowHeader"->{
  Cell[579, 22, 64, 1, 1, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[274169, 6565, 64, 1, 1, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[280542, 6724, 64, 1, 1, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[289825, 6984, 64, 1, 1, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[300118, 7295, 64, 1, 1, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[310163, 7534, 64, 1, 1, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[314035, 7651, 64, 1, 1, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[320342, 7825, 64, 1, 1, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[338629, 8309, 64, 1, 1, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[343723, 8449, 64, 1, 1, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"SlideShowHeader", 349913, 8622}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 64, 1, 1, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[668, 27, 226, 3, 91, "Section"],
Cell[897, 32, 450, 15, 59, "Text"],
Cell[1350, 49, 667, 12, 105, "Text"],
Cell[CellGroupData[{
Cell[2042, 65, 225, 3, 47, "Subsection"],
Cell[CellGroupData[{
Cell[2292, 72, 219, 3, 11, "Subsubsection"],
Cell[2514, 77, 524, 10, 9, "Text"],
Cell[CellGroupData[{
Cell[3063, 91, 110666, 2712, 1362, "Code"],
Cell[113732, 2805, 701, 10, 70, "Print"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[114482, 2821, 114, 1, 8, "Subsubsection"],
Cell[114599, 2824, 423, 10, 10, "Text"],
Cell[CellGroupData[{
Cell[115047, 2838, 152738, 3566, 3246, "Code"],
Cell[267788, 6406, 739, 11, 70, "Print"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[268576, 6423, 167, 2, 8, "Subsubsection"],
Cell[268746, 6427, 187, 4, 5, "Text"],
Cell[CellGroupData[{
Cell[268958, 6435, 1185, 29, 42, "Code"],
Cell[270146, 6466, 612, 8, 70, "Print"]
}, Open  ]],
Cell[270773, 6477, 94, 2, 5, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[270916, 6485, 168, 2, 36, "Subsection"],
Cell[271087, 6489, 365, 7, 59, "Text"],
Cell[CellGroupData[{
Cell[271477, 6500, 112, 1, 34, "Subsubsection"],
Cell[271592, 6503, 1012, 17, 12, "Text"],
Cell[CellGroupData[{
Cell[272629, 6524, 643, 15, 9, "Code"],
Cell[273275, 6541, 809, 15, 70, "Print"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[274169, 6565, 64, 1, 1, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[274258, 6570, 142, 3, 132, "Section"],
Cell[274403, 6575, 386, 8, 235, "Text"],
Cell[CellGroupData[{
Cell[274814, 6587, 563, 14, 20, "Input",
 CellOpen->False],
Cell[275380, 6603, 267, 7, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[275684, 6615, 639, 12, 20, "Input",
 CellOpen->False,
 InitializationCell->True],
Cell[276326, 6629, 3183, 64, 348, "Output"]
}, Open  ]],
Cell[279524, 6696, 969, 22, 59, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[280542, 6724, 64, 1, 1, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[280631, 6729, 108, 1, 91, "Section"],
Cell[280742, 6732, 500, 9, 35, "Text"],
Cell[281245, 6743, 477, 10, 59, "Text"],
Cell[CellGroupData[{
Cell[281747, 6757, 100, 1, 46, "Subsection"],
Cell[281850, 6760, 3078, 79, 57, "Input"],
Cell[284931, 6841, 741, 17, 20, "Text"],
Cell[285675, 6860, 469, 12, 22, "Input"],
Cell[286147, 6874, 338, 8, 20, "Text"],
Cell[286488, 6884, 520, 13, 22, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[287045, 6902, 124, 1, 35, "Subsection"],
Cell[287172, 6905, 248, 6, 35, "Text"],
Cell[287423, 6913, 391, 9, 37, "Input"],
Cell[287817, 6924, 400, 7, 35, "Text"],
Cell[288220, 6933, 213, 4, 37, "Input"],
Cell[288436, 6939, 188, 6, 35, "Text"],
Cell[288627, 6947, 753, 20, 92, "Input"],
Cell[289383, 6969, 381, 8, 59, "Text"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[289825, 6984, 64, 1, 1, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[289914, 6989, 164, 2, 91, "Section"],
Cell[290081, 6993, 891, 25, 59, "Text"],
Cell[290975, 7020, 325, 7, 62, "Input"],
Cell[291303, 7029, 401, 11, 35, "Text"],
Cell[291707, 7042, 221, 4, 37, "Input"],
Cell[CellGroupData[{
Cell[291953, 7050, 234, 3, 46, "Subsection"],
Cell[292190, 7055, 243, 6, 11, "Text"],
Cell[292436, 7063, 327, 8, 12, "Input"],
Cell[292766, 7073, 98, 2, 12, "Input"],
Cell[292867, 7077, 1605, 44, 51, "Text"],
Cell[294475, 7123, 813, 25, 34, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[295325, 7153, 287, 4, 35, "Subsection"],
Cell[295615, 7159, 258, 5, 9, "Text"],
Cell[CellGroupData[{
Cell[295898, 7168, 210, 3, 7, "Item"],
Cell[296111, 7173, 245, 6, 7, "Item"],
Cell[296359, 7181, 198, 5, 7, "Item"],
Cell[296560, 7188, 152, 2, 7, "Item"]
}, Open  ]],
Cell[296727, 7193, 172, 4, 9, "Text"],
Cell[CellGroupData[{
Cell[296924, 7201, 176, 2, 7, "Item"],
Cell[297103, 7205, 148, 2, 7, "Item"]
}, Open  ]],
Cell[297266, 7210, 337, 6, 9, "Text"],
Cell[CellGroupData[{
Cell[297628, 7220, 277, 6, 7, "Item"],
Cell[297908, 7228, 357, 8, 7, "Item"],
Cell[298268, 7238, 280, 5, 14, "Item"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[298597, 7249, 170, 2, 35, "Subsection"],
Cell[298770, 7253, 943, 25, 23, "Text"],
Cell[299716, 7280, 341, 8, 9, "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[300118, 7295, 64, 1, 1, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[300207, 7300, 150, 2, 91, "Section"],
Cell[300360, 7304, 808, 19, 59, "Text"],
Cell[CellGroupData[{
Cell[301193, 7327, 411, 12, 37, "Input"],
Cell[301607, 7341, 3996, 70, 124, 833, 16, "CachedBoxData", "BoxData", \
"Output"]
}, Open  ]],
Cell[305618, 7414, 285, 5, 59, "Text"],
Cell[305906, 7421, 418, 9, 62, "Input"],
Cell[306327, 7432, 381, 9, 35, "Text"],
Cell[CellGroupData[{
Cell[306733, 7445, 132, 1, 46, "Subsection"],
Cell[306868, 7448, 599, 12, 9, "Text"],
Cell[307470, 7462, 1283, 30, 16, "Input"],
Cell[308756, 7494, 502, 10, 9, "Text"],
Cell[309261, 7506, 418, 9, 3, "Input"],
Cell[309682, 7517, 420, 10, 6, "Text"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[310163, 7534, 64, 1, 1, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[310252, 7539, 149, 2, 91, "Section"],
Cell[310404, 7543, 667, 20, 59, "Text"],
Cell[CellGroupData[{
Cell[311096, 7567, 308, 7, 37, "Input"],
Cell[311407, 7576, 1320, 27, 64, "Output"]
}, Open  ]],
Cell[312742, 7606, 891, 29, 59, "Text"],
Cell[313636, 7637, 350, 8, 37, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[314035, 7651, 64, 1, 1, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[314124, 7656, 259, 3, 91, "Section"],
Cell[314386, 7661, 533, 9, 59, "Text"],
Cell[CellGroupData[{
Cell[314944, 7674, 418, 9, 46, "Subsection"],
Cell[CellGroupData[{
Cell[315387, 7687, 412, 7, 5, "Item"],
Cell[315802, 7696, 403, 11, 5, "Item"],
Cell[316208, 7709, 304, 7, 2, "Item"],
Cell[316515, 7718, 233, 4, 2, "Item"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[316797, 7728, 280, 6, 35, "Subsection"],
Cell[317080, 7736, 248, 6, 2, "Item"]
}, Closed]],
Cell[CellGroupData[{
Cell[317365, 7747, 140, 1, 35, "Subsection"],
Cell[317508, 7750, 577, 9, 57, "Item"],
Cell[318088, 7761, 674, 17, 50, "Input"],
Cell[CellGroupData[{
Cell[318787, 7782, 1211, 30, 154, "Item"],
Cell[320001, 7814, 268, 3, 24, "Item"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[320342, 7825, 64, 1, 1, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[320431, 7830, 187, 4, 91, "Section"],
Cell[320621, 7836, 607, 10, 82, "Text"],
Cell[CellGroupData[{
Cell[321253, 7850, 1074, 25, 61, "Subsection"],
Cell[322330, 7877, 369, 10, 9, "Input"],
Cell[322702, 7889, 368, 7, 9, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[323107, 7901, 1783, 41, 47, "Subsection"],
Cell[324893, 7944, 508, 11, 9, "Input"],
Cell[325404, 7957, 274, 6, 9, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[325715, 7968, 104, 1, 35, "Subsection"],
Cell[325822, 7971, 9182, 240, 31, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[335041, 8216, 114, 1, 35, "Subsection"],
Cell[CellGroupData[{
Cell[335180, 8221, 1201, 27, 4, "Item"],
Cell[336384, 8250, 309, 6, 5, "Item"],
Cell[336696, 8258, 878, 19, 10, "Item"],
Cell[337577, 8279, 750, 15, 10, "Item"],
Cell[338330, 8296, 226, 5, 2, "Item"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[338629, 8309, 64, 1, 1, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[338718, 8314, 145, 1, 91, "Section"],
Cell[338866, 8317, 669, 11, 105, "Text"],
Cell[CellGroupData[{
Cell[339560, 8332, 339, 6, 46, "Subsection"],
Cell[339902, 8340, 713, 15, 9, "Text"],
Cell[340618, 8357, 995, 27, 13, "Input"],
Cell[341616, 8386, 243, 7, 3, "Input"],
Cell[341862, 8395, 98, 2, 3, "Input"],
Cell[341963, 8399, 446, 10, 9, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[342446, 8414, 169, 2, 35, "Subsection"],
Cell[342618, 8418, 494, 8, 67, "Text"],
Cell[CellGroupData[{
Cell[343137, 8430, 113, 1, 24, "Item"],
Cell[343253, 8433, 119, 1, 24, "Item"],
Cell[343375, 8436, 184, 2, 24, "Item"],
Cell[343562, 8440, 88, 1, 24, "Item"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[343723, 8449, 64, 1, 1, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[343812, 8454, 155, 2, 91, "Section"],
Cell[CellGroupData[{
Cell[343992, 8460, 336, 8, 20, "Input",
 CellOpen->False,
 InitializationCell->True],
Cell[344331, 8470, 2418, 44, 268, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[346786, 8519, 100, 1, 46, "Subsection"],
Cell[CellGroupData[{
Cell[346911, 8524, 394, 11, 30, "Item"],
Cell[347308, 8537, 530, 16, 50, "Item"],
Cell[347841, 8555, 406, 12, 30, "Item"],
Cell[348250, 8569, 439, 12, 50, "Item"],
Cell[348692, 8583, 448, 11, 50, "Item"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
